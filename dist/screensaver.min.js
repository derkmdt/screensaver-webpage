function loadData(i,e,o){jQuery(".backdrop."+i).addClass("visible"),$.ajax({url:e,type:"GET",success:function(e){if(void 0===e.errors||e.errors.length<1){var t,n=8e3;-1!=o.feed.indexOf("bolpuntcom")?t=e.products:-1!=o.feed.indexOf("bolcomreclames")?(t=e,n=0):t=-1!=o.feed.indexOf("nunl")?e:processTweets(e),jQuery(".backdrop."+i+" .tw").addClass("animation"),jQuery(".backdrop."+i+" .tw").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(e){APP.Store.start(t),APP.Slideshow=new APP.Views.Slideshow({el:$(".template-holder"),templateName:"#"+i+"-template",collection:new APP.Store.getSlideCollection,timeSet:n,handle:i}),$(".backdrop."+i).removeClass("visible")})}else $(".post .message .text-message").text("Response error")},error:function(e){$(".post .message .text-message").text("Request error")}})}function Swipe(n,r){"use strict";var t=function(){},a=function(e){setTimeout(e||t,0)},s={addEventListener:!!window.addEventListener,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,transitions:function(e){var t=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];for(var n in t)if(void 0!==e.style[t[n]])return!0;return!1}(document.createElement("swipe"))};if(n){var l,c,d,i,u=n.children[0];r=r||{};var h=parseInt(r.startSlide,10)||0,p=r.speed||300;r.continuous=void 0===r.continuous||r.continuous;var e,f,g=r.auto||0,m={},v={},w={handleEvent:function(e){switch(e.type){case"touchstart":this.start(e);break;case"touchmove":this.move(e);break;case"touchend":a(this.end(e));break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":a(this.transitionEnd(e));break;case"resize":a(o)}r.stopPropagation&&e.stopPropagation()},start:function(e){var t=e.touches[0];m={x:t.pageX,y:t.pageY,time:+new Date},f=void 0,v={},u.addEventListener("touchmove",this,!1),u.addEventListener("touchend",this,!1)},move:function(e){if(!(1<e.touches.length||e.scale&&1!==e.scale)){r.disableScroll&&e.preventDefault();var t=e.touches[0];v={x:t.pageX-m.x,y:t.pageY-m.y},void 0===f&&(f=!!(f||Math.abs(v.x)<Math.abs(v.y))),f||(e.preventDefault(),E(),r.continuous?(T(y(h-1),v.x+c[y(h-1)],0),T(h,v.x+c[h],0),T(y(h+1),v.x+c[y(h+1)],0)):(v.x=v.x/(!h&&0<v.x||h==l.length-1&&v.x<0?Math.abs(v.x)/d+1:1),T(h-1,v.x+c[h-1],0),T(h,v.x+c[h],0),T(h+1,v.x+c[h+1],0)))}},end:function(e){var t=+new Date-m.time,n=Number(t)<250&&20<Math.abs(v.x)||Math.abs(v.x)>d/2,i=!h&&0<v.x||h==l.length-1&&v.x<0;r.continuous&&(i=!1);var o=v.x<0;f||(n&&!i?(o?(r.continuous?(x(y(h-1),-d,0),x(y(h+2),d,0)):x(h-1,-d,0),x(h,c[h]-d,p),x(y(h+1),c[y(h+1)]-d,p),h=y(h+1)):(r.continuous?(x(y(h+1),d,0),x(y(h-2),-d,0)):x(h+1,d,0),x(h,c[h]+d,p),x(y(h-1),c[y(h-1)]+d,p),h=y(h-1)),r.callback&&r.callback(h,l[h])):r.continuous?(x(y(h-1),-d,p),x(h,0,p),x(y(h+1),d,p)):(x(h-1,-d,p),x(h,0,p),x(h+1,d,p))),u.removeEventListener("touchmove",w,!1),u.removeEventListener("touchend",w,!1)},transitionEnd:function(e){parseInt(e.target.getAttribute("data-index"),10)==h&&(g&&k(),r.transitionEnd&&r.transitionEnd.call(e,h,l[h]))}};return o(),g&&k(),s.addEventListener?(s.touch&&u.addEventListener("touchstart",w,!1),s.transitions&&(u.addEventListener("webkitTransitionEnd",w,!1),u.addEventListener("msTransitionEnd",w,!1),u.addEventListener("oTransitionEnd",w,!1),u.addEventListener("otransitionend",w,!1),u.addEventListener("transitionend",w,!1)),window.addEventListener("resize",w,!1)):window.onresize=function(){o()},{setup:function(){o()},slide:function(e,t){E(),S(e,t)},prev:function(){E(),r.continuous?S(h-1):h&&S(h-1)},next:function(){E(),b()},stop:function(){E()},getPos:function(){return h},getNumSlides:function(){return i},kill:function(){E(),u.style.width="",u.style.left="";for(var e=l.length;e--;){var t=l[e];t.style.width="",t.style.left="",s.transitions&&T(e,0,0)}s.addEventListener?(u.removeEventListener("touchstart",w,!1),u.removeEventListener("webkitTransitionEnd",w,!1),u.removeEventListener("msTransitionEnd",w,!1),u.removeEventListener("oTransitionEnd",w,!1),u.removeEventListener("otransitionend",w,!1),u.removeEventListener("transitionend",w,!1),window.removeEventListener("resize",w,!1)):window.onresize=null}}}function o(){l=u.children,i=l.length,l.length<2&&(r.continuous=!1),s.transitions&&r.continuous&&l.length<3&&(u.appendChild(l[0].cloneNode(!0)),u.appendChild(u.children[1].cloneNode(!0)),l=u.children),c=new Array(l.length),d=n.getBoundingClientRect().width||n.offsetWidth,u.style.width=l.length*d+"px";for(var e=l.length;e--;){var t=l[e];t.style.width=d+"px",t.setAttribute("data-index",e),s.transitions&&(t.style.left=e*-d+"px",x(e,e<h?-d:h<e?d:0,0))}r.continuous&&s.transitions&&(x(y(h-1),-d,0),x(y(h+1),d,0)),s.transitions||(u.style.left=h*-d+"px"),n.style.visibility="visible"}function b(){r.continuous?S(h+1):h<l.length-1&&S(h+1)}function y(e){return(l.length+e%l.length)%l.length}function S(e,t){if(h!=e){if(s.transitions){var n=Math.abs(h-e)/(h-e);if(r.continuous){var i=n;(n=-c[y(e)]/d)!==i&&(e=-n*l.length+e)}for(var o=Math.abs(h-e)-1;o--;)x(y((h<e?e:h)-o-1),d*n,0);e=y(e),x(h,d*n,t||p),x(e,0,t||p),r.continuous&&x(y(e-n),-d*n,0)}else e=y(e),function(t,n,i){if(!i)return u.style.left=n+"px";var o=+new Date,a=setInterval(function(){var e=+new Date-o;if(i<e)return u.style.left=n+"px",g&&k(),r.transitionEnd&&r.transitionEnd.call(event,h,l[h]),void clearInterval(a);u.style.left=(n-t)*(Math.floor(e/i*100)/100)+t+"px"},4)}(h*-d,e*-d,t||p);h=e,a(r.callback&&r.callback(h,l[h]))}}function x(e,t,n){T(e,t,n),c[e]=t}function T(e,t,n){var i=l[e],o=i&&i.style;o&&(o.webkitTransitionDuration=o.MozTransitionDuration=o.msTransitionDuration=o.OTransitionDuration=o.transitionDuration=n+"ms",o.webkitTransform="translate("+t+"px,0)translateZ(0)",o.msTransform=o.MozTransform=o.OTransform="translateX("+t+"px)")}function k(){e=setTimeout(b,g)}function E(){g=0,clearTimeout(e)}}function distanceOfTimeInWords(e,t,n){var i=e.getTime(),o=t.getTime(),a=Math.round(Math.abs(i-o)/1e3),r=Math.round(a/60);return r<=1?n?a<5?"5 seconde geleden":a<10?"10 seconde geleden":a<20?"20 seconde geleden":a<40?"30 seconde geleden":a<60?"een minuut geleden":"1 minuut geleden":0===r?"minder dan een minuut":"1 minuut":r<45?r+" minuten geleden":r<70?"1 uur geleden":r<1440?Math.round(r/60)+" uur geleden":r<2880?"1 dag geleden":r<43200?Math.round(r/1440)+" dagen geleden":r<86400?"ruim 1 maand geleden":r<525600?Math.round(r/43200)+" maanden geleden":Math.round(r/525600)+" jaren geleden"}function processTweets(e,t){var a=[];return $.each(e,function(e,t){var n=t;n.hasExternalUrl||(t.text=t.text.parseURL()),n.text=t.text.parseUsername().parseHashtag();var i=n.created.parseDate();delete n.created;var o=new Date;n.date=distanceOfTimeInWords(o,i,!0)+" geplaatst",n.tweetUrl="https://twitter.com/-/status/"+n.tweetId,n.retweetUrl="https://twitter.com/intent/retweet?tweet_id="+n.tweetId,n.replyUrl="https://twitter.com/intent/tweet?in_reply_to="+n.tweetId,n.likeUrl="https://twitter.com/intent/like?tweet_id="+n.tweetId,n.followUrl="https://twitter.com/intent/follow?screen_name="+n.screenName,a.push(n)}),a}APP={Views:{},YouTube:{}},function(n,i){if("function"==typeof define&&define.amd)define(["underscore","backbone"],function(e,t){i(n,e,t)});else if("undefined"!=typeof exports){var e=require("underscore"),t=require("backbone");i(n,e,t)}else i(n,n._,n.Backbone)}(this,function(e,u,t){var n=t.ViewState=function(e){var t=e||{};this.attributes=u.clone(t)};return u.extend(n.prototype,t.Events,{get:function(e){return this.attributes[e]},getAttributes:function(){return u.clone(this.attributes)},set:function(e,t,n){var i,o,a,r,s,l=[];if(null===e)return this;for(o in"object"==typeof e?(i=e,n=t):(i={})[e]=t,n||(n={}),s=n.unset,r=n.silent,a=this.attributes,i)t=i[o],u.isEqual(a[o],t)||l.push(o),s?delete a[o]:a[o]=t;if(!r){for(var c=0,d=l.length;c<d;c++)this.trigger("change:"+l[c],this,a[l[c]],n);this.trigger("change",this,n)}return this},unset:function(e,t){return this.set(e,void 0,u.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,u.extend({},e,{unset:!0}))}}),t.ViewState}),APP.Store=function(e,t){var n=new t.Collection,i=new t.ViewState({activeIndex:-1});return{start:function(e){n.reset(e),n.invoke("set",{dataSet:!1})},getState:function(){return i},getSlideCollection:function(){return n}}}(this._,this.Backbone),(window.jQuery||window.Zepto)&&function(t){t.fn.Swipe=function(e){return this.each(function(){t(this).data("Swipe",new Swipe(t(this)[0],e))})}}(window.jQuery||window.Zepto),String.prototype.parseURL=function(){return this.replace(/[A-Za-z]+:\/\/[A-Za-z0-9-_]+\.[A-Za-z0-9-_:%&~\?\/.=]+/g,function(e){return e.link(e).openUrlBlank()})},String.prototype.parseUsername=function(){return this.replace(/ [@]+[A-Za-z0-9-_]+/g,function(e){var t=e.replace(" @","");return e.link("https://twitter.com/"+t).openUrlBlank()})},String.prototype.parseHashtag=function(){return this.replace(/ [#]+[A-Za-z0-9-_]+/g,function(e){var t=e.replace(" #","%23");return e.link("https://twitter.com/search?q="+t).openUrlBlank()})},String.prototype.parseDate=function(){var e=this.replace(/(\+\S+) (.*)/,"$2 $1");return new Date(Date.parse(e))},String.prototype.openUrlBlank=function(){return this.replace(/^<a/,'$& target="_blank"')},function(e,t,i){APP.Views.Slideshow=t.View.extend({initialize:function(e){this.timeSet=e.timeSet,this.templateName=e.templateName,this.handle=e.handle,this.render(),this.listenTo(APP.Store.getState(),"change:activeIndex",this.slide);var t=Math.floor(Math.random()*this.collection.length-1);APP.Store.getState().set("activeIndex",t);var n=document.getElementById("mySwipe");window.mySwipe=i(n,{startSlide:t,auto:this.timeSet,callback:function(e,t){console.log("callback"),APP.Store.getState().set("activeIndex",e)}}),this.binds()},binds:function(){e.bindAll(this,"keyDown"),$(document).on("keydown",this.keyDown)},keyDown:function(e){switch(e.keyCode){case 37:window.mySwipe.prev();break;case 38:this.stopTimerSlide();break;case 39:window.mySwipe.next();break;case 40:this.stopTimerSlide()}},slide:function(){var e,t,n=APP.Store.getState().get("activeIndex"),i=this.collection.length;n===i?n=0:-1===n&&(n=i-1),APP.Store.getState().set("activeIndex",n,{silent:!0}),n===i-1?(e=0,t=n-1):0===n?(t=i-1,e=n+1):(e=n+1,t=n-1);var o=this.$el.find('[data-id="'+t+'"]');this.collection.get(t).get("dataSet")||(this.addContentToTemplate(o,t),"bolcomreclames"===this.handle&&addPlayer(t,this.collection.get(t).get("url")),this.collection.get(t).set("dataSet",!0));var a=this.$el.find('[data-id="'+n+'"]');this.collection.get(n).get("dataSet")||(this.addContentToTemplate(a,n),"bolcomreclames"===this.handle&&addPlayer(n,this.collection.get(n).get("url")),this.collection.get(n).set("dataSet",!0));var r=this.$el.find('[data-id="'+e+'"]');this.collection.get(e).get("dataSet")||(this.addContentToTemplate(r,e),"bolcomreclames"===this.handle&&addPlayer(e,this.collection.get(e).get("url")),this.collection.get(e).set("dataSet",!0))},getTemplateData:function(e){return this.collection.get(e).toJSON()},addContentToTemplate:function(e,t){var n=$(this.templateName).html();this.template=Handlebars.compile(n),e.append(this.template(this.getTemplateData(t)))},render:function(){var e=$("#placeholder-template").html();return this.template=Handlebars.compile(e),this.collection.each(function(e){this.$el.append(this.template(e.toJSON()))},this),this}})}(this._,Backbone,Swipe);var tag=document.createElement("script");tag.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];function addPlayer(e,t){console.log(e),APP.YouTube.youtubePlayer=[],APP.YouTube.youtubePlayer[e]=new YT.Player("youtube-player"+e,{width:"100%",height:"100%",videoId:t,events:{onStateChange:onPlayerStateChange}}),console.log(APP.YouTube.youtubePlayer[e])}function onPlayerStateChange(e){switch(console.log(e.target),e.data){case-1:console.log("video unstarted"),console.log("Duration:"+e.target.getDuration());case 0:console.log("video ended");break;case 1:console.log("video playing from "+e.target.getCurrentTime());break;case 2:console.log("video paused at "+e.target.getCurrentTime());break;case 3:console.log("video buffering");case 5:console.log("video cued")}}firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRhdGEuanMiLCJzd2lwZS5qcyIsInR3aXR0ZXIuanMiLCJhcHAuanMiLCJiYWNrYm9uZS12aWV3c3RhdGUuanMiLCJTdG9yZS5qcyIsInZpZXdzL3NsaWRlc2hvdy5qcyIsInlvdXR1YmUuanMiXSwibmFtZXMiOlsibG9hZERhdGEiLCJoYW5kbGUiLCJkYXRhVXJsIiwicXVlcnkiLCJqUXVlcnkiLCJhZGRDbGFzcyIsIiQiLCJhamF4IiwidXJsIiwidHlwZSIsInN1Y2Nlc3MiLCJyZXNwb25zZSIsImVycm9ycyIsImxlbmd0aCIsImRhdGEiLCJ0aW1lU2V0IiwiZmVlZCIsImluZGV4T2YiLCJwcm9kdWN0cyIsInByb2Nlc3NUd2VldHMiLCJvbmUiLCJlIiwiQVBQIiwiU3RvcmUiLCJzdGFydCIsIlNsaWRlc2hvdyIsIlZpZXdzIiwiZWwiLCJ0ZW1wbGF0ZU5hbWUiLCJjb2xsZWN0aW9uIiwiZ2V0U2xpZGVDb2xsZWN0aW9uIiwicmVtb3ZlQ2xhc3MiLCJ0ZXh0IiwiZXJyb3IiLCJTd2lwZSIsImNvbnRhaW5lciIsIm9wdGlvbnMiLCJub29wIiwib2ZmbG9hZEZuIiwiZm4iLCJzZXRUaW1lb3V0IiwiYnJvd3NlciIsImFkZEV2ZW50TGlzdGVuZXIiLCJ3aW5kb3ciLCJ0b3VjaCIsIkRvY3VtZW50VG91Y2giLCJkb2N1bWVudCIsInRyYW5zaXRpb25zIiwidGVtcCIsInByb3BzIiwiaSIsInVuZGVmaW5lZCIsInN0eWxlIiwiY3JlYXRlRWxlbWVudCIsInNsaWRlcyIsInNsaWRlUG9zIiwid2lkdGgiLCJlbGVtZW50IiwiY2hpbGRyZW4iLCJpbmRleCIsInBhcnNlSW50Iiwic3RhcnRTbGlkZSIsInNwZWVkIiwiY29udGludW91cyIsImludGVydmFsIiwiaXNTY3JvbGxpbmciLCJkZWxheSIsImF1dG8iLCJkZWx0YSIsImV2ZW50cyIsImhhbmRsZUV2ZW50IiwiZXZlbnQiLCJ0aGlzIiwibW92ZSIsImVuZCIsInRyYW5zaXRpb25FbmQiLCJzZXR1cCIsInN0b3BQcm9wYWdhdGlvbiIsInRvdWNoZXMiLCJ4IiwicGFnZVgiLCJ5IiwicGFnZVkiLCJ0aW1lIiwiRGF0ZSIsInNjYWxlIiwiZGlzYWJsZVNjcm9sbCIsInByZXZlbnREZWZhdWx0IiwiTWF0aCIsImFicyIsInN0b3AiLCJ0cmFuc2xhdGUiLCJjaXJjbGUiLCJkdXJhdGlvbiIsImlzVmFsaWRTbGlkZSIsIk51bWJlciIsImlzUGFzdEJvdW5kcyIsImRpcmVjdGlvbiIsImNhbGxiYWNrIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInRhcmdldCIsImdldEF0dHJpYnV0ZSIsImJlZ2luIiwiY2FsbCIsIm9ucmVzaXplIiwic2xpZGUiLCJ0byIsInByZXYiLCJuZXh0IiwiZ2V0UG9zIiwiZ2V0TnVtU2xpZGVzIiwia2lsbCIsImxlZnQiLCJwb3MiLCJhcHBlbmRDaGlsZCIsImNsb25lTm9kZSIsIkFycmF5IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0Iiwib2Zmc2V0V2lkdGgiLCJzZXRBdHRyaWJ1dGUiLCJ2aXNpYmlsaXR5Iiwic2xpZGVTcGVlZCIsIm5hdHVyYWxfZGlyZWN0aW9uIiwiZGlmZiIsImZyb20iLCJ0aW1lciIsInNldEludGVydmFsIiwidGltZUVsYXAiLCJjbGVhckludGVydmFsIiwiZmxvb3IiLCJhbmltYXRlIiwiZGlzdCIsIndlYmtpdFRyYW5zaXRpb25EdXJhdGlvbiIsIk1velRyYW5zaXRpb25EdXJhdGlvbiIsIm1zVHJhbnNpdGlvbkR1cmF0aW9uIiwiT1RyYW5zaXRpb25EdXJhdGlvbiIsInRyYW5zaXRpb25EdXJhdGlvbiIsIndlYmtpdFRyYW5zZm9ybSIsIm1zVHJhbnNmb3JtIiwiTW96VHJhbnNmb3JtIiwiT1RyYW5zZm9ybSIsImNsZWFyVGltZW91dCIsImRpc3RhbmNlT2ZUaW1lSW5Xb3JkcyIsImZyb21UaW1lIiwidG9UaW1lIiwiaW5jbHVkZVNlY29uZHMiLCJmcm9tU2Vjb25kcyIsImdldFRpbWUiLCJ0b1NlY29uZHMiLCJkaXN0YW5jZUluU2Vjb25kcyIsInJvdW5kIiwiZGlzdGFuY2VJbk1pbnV0ZXMiLCJ1bmlxdWUiLCJ0d2VldHMiLCJlYWNoIiwib2JqIiwiaGFzRXh0ZXJuYWxVcmwiLCJwYXJzZVVSTCIsInBhcnNlVXNlcm5hbWUiLCJwYXJzZUhhc2h0YWciLCJjcmVhdGVkIiwicGFyc2VEYXRlIiwibm93IiwiZGF0ZSIsInR3ZWV0VXJsIiwidHdlZXRJZCIsInJldHdlZXRVcmwiLCJyZXBseVVybCIsImxpa2VVcmwiLCJmb2xsb3dVcmwiLCJzY3JlZW5OYW1lIiwicHVzaCIsIllvdVR1YmUiLCJyb290IiwiZmFjdG9yeSIsImRlZmluZSIsImFtZCIsIl8iLCJCYWNrYm9uZSIsImV4cG9ydHMiLCJyZXF1aXJlIiwiVmlld1N0YXRlIiwiYXR0cmlidXRlcyIsImF0dHJzIiwiY2xvbmUiLCJleHRlbmQiLCJwcm90b3R5cGUiLCJFdmVudHMiLCJnZXQiLCJhdHRyIiwiZ2V0QXR0cmlidXRlcyIsInNldCIsImtleSIsInZhbCIsImN1cnJlbnQiLCJzaWxlbnQiLCJ1bnNldCIsImNoYW5nZXMiLCJpc0VxdWFsIiwibCIsInRyaWdnZXIiLCJjbGVhciIsInNsaWRlQ29sbGVjdGlvbiIsIkNvbGxlY3Rpb24iLCJzdGF0ZSIsImFjdGl2ZUluZGV4IiwiZGF0YUpzb24iLCJyZXNldCIsImludm9rZSIsImRhdGFTZXQiLCJnZXRTdGF0ZSIsIlplcHRvIiwicGFyYW1zIiwiU3RyaW5nIiwicmVwbGFjZSIsInUiLCJsaW5rIiwib3BlblVybEJsYW5rIiwidXNlcm5hbWUiLCJ0IiwidGFnIiwibmV3dGV4dCIsInBhcnNlIiwiVmlldyIsImluaXRpYWxpemUiLCJyZW5kZXIiLCJsaXN0ZW5UbyIsInJhbmRvbUluZGV4IiwicmFuZG9tIiwiZWxlbSIsImdldEVsZW1lbnRCeUlkIiwibXlTd2lwZSIsImNvbnNvbGUiLCJsb2ciLCJiaW5kcyIsImJpbmRBbGwiLCJvbiIsImtleURvd24iLCJldiIsImtleUNvZGUiLCJzdG9wVGltZXJTbGlkZSIsImFjdGl2ZSIsInNsaWRlc0xlbmdodCIsInByZXZFbCIsIiRlbCIsImZpbmQiLCJhZGRDb250ZW50VG9UZW1wbGF0ZSIsImFkZFBsYXllciIsImFjdGl2ZUVsIiwibmV4dEVsIiwiZ2V0VGVtcGxhdGVEYXRhIiwic2xpZGVuciIsInRvSlNPTiIsInNvdXJjZSIsImh0bWwiLCJ0ZW1wbGF0ZSIsIkhhbmRsZWJhcnMiLCJjb21waWxlIiwiYXBwZW5kIiwibW9kZWwiLCJzcmMiLCJmaXJzdFNjcmlwdFRhZyIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwic2xpZGVOciIsImlkIiwieW91dHViZVBsYXllciIsIllUIiwiUGxheWVyIiwiaGVpZ2h0IiwidmlkZW9JZCIsIm9uU3RhdGVDaGFuZ2UiLCJvblBsYXllclN0YXRlQ2hhbmdlIiwiZ2V0RHVyYXRpb24iLCJnZXRDdXJyZW50VGltZSIsInBhcmVudE5vZGUiLCJpbnNlcnRCZWZvcmUiXSwibWFwcGluZ3MiOiJBQUFBLFNBQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEdBQ0FDLE9BQUEsYUFBQUgsR0FBQUksU0FBQSxXQUVBQyxFQUFBQyxNQUNBQyxJQUFBTixFQUNBTyxLQUFBLE1BQ0FDLFFBQUEsU0FBQUMsR0FDQSxRQUFBLElBQUFBLEVBQUFDLFFBQUFELEVBQUFDLE9BQUFDLE9BQUEsRUFBQSxDQUNBLElBQUFDLEVBQ0FDLEVBQUEsS0FDQSxHQUFBWixFQUFBYSxLQUFBQyxRQUFBLGNBQ0FILEVBQUFILEVBQUFPLFVBQ0EsR0FBQWYsRUFBQWEsS0FBQUMsUUFBQSxtQkFDQUgsRUFBQUgsRUFDQUksRUFBQSxHQUVBRCxHQURBLEdBQUFYLEVBQUFhLEtBQUFDLFFBQUEsUUFDQU4sRUFFQVEsY0FBQVIsR0FHQVAsT0FBQSxhQUFBSCxFQUFBLFFBQUFJLFNBQUEsYUFDQUQsT0FBQSxhQUFBSCxFQUFBLFFBQUFtQixJQUFBLCtEQUFBLFNBQUFDLEdBQ0FDLElBQUFDLE1BQUFDLE1BQUFWLEdBQ0FRLElBQUFHLFVBQUEsSUFBQUgsSUFBQUksTUFBQUQsV0FDQUUsR0FBQXJCLEVBQUEsb0JBQ0FzQixhQUFB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LEVBQ0F6QyxRQUFBQyxJQUFBLG1CQUFBbEssRUFBQTZCLE9BQUE2SyxrQkFDQSxNQUNBLEtBQUEsRUFDQXpDLFFBQUFDLElBQUEsbUJBQ0EsS0FBQSxFQUNBRCxRQUFBQyxJQUFBLGVBbENBNEIsZUFBQWEsV0FBQUMsYUFBQXZELElBQUF5QyIsImZpbGUiOiJzY3JlZW5zYXZlci5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBsb2FkRGF0YShoYW5kbGUsIGRhdGFVcmwsIHF1ZXJ5KSB7XG4gIGpRdWVyeSgnLmJhY2tkcm9wLicgKyBoYW5kbGUpLmFkZENsYXNzKCd2aXNpYmxlJyk7XG5cbiAgJC5hamF4KHtcbiAgICB1cmw6IGRhdGFVcmwsXG4gICAgdHlwZTogJ0dFVCcsXG4gICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICBpZiAodHlwZW9mIHJlc3BvbnNlLmVycm9ycyA9PT0gJ3VuZGVmaW5lZCcgfHwgcmVzcG9uc2UuZXJyb3JzLmxlbmd0aCA8IDEpIHtcbiAgICAgICAgdmFyIGRhdGE7XG4gICAgICAgIHZhciB0aW1lU2V0ID0gODAwMDtcbiAgICAgICAgaWYgKHF1ZXJ5LmZlZWQuaW5kZXhPZignYm9scHVudGNvbScpICE9IC0xKSB7XG4gICAgICAgICAgZGF0YSA9IHJlc3BvbnNlLnByb2R1Y3RzO1xuICAgICAgICB9IGVsc2UgaWYocXVlcnkuZmVlZC5pbmRleE9mKCdib2xjb21yZWNsYW1lcycpICE9IC0xKSB7XG4gICAgICAgICAgZGF0YSA9IHJlc3BvbnNlO1xuICAgICAgICAgIHRpbWVTZXQgPSAwO1xuICAgICAgICB9IGVsc2UgaWYocXVlcnkuZmVlZC5pbmRleE9mKCdudW5sJykgIT0gLTEpIHtcbiAgICAgICAgICBkYXRhID0gcmVzcG9uc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGF0YSA9IHByb2Nlc3NUd2VldHMocmVzcG9uc2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgalF1ZXJ5KCcuYmFja2Ryb3AuJyArIGhhbmRsZSArICcgLnR3JykuYWRkQ2xhc3MoJ2FuaW1hdGlvbicpO1xuICAgICAgICBqUXVlcnkoJy5iYWNrZHJvcC4nICsgaGFuZGxlICsgJyAudHcnKS5vbmUoJ3dlYmtpdEFuaW1hdGlvbkVuZCBvYW5pbWF0aW9uZW5kIG1zQW5pbWF0aW9uRW5kIGFuaW1hdGlvbmVuZCcsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgQVBQLlN0b3JlLnN0YXJ0KGRhdGEpO1xuICAgICAgICAgIEFQUC5TbGlkZXNob3cgPSBuZXcgQVBQLlZpZXdzLlNsaWRlc2hvdyh7XG4gICAgICAgICAgICBlbDogJCgnLnRlbXBsYXRlLWhvbGRlcicpLFxuICAgICAgICAgICAgdGVtcGxhdGVOYW1lOiAnIycgKyBoYW5kbGUgKyAnLXRlbXBsYXRlJyxcbiAgICAgICAgICAgIGNvbGxlY3Rpb246IG5ldyBBUFAuU3RvcmUuZ2V0U2xpZGVDb2xsZWN0aW9uKCksXG4gICAgICAgICAgICB0aW1lU2V0OiB0aW1lU2V0LFxuICAgICAgICAgICAgaGFuZGxlOiBoYW5kbGVcbiAgICAgICAgICB9KVxuXG4gICAgICAgICAgJCgnLmJhY2tkcm9wLicgKyBoYW5kbGUpLnJlbW92ZUNsYXNzKCd2aXNpYmxlJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkKCcucG9zdCAubWVzc2FnZSAudGV4dC1tZXNzYWdlJykudGV4dCgnUmVzcG9uc2UgZXJyb3InKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGVycm9yOiBmdW5jdGlvbiAoZXJyb3JzKSB7XG4gICAgICAkKCcucG9zdCAubWVzc2FnZSAudGV4dC1tZXNzYWdlJykudGV4dCgnUmVxdWVzdCBlcnJvcicpO1xuICAgIH0sXG4gIH0pO1xuXG59XG4iLCIvKlxuICogU3dpcGUgMi4wXG4gKlxuICogQnJhZCBCaXJkc2FsbFxuICogQ29weXJpZ2h0IDIwMTMsIE1JVCBMaWNlbnNlXG4gKlxuKi9cblxuZnVuY3Rpb24gU3dpcGUoY29udGFpbmVyLCBvcHRpb25zKSB7XG5cbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgLy8gdXRpbGl0aWVzXG4gIHZhciBub29wID0gZnVuY3Rpb24oKSB7fTsgLy8gc2ltcGxlIG5vIG9wZXJhdGlvbiBmdW5jdGlvblxuICB2YXIgb2ZmbG9hZEZuID0gZnVuY3Rpb24oZm4pIHsgc2V0VGltZW91dChmbiB8fCBub29wLCAwKSB9OyAvLyBvZmZsb2FkIGEgZnVuY3Rpb25zIGV4ZWN1dGlvblxuXG4gIC8vIGNoZWNrIGJyb3dzZXIgY2FwYWJpbGl0aWVzXG4gIHZhciBicm93c2VyID0ge1xuICAgIGFkZEV2ZW50TGlzdGVuZXI6ICEhd2luZG93LmFkZEV2ZW50TGlzdGVuZXIsXG4gICAgdG91Y2g6ICgnb250b3VjaHN0YXJ0JyBpbiB3aW5kb3cpIHx8IHdpbmRvdy5Eb2N1bWVudFRvdWNoICYmIGRvY3VtZW50IGluc3RhbmNlb2YgRG9jdW1lbnRUb3VjaCxcbiAgICB0cmFuc2l0aW9uczogKGZ1bmN0aW9uKHRlbXApIHtcbiAgICAgIHZhciBwcm9wcyA9IFsndHJhbnNpdGlvblByb3BlcnR5JywgJ1dlYmtpdFRyYW5zaXRpb24nLCAnTW96VHJhbnNpdGlvbicsICdPVHJhbnNpdGlvbicsICdtc1RyYW5zaXRpb24nXTtcbiAgICAgIGZvciAoIHZhciBpIGluIHByb3BzICkgaWYgKHRlbXAuc3R5bGVbIHByb3BzW2ldIF0gIT09IHVuZGVmaW5lZCkgcmV0dXJuIHRydWU7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSkoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3dpcGUnKSlcbiAgfTtcblxuICAvLyBxdWl0IGlmIG5vIHJvb3QgZWxlbWVudFxuICBpZiAoIWNvbnRhaW5lcikgcmV0dXJuO1xuICB2YXIgZWxlbWVudCA9IGNvbnRhaW5lci5jaGlsZHJlblswXTtcbiAgdmFyIHNsaWRlcywgc2xpZGVQb3MsIHdpZHRoLCBsZW5ndGg7XG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICB2YXIgaW5kZXggPSBwYXJzZUludChvcHRpb25zLnN0YXJ0U2xpZGUsIDEwKSB8fCAwO1xuICB2YXIgc3BlZWQgPSBvcHRpb25zLnNwZWVkIHx8IDMwMDtcbiAgb3B0aW9ucy5jb250aW51b3VzID0gb3B0aW9ucy5jb250aW51b3VzICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmNvbnRpbnVvdXMgOiB0cnVlO1xuXG4gIGZ1bmN0aW9uIHNldHVwKCkge1xuXG4gICAgLy8gY2FjaGUgc2xpZGVzXG4gICAgc2xpZGVzID0gZWxlbWVudC5jaGlsZHJlbjtcbiAgICBsZW5ndGggPSBzbGlkZXMubGVuZ3RoO1xuXG4gICAgLy8gc2V0IGNvbnRpbnVvdXMgdG8gZmFsc2UgaWYgb25seSBvbmUgc2xpZGVcbiAgICBpZiAoc2xpZGVzLmxlbmd0aCA8IDIpIG9wdGlvbnMuY29udGludW91cyA9IGZhbHNlO1xuXG4gICAgLy9zcGVjaWFsIGNhc2UgaWYgdHdvIHNsaWRlc1xuICAgIGlmIChicm93c2VyLnRyYW5zaXRpb25zICYmIG9wdGlvbnMuY29udGludW91cyAmJiBzbGlkZXMubGVuZ3RoIDwgMykge1xuICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChzbGlkZXNbMF0uY2xvbmVOb2RlKHRydWUpKTtcbiAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoZWxlbWVudC5jaGlsZHJlblsxXS5jbG9uZU5vZGUodHJ1ZSkpO1xuICAgICAgc2xpZGVzID0gZWxlbWVudC5jaGlsZHJlbjtcbiAgICB9XG5cbiAgICAvLyBjcmVhdGUgYW4gYXJyYXkgdG8gc3RvcmUgY3VycmVudCBwb3NpdGlvbnMgb2YgZWFjaCBzbGlkZVxuICAgIHNsaWRlUG9zID0gbmV3IEFycmF5KHNsaWRlcy5sZW5ndGgpO1xuXG4gICAgLy8gZGV0ZXJtaW5lIHdpZHRoIG9mIGVhY2ggc2xpZGVcbiAgICB3aWR0aCA9IGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aCB8fCBjb250YWluZXIub2Zmc2V0V2lkdGg7XG5cbiAgICBlbGVtZW50LnN0eWxlLndpZHRoID0gKHNsaWRlcy5sZW5ndGggKiB3aWR0aCkgKyAncHgnO1xuXG4gICAgLy8gc3RhY2sgZWxlbWVudHNcbiAgICB2YXIgcG9zID0gc2xpZGVzLmxlbmd0aDtcbiAgICB3aGlsZShwb3MtLSkge1xuXG4gICAgICB2YXIgc2xpZGUgPSBzbGlkZXNbcG9zXTtcblxuICAgICAgc2xpZGUuc3R5bGUud2lkdGggPSB3aWR0aCArICdweCc7XG4gICAgICBzbGlkZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtaW5kZXgnLCBwb3MpO1xuXG4gICAgICBpZiAoYnJvd3Nlci50cmFuc2l0aW9ucykge1xuICAgICAgICBzbGlkZS5zdHlsZS5sZWZ0ID0gKHBvcyAqIC13aWR0aCkgKyAncHgnO1xuICAgICAgICBtb3ZlKHBvcywgaW5kZXggPiBwb3MgPyAtd2lkdGggOiAoaW5kZXggPCBwb3MgPyB3aWR0aCA6IDApLCAwKTtcbiAgICAgIH1cblxuICAgIH1cblxuICAgIC8vIHJlcG9zaXRpb24gZWxlbWVudHMgYmVmb3JlIGFuZCBhZnRlciBpbmRleFxuICAgIGlmIChvcHRpb25zLmNvbnRpbnVvdXMgJiYgYnJvd3Nlci50cmFuc2l0aW9ucykge1xuICAgICAgbW92ZShjaXJjbGUoaW5kZXgtMSksIC13aWR0aCwgMCk7XG4gICAgICBtb3ZlKGNpcmNsZShpbmRleCsxKSwgd2lkdGgsIDApO1xuICAgIH1cblxuICAgIGlmICghYnJvd3Nlci50cmFuc2l0aW9ucykgZWxlbWVudC5zdHlsZS5sZWZ0ID0gKGluZGV4ICogLXdpZHRoKSArICdweCc7XG5cbiAgICBjb250YWluZXIuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJztcblxuICB9XG5cbiAgZnVuY3Rpb24gcHJldigpIHtcblxuICAgIGlmIChvcHRpb25zLmNvbnRpbnVvdXMpIHNsaWRlKGluZGV4LTEpO1xuICAgIGVsc2UgaWYgKGluZGV4KSBzbGlkZShpbmRleC0xKTtcblxuICB9XG5cbiAgZnVuY3Rpb24gbmV4dCgpIHtcblxuICAgIGlmIChvcHRpb25zLmNvbnRpbnVvdXMpIHNsaWRlKGluZGV4KzEpO1xuICAgIGVsc2UgaWYgKGluZGV4IDwgc2xpZGVzLmxlbmd0aCAtIDEpIHNsaWRlKGluZGV4KzEpO1xuXG4gIH1cblxuICBmdW5jdGlvbiBjaXJjbGUoaW5kZXgpIHtcblxuICAgIC8vIGEgc2ltcGxlIHBvc2l0aXZlIG1vZHVsbyB1c2luZyBzbGlkZXMubGVuZ3RoXG4gICAgcmV0dXJuIChzbGlkZXMubGVuZ3RoICsgKGluZGV4ICUgc2xpZGVzLmxlbmd0aCkpICUgc2xpZGVzLmxlbmd0aDtcblxuICB9XG5cbiAgZnVuY3Rpb24gc2xpZGUodG8sIHNsaWRlU3BlZWQpIHtcblxuICAgIC8vIGRvIG5vdGhpbmcgaWYgYWxyZWFkeSBvbiByZXF1ZXN0ZWQgc2xpZGVcbiAgICBpZiAoaW5kZXggPT0gdG8pIHJldHVybjtcblxuICAgIGlmIChicm93c2VyLnRyYW5zaXRpb25zKSB7XG5cbiAgICAgIHZhciBkaXJlY3Rpb24gPSBNYXRoLmFicyhpbmRleC10bykgLyAoaW5kZXgtdG8pOyAvLyAxOiBiYWNrd2FyZCwgLTE6IGZvcndhcmRcblxuICAgICAgLy8gZ2V0IHRoZSBhY3R1YWwgcG9zaXRpb24gb2YgdGhlIHNsaWRlXG4gICAgICBpZiAob3B0aW9ucy5jb250aW51b3VzKSB7XG4gICAgICAgIHZhciBuYXR1cmFsX2RpcmVjdGlvbiA9IGRpcmVjdGlvbjtcbiAgICAgICAgZGlyZWN0aW9uID0gLXNsaWRlUG9zW2NpcmNsZSh0byldIC8gd2lkdGg7XG5cbiAgICAgICAgLy8gaWYgZ29pbmcgZm9yd2FyZCBidXQgdG8gPCBpbmRleCwgdXNlIHRvID0gc2xpZGVzLmxlbmd0aCArIHRvXG4gICAgICAgIC8vIGlmIGdvaW5nIGJhY2t3YXJkIGJ1dCB0byA+IGluZGV4LCB1c2UgdG8gPSAtc2xpZGVzLmxlbmd0aCArIHRvXG4gICAgICAgIGlmIChkaXJlY3Rpb24gIT09IG5hdHVyYWxfZGlyZWN0aW9uKSB0byA9ICAtZGlyZWN0aW9uICogc2xpZGVzLmxlbmd0aCArIHRvO1xuXG4gICAgICB9XG5cbiAgICAgIHZhciBkaWZmID0gTWF0aC5hYnMoaW5kZXgtdG8pIC0gMTtcblxuICAgICAgLy8gbW92ZSBhbGwgdGhlIHNsaWRlcyBiZXR3ZWVuIGluZGV4IGFuZCB0byBpbiB0aGUgcmlnaHQgZGlyZWN0aW9uXG4gICAgICB3aGlsZSAoZGlmZi0tKSBtb3ZlKCBjaXJjbGUoKHRvID4gaW5kZXggPyB0byA6IGluZGV4KSAtIGRpZmYgLSAxKSwgd2lkdGggKiBkaXJlY3Rpb24sIDApO1xuXG4gICAgICB0byA9IGNpcmNsZSh0byk7XG5cbiAgICAgIG1vdmUoaW5kZXgsIHdpZHRoICogZGlyZWN0aW9uLCBzbGlkZVNwZWVkIHx8IHNwZWVkKTtcbiAgICAgIG1vdmUodG8sIDAsIHNsaWRlU3BlZWQgfHwgc3BlZWQpO1xuXG4gICAgICBpZiAob3B0aW9ucy5jb250aW51b3VzKSBtb3ZlKGNpcmNsZSh0byAtIGRpcmVjdGlvbiksIC0od2lkdGggKiBkaXJlY3Rpb24pLCAwKTsgLy8gd2UgbmVlZCB0byBnZXQgdGhlIG5leHQgaW4gcGxhY2VcblxuICAgIH0gZWxzZSB7XG5cbiAgICAgIHRvID0gY2lyY2xlKHRvKTtcbiAgICAgIGFuaW1hdGUoaW5kZXggKiAtd2lkdGgsIHRvICogLXdpZHRoLCBzbGlkZVNwZWVkIHx8IHNwZWVkKTtcbiAgICAgIC8vbm8gZmFsbGJhY2sgZm9yIGEgY2lyY3VsYXIgY29udGludW91cyBpZiB0aGUgYnJvd3NlciBkb2VzIG5vdCBhY2NlcHQgdHJhbnNpdGlvbnNcbiAgICB9XG5cbiAgICBpbmRleCA9IHRvO1xuICAgIG9mZmxvYWRGbihvcHRpb25zLmNhbGxiYWNrICYmIG9wdGlvbnMuY2FsbGJhY2soaW5kZXgsIHNsaWRlc1tpbmRleF0pKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG1vdmUoaW5kZXgsIGRpc3QsIHNwZWVkKSB7XG5cbiAgICB0cmFuc2xhdGUoaW5kZXgsIGRpc3QsIHNwZWVkKTtcbiAgICBzbGlkZVBvc1tpbmRleF0gPSBkaXN0O1xuXG4gIH1cblxuICBmdW5jdGlvbiB0cmFuc2xhdGUoaW5kZXgsIGRpc3QsIHNwZWVkKSB7XG5cbiAgICB2YXIgc2xpZGUgPSBzbGlkZXNbaW5kZXhdO1xuICAgIHZhciBzdHlsZSA9IHNsaWRlICYmIHNsaWRlLnN0eWxlO1xuXG4gICAgaWYgKCFzdHlsZSkgcmV0dXJuO1xuXG4gICAgc3R5bGUud2Via2l0VHJhbnNpdGlvbkR1cmF0aW9uID1cbiAgICBzdHlsZS5Nb3pUcmFuc2l0aW9uRHVyYXRpb24gPVxuICAgIHN0eWxlLm1zVHJhbnNpdGlvbkR1cmF0aW9uID1cbiAgICBzdHlsZS5PVHJhbnNpdGlvbkR1cmF0aW9uID1cbiAgICBzdHlsZS50cmFuc2l0aW9uRHVyYXRpb24gPSBzcGVlZCArICdtcyc7XG5cbiAgICBzdHlsZS53ZWJraXRUcmFuc2Zvcm0gPSAndHJhbnNsYXRlKCcgKyBkaXN0ICsgJ3B4LDApJyArICd0cmFuc2xhdGVaKDApJztcbiAgICBzdHlsZS5tc1RyYW5zZm9ybSA9XG4gICAgc3R5bGUuTW96VHJhbnNmb3JtID1cbiAgICBzdHlsZS5PVHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVgoJyArIGRpc3QgKyAncHgpJztcblxuICB9XG5cbiAgZnVuY3Rpb24gYW5pbWF0ZShmcm9tLCB0bywgc3BlZWQpIHtcblxuICAgIC8vIGlmIG5vdCBhbiBhbmltYXRpb24sIGp1c3QgcmVwb3NpdGlvblxuICAgIGlmICghc3BlZWQpIHtcblxuICAgICAgZWxlbWVudC5zdHlsZS5sZWZ0ID0gdG8gKyAncHgnO1xuICAgICAgcmV0dXJuO1xuXG4gICAgfVxuXG4gICAgdmFyIHN0YXJ0ID0gK25ldyBEYXRlO1xuXG4gICAgdmFyIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG5cbiAgICAgIHZhciB0aW1lRWxhcCA9ICtuZXcgRGF0ZSAtIHN0YXJ0O1xuXG4gICAgICBpZiAodGltZUVsYXAgPiBzcGVlZCkge1xuXG4gICAgICAgIGVsZW1lbnQuc3R5bGUubGVmdCA9IHRvICsgJ3B4JztcblxuICAgICAgICBpZiAoZGVsYXkpIGJlZ2luKCk7XG5cbiAgICAgICAgb3B0aW9ucy50cmFuc2l0aW9uRW5kICYmIG9wdGlvbnMudHJhbnNpdGlvbkVuZC5jYWxsKGV2ZW50LCBpbmRleCwgc2xpZGVzW2luZGV4XSk7XG5cbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcik7XG4gICAgICAgIHJldHVybjtcblxuICAgICAgfVxuXG4gICAgICBlbGVtZW50LnN0eWxlLmxlZnQgPSAoKCAodG8gLSBmcm9tKSAqIChNYXRoLmZsb29yKCh0aW1lRWxhcCAvIHNwZWVkKSAqIDEwMCkgLyAxMDApICkgKyBmcm9tKSArICdweCc7XG5cbiAgICB9LCA0KTtcblxuICB9XG5cbiAgLy8gc2V0dXAgYXV0byBzbGlkZXNob3dcbiAgdmFyIGRlbGF5ID0gb3B0aW9ucy5hdXRvIHx8IDA7XG4gIHZhciBpbnRlcnZhbDtcblxuICBmdW5jdGlvbiBiZWdpbigpIHtcblxuICAgIGludGVydmFsID0gc2V0VGltZW91dChuZXh0LCBkZWxheSk7XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIHN0b3AoKSB7XG5cbiAgICBkZWxheSA9IDA7XG4gICAgY2xlYXJUaW1lb3V0KGludGVydmFsKTtcblxuICB9XG5cblxuICAvLyBzZXR1cCBpbml0aWFsIHZhcnNcbiAgdmFyIHN0YXJ0ID0ge307XG4gIHZhciBkZWx0YSA9IHt9O1xuICB2YXIgaXNTY3JvbGxpbmc7XG5cbiAgLy8gc2V0dXAgZXZlbnQgY2FwdHVyaW5nXG4gIHZhciBldmVudHMgPSB7XG5cbiAgICBoYW5kbGVFdmVudDogZnVuY3Rpb24oZXZlbnQpIHtcblxuICAgICAgc3dpdGNoIChldmVudC50eXBlKSB7XG4gICAgICAgIGNhc2UgJ3RvdWNoc3RhcnQnOiB0aGlzLnN0YXJ0KGV2ZW50KTsgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3RvdWNobW92ZSc6IHRoaXMubW92ZShldmVudCk7IGJyZWFrO1xuICAgICAgICBjYXNlICd0b3VjaGVuZCc6IG9mZmxvYWRGbih0aGlzLmVuZChldmVudCkpOyBicmVhaztcbiAgICAgICAgY2FzZSAnd2Via2l0VHJhbnNpdGlvbkVuZCc6XG4gICAgICAgIGNhc2UgJ21zVHJhbnNpdGlvbkVuZCc6XG4gICAgICAgIGNhc2UgJ29UcmFuc2l0aW9uRW5kJzpcbiAgICAgICAgY2FzZSAnb3RyYW5zaXRpb25lbmQnOlxuICAgICAgICBjYXNlICd0cmFuc2l0aW9uZW5kJzogb2ZmbG9hZEZuKHRoaXMudHJhbnNpdGlvbkVuZChldmVudCkpOyBicmVhaztcbiAgICAgICAgY2FzZSAncmVzaXplJzogb2ZmbG9hZEZuKHNldHVwKTsgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRpb25zLnN0b3BQcm9wYWdhdGlvbikgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICB9LFxuICAgIHN0YXJ0OiBmdW5jdGlvbihldmVudCkge1xuXG4gICAgICB2YXIgdG91Y2hlcyA9IGV2ZW50LnRvdWNoZXNbMF07XG5cbiAgICAgIC8vIG1lYXN1cmUgc3RhcnQgdmFsdWVzXG4gICAgICBzdGFydCA9IHtcblxuICAgICAgICAvLyBnZXQgaW5pdGlhbCB0b3VjaCBjb29yZHNcbiAgICAgICAgeDogdG91Y2hlcy5wYWdlWCxcbiAgICAgICAgeTogdG91Y2hlcy5wYWdlWSxcblxuICAgICAgICAvLyBzdG9yZSB0aW1lIHRvIGRldGVybWluZSB0b3VjaCBkdXJhdGlvblxuICAgICAgICB0aW1lOiArbmV3IERhdGVcblxuICAgICAgfTtcblxuICAgICAgLy8gdXNlZCBmb3IgdGVzdGluZyBmaXJzdCBtb3ZlIGV2ZW50XG4gICAgICBpc1Njcm9sbGluZyA9IHVuZGVmaW5lZDtcblxuICAgICAgLy8gcmVzZXQgZGVsdGEgYW5kIGVuZCBtZWFzdXJlbWVudHNcbiAgICAgIGRlbHRhID0ge307XG5cbiAgICAgIC8vIGF0dGFjaCB0b3VjaG1vdmUgYW5kIHRvdWNoZW5kIGxpc3RlbmVyc1xuICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCB0aGlzLCBmYWxzZSk7XG4gICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdGhpcywgZmFsc2UpO1xuXG4gICAgfSxcbiAgICBtb3ZlOiBmdW5jdGlvbihldmVudCkge1xuXG4gICAgICAvLyBlbnN1cmUgc3dpcGluZyB3aXRoIG9uZSB0b3VjaCBhbmQgbm90IHBpbmNoaW5nXG4gICAgICBpZiAoIGV2ZW50LnRvdWNoZXMubGVuZ3RoID4gMSB8fCBldmVudC5zY2FsZSAmJiBldmVudC5zY2FsZSAhPT0gMSkgcmV0dXJuXG5cbiAgICAgIGlmIChvcHRpb25zLmRpc2FibGVTY3JvbGwpIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgIHZhciB0b3VjaGVzID0gZXZlbnQudG91Y2hlc1swXTtcblxuICAgICAgLy8gbWVhc3VyZSBjaGFuZ2UgaW4geCBhbmQgeVxuICAgICAgZGVsdGEgPSB7XG4gICAgICAgIHg6IHRvdWNoZXMucGFnZVggLSBzdGFydC54LFxuICAgICAgICB5OiB0b3VjaGVzLnBhZ2VZIC0gc3RhcnQueVxuICAgICAgfVxuXG4gICAgICAvLyBkZXRlcm1pbmUgaWYgc2Nyb2xsaW5nIHRlc3QgaGFzIHJ1biAtIG9uZSB0aW1lIHRlc3RcbiAgICAgIGlmICggdHlwZW9mIGlzU2Nyb2xsaW5nID09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIGlzU2Nyb2xsaW5nID0gISEoIGlzU2Nyb2xsaW5nIHx8IE1hdGguYWJzKGRlbHRhLngpIDwgTWF0aC5hYnMoZGVsdGEueSkgKTtcbiAgICAgIH1cblxuICAgICAgLy8gaWYgdXNlciBpcyBub3QgdHJ5aW5nIHRvIHNjcm9sbCB2ZXJ0aWNhbGx5XG4gICAgICBpZiAoIWlzU2Nyb2xsaW5nKSB7XG5cbiAgICAgICAgLy8gcHJldmVudCBuYXRpdmUgc2Nyb2xsaW5nXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgLy8gc3RvcCBzbGlkZXNob3dcbiAgICAgICAgc3RvcCgpO1xuXG4gICAgICAgIC8vIGluY3JlYXNlIHJlc2lzdGFuY2UgaWYgZmlyc3Qgb3IgbGFzdCBzbGlkZVxuICAgICAgICBpZiAob3B0aW9ucy5jb250aW51b3VzKSB7IC8vIHdlIGRvbid0IGFkZCByZXNpc3RhbmNlIGF0IHRoZSBlbmRcblxuICAgICAgICAgIHRyYW5zbGF0ZShjaXJjbGUoaW5kZXgtMSksIGRlbHRhLnggKyBzbGlkZVBvc1tjaXJjbGUoaW5kZXgtMSldLCAwKTtcbiAgICAgICAgICB0cmFuc2xhdGUoaW5kZXgsIGRlbHRhLnggKyBzbGlkZVBvc1tpbmRleF0sIDApO1xuICAgICAgICAgIHRyYW5zbGF0ZShjaXJjbGUoaW5kZXgrMSksIGRlbHRhLnggKyBzbGlkZVBvc1tjaXJjbGUoaW5kZXgrMSldLCAwKTtcblxuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgZGVsdGEueCA9XG4gICAgICAgICAgICBkZWx0YS54IC9cbiAgICAgICAgICAgICAgKCAoIWluZGV4ICYmIGRlbHRhLnggPiAwICAgICAgICAgICAgICAgLy8gaWYgZmlyc3Qgc2xpZGUgYW5kIHNsaWRpbmcgbGVmdFxuICAgICAgICAgICAgICAgIHx8IGluZGV4ID09IHNsaWRlcy5sZW5ndGggLSAxICAgICAgICAvLyBvciBpZiBsYXN0IHNsaWRlIGFuZCBzbGlkaW5nIHJpZ2h0XG4gICAgICAgICAgICAgICAgJiYgZGVsdGEueCA8IDAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFuZCBpZiBzbGlkaW5nIGF0IGFsbFxuICAgICAgICAgICAgICApID9cbiAgICAgICAgICAgICAgKCBNYXRoLmFicyhkZWx0YS54KSAvIHdpZHRoICsgMSApICAgICAgLy8gZGV0ZXJtaW5lIHJlc2lzdGFuY2UgbGV2ZWxcbiAgICAgICAgICAgICAgOiAxICk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm8gcmVzaXN0YW5jZSBpZiBmYWxzZVxuXG4gICAgICAgICAgLy8gdHJhbnNsYXRlIDE6MVxuICAgICAgICAgIHRyYW5zbGF0ZShpbmRleC0xLCBkZWx0YS54ICsgc2xpZGVQb3NbaW5kZXgtMV0sIDApO1xuICAgICAgICAgIHRyYW5zbGF0ZShpbmRleCwgZGVsdGEueCArIHNsaWRlUG9zW2luZGV4XSwgMCk7XG4gICAgICAgICAgdHJhbnNsYXRlKGluZGV4KzEsIGRlbHRhLnggKyBzbGlkZVBvc1tpbmRleCsxXSwgMCk7XG4gICAgICAgIH1cblxuICAgICAgfVxuXG4gICAgfSxcbiAgICBlbmQ6IGZ1bmN0aW9uKGV2ZW50KSB7XG5cbiAgICAgIC8vIG1lYXN1cmUgZHVyYXRpb25cbiAgICAgIHZhciBkdXJhdGlvbiA9ICtuZXcgRGF0ZSAtIHN0YXJ0LnRpbWU7XG5cbiAgICAgIC8vIGRldGVybWluZSBpZiBzbGlkZSBhdHRlbXB0IHRyaWdnZXJzIG5leHQvcHJldiBzbGlkZVxuICAgICAgdmFyIGlzVmFsaWRTbGlkZSA9XG4gICAgICAgICAgICBOdW1iZXIoZHVyYXRpb24pIDwgMjUwICAgICAgICAgICAgICAgLy8gaWYgc2xpZGUgZHVyYXRpb24gaXMgbGVzcyB0aGFuIDI1MG1zXG4gICAgICAgICAgICAmJiBNYXRoLmFicyhkZWx0YS54KSA+IDIwICAgICAgICAgICAgLy8gYW5kIGlmIHNsaWRlIGFtdCBpcyBncmVhdGVyIHRoYW4gMjBweFxuICAgICAgICAgICAgfHwgTWF0aC5hYnMoZGVsdGEueCkgPiB3aWR0aC8yOyAgICAgIC8vIG9yIGlmIHNsaWRlIGFtdCBpcyBncmVhdGVyIHRoYW4gaGFsZiB0aGUgd2lkdGhcblxuICAgICAgLy8gZGV0ZXJtaW5lIGlmIHNsaWRlIGF0dGVtcHQgaXMgcGFzdCBzdGFydCBhbmQgZW5kXG4gICAgICB2YXIgaXNQYXN0Qm91bmRzID1cbiAgICAgICAgICAgICFpbmRleCAmJiBkZWx0YS54ID4gMCAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiBmaXJzdCBzbGlkZSBhbmQgc2xpZGUgYW10IGlzIGdyZWF0ZXIgdGhhbiAwXG4gICAgICAgICAgICB8fCBpbmRleCA9PSBzbGlkZXMubGVuZ3RoIC0gMSAmJiBkZWx0YS54IDwgMDsgICAgLy8gb3IgaWYgbGFzdCBzbGlkZSBhbmQgc2xpZGUgYW10IGlzIGxlc3MgdGhhbiAwXG5cbiAgICAgIGlmIChvcHRpb25zLmNvbnRpbnVvdXMpIGlzUGFzdEJvdW5kcyA9IGZhbHNlO1xuXG4gICAgICAvLyBkZXRlcm1pbmUgZGlyZWN0aW9uIG9mIHN3aXBlICh0cnVlOnJpZ2h0LCBmYWxzZTpsZWZ0KVxuICAgICAgdmFyIGRpcmVjdGlvbiA9IGRlbHRhLnggPCAwO1xuXG4gICAgICAvLyBpZiBub3Qgc2Nyb2xsaW5nIHZlcnRpY2FsbHlcbiAgICAgIGlmICghaXNTY3JvbGxpbmcpIHtcblxuICAgICAgICBpZiAoaXNWYWxpZFNsaWRlICYmICFpc1Bhc3RCb3VuZHMpIHtcblxuICAgICAgICAgIGlmIChkaXJlY3Rpb24pIHtcblxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuY29udGludW91cykgeyAvLyB3ZSBuZWVkIHRvIGdldCB0aGUgbmV4dCBpbiB0aGlzIGRpcmVjdGlvbiBpbiBwbGFjZVxuXG4gICAgICAgICAgICAgIG1vdmUoY2lyY2xlKGluZGV4LTEpLCAtd2lkdGgsIDApO1xuICAgICAgICAgICAgICBtb3ZlKGNpcmNsZShpbmRleCsyKSwgd2lkdGgsIDApO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBtb3ZlKGluZGV4LTEsIC13aWR0aCwgMCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG1vdmUoaW5kZXgsIHNsaWRlUG9zW2luZGV4XS13aWR0aCwgc3BlZWQpO1xuICAgICAgICAgICAgbW92ZShjaXJjbGUoaW5kZXgrMSksIHNsaWRlUG9zW2NpcmNsZShpbmRleCsxKV0td2lkdGgsIHNwZWVkKTtcbiAgICAgICAgICAgIGluZGV4ID0gY2lyY2xlKGluZGV4KzEpO1xuXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmNvbnRpbnVvdXMpIHsgLy8gd2UgbmVlZCB0byBnZXQgdGhlIG5leHQgaW4gdGhpcyBkaXJlY3Rpb24gaW4gcGxhY2VcblxuICAgICAgICAgICAgICBtb3ZlKGNpcmNsZShpbmRleCsxKSwgd2lkdGgsIDApO1xuICAgICAgICAgICAgICBtb3ZlKGNpcmNsZShpbmRleC0yKSwgLXdpZHRoLCAwKTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgbW92ZShpbmRleCsxLCB3aWR0aCwgMCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG1vdmUoaW5kZXgsIHNsaWRlUG9zW2luZGV4XSt3aWR0aCwgc3BlZWQpO1xuICAgICAgICAgICAgbW92ZShjaXJjbGUoaW5kZXgtMSksIHNsaWRlUG9zW2NpcmNsZShpbmRleC0xKV0rd2lkdGgsIHNwZWVkKTtcbiAgICAgICAgICAgIGluZGV4ID0gY2lyY2xlKGluZGV4LTEpO1xuXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgb3B0aW9ucy5jYWxsYmFjayAmJiBvcHRpb25zLmNhbGxiYWNrKGluZGV4LCBzbGlkZXNbaW5kZXhdKTtcblxuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgaWYgKG9wdGlvbnMuY29udGludW91cykge1xuXG4gICAgICAgICAgICBtb3ZlKGNpcmNsZShpbmRleC0xKSwgLXdpZHRoLCBzcGVlZCk7XG4gICAgICAgICAgICBtb3ZlKGluZGV4LCAwLCBzcGVlZCk7XG4gICAgICAgICAgICBtb3ZlKGNpcmNsZShpbmRleCsxKSwgd2lkdGgsIHNwZWVkKTtcblxuICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgIG1vdmUoaW5kZXgtMSwgLXdpZHRoLCBzcGVlZCk7XG4gICAgICAgICAgICBtb3ZlKGluZGV4LCAwLCBzcGVlZCk7XG4gICAgICAgICAgICBtb3ZlKGluZGV4KzEsIHdpZHRoLCBzcGVlZCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgICAgfVxuXG4gICAgICAvLyBraWxsIHRvdWNobW92ZSBhbmQgdG91Y2hlbmQgZXZlbnQgbGlzdGVuZXJzIHVudGlsIHRvdWNoc3RhcnQgY2FsbGVkIGFnYWluXG4gICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIGV2ZW50cywgZmFsc2UpXG4gICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgZXZlbnRzLCBmYWxzZSlcblxuICAgIH0sXG4gICAgdHJhbnNpdGlvbkVuZDogZnVuY3Rpb24oZXZlbnQpIHtcblxuICAgICAgaWYgKHBhcnNlSW50KGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaW5kZXgnKSwgMTApID09IGluZGV4KSB7XG5cbiAgICAgICAgaWYgKGRlbGF5KSBiZWdpbigpO1xuXG4gICAgICAgIG9wdGlvbnMudHJhbnNpdGlvbkVuZCAmJiBvcHRpb25zLnRyYW5zaXRpb25FbmQuY2FsbChldmVudCwgaW5kZXgsIHNsaWRlc1tpbmRleF0pO1xuXG4gICAgICB9XG5cbiAgICB9XG5cbiAgfVxuXG4gIC8vIHRyaWdnZXIgc2V0dXBcbiAgc2V0dXAoKTtcblxuICAvLyBzdGFydCBhdXRvIHNsaWRlc2hvdyBpZiBhcHBsaWNhYmxlXG4gIGlmIChkZWxheSkgYmVnaW4oKTtcblxuXG4gIC8vIGFkZCBldmVudCBsaXN0ZW5lcnNcbiAgaWYgKGJyb3dzZXIuYWRkRXZlbnRMaXN0ZW5lcikge1xuXG4gICAgLy8gc2V0IHRvdWNoc3RhcnQgZXZlbnQgb24gZWxlbWVudFxuICAgIGlmIChicm93c2VyLnRvdWNoKSBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBldmVudHMsIGZhbHNlKTtcblxuICAgIGlmIChicm93c2VyLnRyYW5zaXRpb25zKSB7XG4gICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3dlYmtpdFRyYW5zaXRpb25FbmQnLCBldmVudHMsIGZhbHNlKTtcbiAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbXNUcmFuc2l0aW9uRW5kJywgZXZlbnRzLCBmYWxzZSk7XG4gICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ29UcmFuc2l0aW9uRW5kJywgZXZlbnRzLCBmYWxzZSk7XG4gICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ290cmFuc2l0aW9uZW5kJywgZXZlbnRzLCBmYWxzZSk7XG4gICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RyYW5zaXRpb25lbmQnLCBldmVudHMsIGZhbHNlKTtcbiAgICB9XG5cbiAgICAvLyBzZXQgcmVzaXplIGV2ZW50IG9uIHdpbmRvd1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBldmVudHMsIGZhbHNlKTtcblxuICB9IGVsc2Uge1xuXG4gICAgd2luZG93Lm9ucmVzaXplID0gZnVuY3Rpb24gKCkgeyBzZXR1cCgpIH07IC8vIHRvIHBsYXkgbmljZSB3aXRoIG9sZCBJRVxuXG4gIH1cblxuICAvLyBleHBvc2UgdGhlIFN3aXBlIEFQSVxuICByZXR1cm4ge1xuICAgIHNldHVwOiBmdW5jdGlvbigpIHtcblxuICAgICAgc2V0dXAoKTtcblxuICAgIH0sXG4gICAgc2xpZGU6IGZ1bmN0aW9uKHRvLCBzcGVlZCkge1xuXG4gICAgICAvLyBjYW5jZWwgc2xpZGVzaG93XG4gICAgICBzdG9wKCk7XG5cbiAgICAgIHNsaWRlKHRvLCBzcGVlZCk7XG5cbiAgICB9LFxuICAgIHByZXY6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAvLyBjYW5jZWwgc2xpZGVzaG93XG4gICAgICBzdG9wKCk7XG5cbiAgICAgIHByZXYoKTtcblxuICAgIH0sXG4gICAgbmV4dDogZnVuY3Rpb24oKSB7XG5cbiAgICAgIC8vIGNhbmNlbCBzbGlkZXNob3dcbiAgICAgIHN0b3AoKTtcblxuICAgICAgbmV4dCgpO1xuXG4gICAgfSxcbiAgICBzdG9wOiBmdW5jdGlvbigpIHtcblxuICAgICAgLy8gY2FuY2VsIHNsaWRlc2hvd1xuICAgICAgc3RvcCgpO1xuXG4gICAgfSxcbiAgICBnZXRQb3M6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAvLyByZXR1cm4gY3VycmVudCBpbmRleCBwb3NpdGlvblxuICAgICAgcmV0dXJuIGluZGV4O1xuXG4gICAgfSxcbiAgICBnZXROdW1TbGlkZXM6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAvLyByZXR1cm4gdG90YWwgbnVtYmVyIG9mIHNsaWRlc1xuICAgICAgcmV0dXJuIGxlbmd0aDtcbiAgICB9LFxuICAgIGtpbGw6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAvLyBjYW5jZWwgc2xpZGVzaG93XG4gICAgICBzdG9wKCk7XG5cbiAgICAgIC8vIHJlc2V0IGVsZW1lbnRcbiAgICAgIGVsZW1lbnQuc3R5bGUud2lkdGggPSAnJztcbiAgICAgIGVsZW1lbnQuc3R5bGUubGVmdCA9ICcnO1xuXG4gICAgICAvLyByZXNldCBzbGlkZXNcbiAgICAgIHZhciBwb3MgPSBzbGlkZXMubGVuZ3RoO1xuICAgICAgd2hpbGUocG9zLS0pIHtcblxuICAgICAgICB2YXIgc2xpZGUgPSBzbGlkZXNbcG9zXTtcbiAgICAgICAgc2xpZGUuc3R5bGUud2lkdGggPSAnJztcbiAgICAgICAgc2xpZGUuc3R5bGUubGVmdCA9ICcnO1xuXG4gICAgICAgIGlmIChicm93c2VyLnRyYW5zaXRpb25zKSB0cmFuc2xhdGUocG9zLCAwLCAwKTtcblxuICAgICAgfVxuXG4gICAgICAvLyByZW1vdmVkIGV2ZW50IGxpc3RlbmVyc1xuICAgICAgaWYgKGJyb3dzZXIuYWRkRXZlbnRMaXN0ZW5lcikge1xuXG4gICAgICAgIC8vIHJlbW92ZSBjdXJyZW50IGV2ZW50IGxpc3RlbmVyc1xuICAgICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBldmVudHMsIGZhbHNlKTtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd3ZWJraXRUcmFuc2l0aW9uRW5kJywgZXZlbnRzLCBmYWxzZSk7XG4gICAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbXNUcmFuc2l0aW9uRW5kJywgZXZlbnRzLCBmYWxzZSk7XG4gICAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignb1RyYW5zaXRpb25FbmQnLCBldmVudHMsIGZhbHNlKTtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdvdHJhbnNpdGlvbmVuZCcsIGV2ZW50cywgZmFsc2UpO1xuICAgICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RyYW5zaXRpb25lbmQnLCBldmVudHMsIGZhbHNlKTtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGV2ZW50cywgZmFsc2UpO1xuXG4gICAgICB9XG4gICAgICBlbHNlIHtcblxuICAgICAgICB3aW5kb3cub25yZXNpemUgPSBudWxsO1xuXG4gICAgICB9XG5cbiAgICB9XG4gIH1cblxufVxuXG5cbmlmICggd2luZG93LmpRdWVyeSB8fCB3aW5kb3cuWmVwdG8gKSB7XG4gIChmdW5jdGlvbigkKSB7XG4gICAgJC5mbi5Td2lwZSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgJCh0aGlzKS5kYXRhKCdTd2lwZScsIG5ldyBTd2lwZSgkKHRoaXMpWzBdLCBwYXJhbXMpKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSkoIHdpbmRvdy5qUXVlcnkgfHwgd2luZG93LlplcHRvIClcbn1cbiIsImZ1bmN0aW9uIGRpc3RhbmNlT2ZUaW1lSW5Xb3Jkcyhmcm9tVGltZSwgdG9UaW1lLCBpbmNsdWRlU2Vjb25kcykge1xuICB2YXIgZnJvbVNlY29uZHMgPSBmcm9tVGltZS5nZXRUaW1lKCk7XG4gIHZhciB0b1NlY29uZHMgPSB0b1RpbWUuZ2V0VGltZSgpO1xuICB2YXIgZGlzdGFuY2VJblNlY29uZHMgPSBNYXRoLnJvdW5kKE1hdGguYWJzKGZyb21TZWNvbmRzIC0gdG9TZWNvbmRzKSAvIDEwMDApO1xuICB2YXIgZGlzdGFuY2VJbk1pbnV0ZXMgPSBNYXRoLnJvdW5kKGRpc3RhbmNlSW5TZWNvbmRzIC8gNjApO1xuICBpZiAoZGlzdGFuY2VJbk1pbnV0ZXMgPD0gMSkge1xuICAgIGlmICghaW5jbHVkZVNlY29uZHMpXG4gICAgICByZXR1cm4gKGRpc3RhbmNlSW5NaW51dGVzID09PSAwKSA/ICdtaW5kZXIgZGFuIGVlbiBtaW51dXQnIDogJzEgbWludXV0JztcbiAgICBpZiAoZGlzdGFuY2VJblNlY29uZHMgPCA1KVxuICAgICAgcmV0dXJuICc1IHNlY29uZGUgZ2VsZWRlbic7XG4gICAgaWYgKGRpc3RhbmNlSW5TZWNvbmRzIDwgMTApXG4gICAgICByZXR1cm4gJzEwIHNlY29uZGUgZ2VsZWRlbic7XG4gICAgaWYgKGRpc3RhbmNlSW5TZWNvbmRzIDwgMjApXG4gICAgICByZXR1cm4gJzIwIHNlY29uZGUgZ2VsZWRlbic7XG4gICAgaWYgKGRpc3RhbmNlSW5TZWNvbmRzIDwgNDApXG4gICAgICByZXR1cm4gJzMwIHNlY29uZGUgZ2VsZWRlbic7XG4gICAgaWYgKGRpc3RhbmNlSW5TZWNvbmRzIDwgNjApXG4gICAgICByZXR1cm4gJ2VlbiBtaW51dXQgZ2VsZWRlbic7XG4gICAgZWxzZVxuICAgICAgcmV0dXJuICcxIG1pbnV1dCBnZWxlZGVuJztcbiAgfVxuXG4gIGlmIChkaXN0YW5jZUluTWludXRlcyA8IDQ1KVxuICAgIHJldHVybiBkaXN0YW5jZUluTWludXRlcyArICcgbWludXRlbiBnZWxlZGVuJztcbiAgaWYgKGRpc3RhbmNlSW5NaW51dGVzIDwgNzApXG4gICAgcmV0dXJuICcxIHV1ciBnZWxlZGVuJztcbiAgaWYgKGRpc3RhbmNlSW5NaW51dGVzIDwgMTQ0MClcbiAgICByZXR1cm4gKE1hdGgucm91bmQoZGlzdGFuY2VJbk1pbnV0ZXMgLyA2MCkpICsgJyB1dXIgZ2VsZWRlbic7XG4gIGlmIChkaXN0YW5jZUluTWludXRlcyA8IDI4ODApXG4gICAgcmV0dXJuICcxIGRhZyBnZWxlZGVuJztcbiAgaWYgKGRpc3RhbmNlSW5NaW51dGVzIDwgNDMyMDApXG4gICAgcmV0dXJuIChNYXRoLnJvdW5kKGRpc3RhbmNlSW5NaW51dGVzIC8gMTQ0MCkpICsgJyBkYWdlbiBnZWxlZGVuJztcbiAgaWYgKGRpc3RhbmNlSW5NaW51dGVzIDwgODY0MDApXG4gICAgcmV0dXJuICdydWltIDEgbWFhbmQgZ2VsZWRlbic7XG4gIGlmIChkaXN0YW5jZUluTWludXRlcyA8IDUyNTYwMClcbiAgICByZXR1cm4gKE1hdGgucm91bmQoZGlzdGFuY2VJbk1pbnV0ZXMgLyA0MzIwMCkpICsgJyBtYWFuZGVuIGdlbGVkZW4nO1xuICBlbHNlXG4gICAgcmV0dXJuIChNYXRoLnJvdW5kKGRpc3RhbmNlSW5NaW51dGVzIC8gNTI1NjAwKSkgKyAnIGphcmVuIGdlbGVkZW4nO1xufTtcblxuLy9Ud2l0dGVyIFBhcnNlcnNcblN0cmluZy5wcm90b3R5cGUucGFyc2VVUkwgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzLnJlcGxhY2UoL1tBLVphLXpdKzpcXC9cXC9bQS1aYS16MC05LV9dK1xcLltBLVphLXowLTktXzolJn5cXD9cXC8uPV0rL2csIGZ1bmN0aW9uICh1KSB7XG4gICAgcmV0dXJuIHUubGluayh1KS5vcGVuVXJsQmxhbmsoKTtcbiAgfSk7XG59O1xuXG5TdHJpbmcucHJvdG90eXBlLnBhcnNlVXNlcm5hbWUgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzLnJlcGxhY2UoLyBbQF0rW0EtWmEtejAtOS1fXSsvZywgZnVuY3Rpb24gKHUpIHtcbiAgICB2YXIgdXNlcm5hbWUgPSB1LnJlcGxhY2UoJyBAJywgJycpO1xuICAgIHJldHVybiB1LmxpbmsoJ2h0dHBzOi8vdHdpdHRlci5jb20vJyArIHVzZXJuYW1lKS5vcGVuVXJsQmxhbmsoKTtcbiAgfSk7XG59O1xuXG5TdHJpbmcucHJvdG90eXBlLnBhcnNlSGFzaHRhZyA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHRoaXMucmVwbGFjZSgvIFsjXStbQS1aYS16MC05LV9dKy9nLCBmdW5jdGlvbiAodCkge1xuICAgIHZhciB0YWcgPSB0LnJlcGxhY2UoJyAjJywgJyUyMycpO1xuICAgIHJldHVybiB0LmxpbmsoJ2h0dHBzOi8vdHdpdHRlci5jb20vc2VhcmNoP3E9JyArIHRhZykub3BlblVybEJsYW5rKCk7XG4gIH0pO1xufTtcblxuU3RyaW5nLnByb3RvdHlwZS5wYXJzZURhdGUgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBuZXd0ZXh0ID0gdGhpcy5yZXBsYWNlKC8oXFwrXFxTKykgKC4qKS8sICckMiAkMScpO1xuICB2YXIgZGF0ZSA9IG5ldyBEYXRlKERhdGUucGFyc2UobmV3dGV4dCkpO1xuICByZXR1cm4gZGF0ZTtcbn07XG5cblN0cmluZy5wcm90b3R5cGUub3BlblVybEJsYW5rID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5yZXBsYWNlKC9ePGEvLCAnJCYgdGFyZ2V0PVwiX2JsYW5rXCInKTtcbn1cblxuZnVuY3Rpb24gcHJvY2Vzc1R3ZWV0cyhkYXRhLCB1bmlxdWUpIHtcbiAgdmFyIHR3ZWV0cyA9IFtdO1xuICAkLmVhY2goZGF0YSwgZnVuY3Rpb24gKGksIG9iaikge1xuICAgIHZhciBlbGVtZW50ID0gb2JqO1xuICAgIGlmKCFlbGVtZW50Lmhhc0V4dGVybmFsVXJsKSB7XG4gICAgICBvYmoudGV4dCA9IG9iai50ZXh0LnBhcnNlVVJMKCk7XG4gICAgfVxuICAgIGVsZW1lbnQudGV4dCA9IG9iai50ZXh0LnBhcnNlVXNlcm5hbWUoKS5wYXJzZUhhc2h0YWcoKTtcbiAgICB2YXIgY3JlYXRlZCA9IGVsZW1lbnQuY3JlYXRlZC5wYXJzZURhdGUoKTtcbiAgICBkZWxldGUgZWxlbWVudC5jcmVhdGVkO1xuICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIGVsZW1lbnQuZGF0ZSA9IGRpc3RhbmNlT2ZUaW1lSW5Xb3Jkcyhub3csIGNyZWF0ZWQsIHRydWUpICsgJyBnZXBsYWF0c3QnO1xuICAgIGVsZW1lbnQudHdlZXRVcmwgPSAnaHR0cHM6Ly90d2l0dGVyLmNvbS8tL3N0YXR1cy8nICsgZWxlbWVudC50d2VldElkO1xuICAgIGVsZW1lbnQucmV0d2VldFVybCA9ICdodHRwczovL3R3aXR0ZXIuY29tL2ludGVudC9yZXR3ZWV0P3R3ZWV0X2lkPScgKyBlbGVtZW50LnR3ZWV0SWQ7XG4gICAgZWxlbWVudC5yZXBseVVybCA9ICdodHRwczovL3R3aXR0ZXIuY29tL2ludGVudC90d2VldD9pbl9yZXBseV90bz0nICsgZWxlbWVudC50d2VldElkO1xuICAgIGVsZW1lbnQubGlrZVVybCA9ICdodHRwczovL3R3aXR0ZXIuY29tL2ludGVudC9saWtlP3R3ZWV0X2lkPScgKyBlbGVtZW50LnR3ZWV0SWQ7XG4gICAgZWxlbWVudC5mb2xsb3dVcmwgPSAnaHR0cHM6Ly90d2l0dGVyLmNvbS9pbnRlbnQvZm9sbG93P3NjcmVlbl9uYW1lPScgKyBlbGVtZW50LnNjcmVlbk5hbWU7XG4gICAgdHdlZXRzLnB1c2goZWxlbWVudCk7XG4gIH0pO1xuICByZXR1cm4gdHdlZXRzO1xufTtcbiIsIihmdW5jdGlvbiAoKSB7XG5cbiAgLy8gYXBwIG5hbWVzcGFjZSBzZXR1cFxuICBBUFAgPSB7XG4gICAgVmlld3M6IHt9LFxuICAgIFlvdVR1YmU6IHt9XG4gIH07XG5cbn0pKCk7XG4iLCIvLyBmb3IganNoaW50XG4vKmdsb2JhbCByZXF1aXJlLCBkZWZpbmUgKi9cblxuKGZ1bmN0aW9uKHJvb3QsIGZhY3RvcnkpIHtcbiAgLy8gU3RhcnQgd2l0aCBBTUQgc3VwcG9ydC5cbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIGRlZmluZShbJ3VuZGVyc2NvcmUnLCAnYmFja2JvbmUnXSwgZnVuY3Rpb24oXywgQmFja2JvbmUpIHtcbiAgICAgIGZhY3Rvcnkocm9vdCwgXywgQmFja2JvbmUpO1xuICAgIH0pO1xuXG4gIC8vIE5leHQgY2hlY2sgZm9yIE5vZGUuanMgb3IgQ29tbW9uSlMuXG4gIH0gZWxzZSBpZiAodHlwZW9mIGV4cG9ydHMgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgdmFyIF8gPSByZXF1aXJlKCd1bmRlcnNjb3JlJyk7XG4gICAgdmFyIEJhY2tib25lID0gcmVxdWlyZSgnYmFja2JvbmUnKTtcbiAgICBmYWN0b3J5KHJvb3QsIF8sIEJhY2tib25lKTtcblxuICAvLyBGaW5uYWx5LCBpZiBub25lIG9mIHRoZSBhYm92ZSwgY3JlYXRlIHRoZSBleHRlbnNpb24gYW5kXG4gIC8vIGFzc3VtZSBCYWNrYm9uZSBpcyBhdmFpbGFibGUgYXQgKGJyb3dzZXIpIGdsb2JhbCBzY29wZS5cbiAgfSBlbHNlIHtcbiAgICBmYWN0b3J5KHJvb3QsIHJvb3QuXywgcm9vdC5CYWNrYm9uZSk7XG4gIH1cbn0odGhpcywgZnVuY3Rpb24ocm9vdCwgXywgQmFja2JvbmUpIHtcblxuICAvLyBCYWNrYm9uZS5WaWV3U3RhdGVcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gYEJhY2tib25lLlZpZXdTdGF0ZWAgb2JqZWN0cyBhcmUgZGVzaWduZWQgdG8gYmUgbm90aGluZyBtb3JlIGJ1dFxuICAvLyBhIHdyYXBwZXIgdGhhdCBpcyBub3QgYSBNb2RlbCBidXQgZG9lcyBuZWVkIHRvICdob2xkJyBkYXRhLlxuICAvLyBBbiBleGFtcGxlIG9mIGEgVmlld1N0YXRlIHZhbHVlIGlzIHdoZW4geW91ciBtb3VzZSBvciBmaW5nZXJcbiAgLy8gaXMgaG92ZXJpbmcgb3ZlciBzb21lIHRhcmdldCB0byBhZGQgYHtvdmVyOiB0cnVlfWAgdG8gdGhlIHZpZXdTdGF0ZS5cbiAgLy8gVGhlIGlkZWEgYmVoaW5kIGl0IGlzIHRoYXQgeW91IGNhbiB1c2UgZ2V0QXR0cmlidXRlcyBhcyBkZWZhdWx0XG4gIC8vIGZvciBkYXRhIGluIHlvdXIgcmVuZGVyIGZ1bmN0aW9uLlxuXG4gIC8vIEZvciBleGFtcGxlOlxuICAvL1xuICAvLyAgICAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgLy8gICAgICAgdGhpcy5lbC5odG1sKHRlbXBsYXRlKF8uZXh0ZW5kKFxuICAvLyAgICAgICAgICB0aGlzLnZpZXdTdGF0ZS5nZXRBdHRyaWJ1dGVzKCksXG4gIC8vICAgICAgICAgIHRoaXMubW9kZWwudG9KU09OKClcbiAgLy8gICAgICAgKSkpO1xuICAvLyAgICAgfVxuICAvL1xuICB2YXIgVmlld1N0YXRlID0gQmFja2JvbmUuVmlld1N0YXRlID0gZnVuY3Rpb24oYXR0cmlidXRlcykge1xuICAgIHZhciBhdHRycyA9IGF0dHJpYnV0ZXMgfHwge307XG4gICAgdGhpcy5hdHRyaWJ1dGVzID0gXy5jbG9uZShhdHRycyk7XG4gIH07XG5cbiAgXy5leHRlbmQoVmlld1N0YXRlLnByb3RvdHlwZSwgQmFja2JvbmUuRXZlbnRzLCB7XG4gICAgLy8gZ2V0IHRoZSB2YWx1ZSBvZiBhbiBhdHRyaWJ1dGVcbiAgICBnZXQ6IGZ1bmN0aW9uKGF0dHIpIHtcbiAgICAgIHJldHVybiB0aGlzLmF0dHJpYnV0ZXNbYXR0cl07XG4gICAgfSxcblxuICAgIC8vIHJldHVybnMgYWxsIGF0dHJpYnV0ZXMgKGxpa2UgdG9KU09OLCBidXQgdGhpcyBhbHJlYWR5IGlzICdwb2pvJylcbiAgICBnZXRBdHRyaWJ1dGVzOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBfLmNsb25lKHRoaXMuYXR0cmlidXRlcyk7XG4gICAgfSxcblxuICAgIC8vIFNldCBhIGhhc2ggb2YgYXR0cmlidXRlcyBvbiB0aGUgb2JqZWN0IChmaXJpbmcgYGNoYW5nZWApLiBUaGlzIGlzXG4gICAgLy8gdGhlIGNvcmUgb3BlcmF0aW9uIG9mIGEgdmlld1N0YXRlIG9iamVjdCwgdXBkYXRpbmcgdGhlIGRhdGEgYW5kXG4gICAgLy8gbm90aWZ5aW5nIGFueW9uZSB3aG8gbmVlZHMgdG8ga25vdyBhYm91dCB0aGUgY2hhbmdlLlxuICAgIHNldDogZnVuY3Rpb24oa2V5LCB2YWwsIG9wdGlvbnMpIHtcbiAgICAgIHZhciBhdHRycywgYXR0ciwgY3VycmVudCwgc2lsZW50LCB1bnNldCwgY2hhbmdlcyA9IFtdO1xuICAgICAgaWYgKGtleSA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cblxuICAgICAgLy8gTGlrZSBpbiBCYWNrYm9uZS5Nb2RlbCwgeW91IGNhbiBzdXBwbHkgYm90aCBge2tleTogdmFsdWV9YCBhc1xuICAgICAgLy8gYFwia2V5XCIsIHZhbHVlYC1zdHlsZSBhcmd1bWVudHMuXG4gICAgICBpZiAodHlwZW9mIGtleSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgYXR0cnMgPSBrZXk7XG4gICAgICAgIG9wdGlvbnMgPSB2YWw7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAoYXR0cnMgPSB7fSlba2V5XSA9IHZhbDtcbiAgICAgIH1cblxuICAgICAgb3B0aW9ucyB8fCAob3B0aW9ucyA9IHt9KTtcblxuICAgICAgdW5zZXQgICA9IG9wdGlvbnMudW5zZXQ7XG4gICAgICBzaWxlbnQgID0gb3B0aW9ucy5zaWxlbnQ7XG4gICAgICBjdXJyZW50ID0gdGhpcy5hdHRyaWJ1dGVzO1xuXG4gICAgICBmb3IgKGF0dHIgaW4gYXR0cnMpIHtcbiAgICAgICAgdmFsID0gYXR0cnNbYXR0cl07XG4gICAgICAgIGlmICghXy5pc0VxdWFsKGN1cnJlbnRbYXR0cl0sIHZhbCkpIHtcbiAgICAgICAgICBjaGFuZ2VzLnB1c2goYXR0cik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVuc2V0KSB7XG4gICAgICAgICAgZGVsZXRlIGN1cnJlbnRbYXR0cl07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY3VycmVudFthdHRyXSA9IHZhbDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoIXNpbGVudCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGNoYW5nZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgdGhpcy50cmlnZ2VyKCdjaGFuZ2U6JysgY2hhbmdlc1tpXSwgdGhpcywgY3VycmVudFtjaGFuZ2VzW2ldXSwgb3B0aW9ucyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50cmlnZ2VyKCdjaGFuZ2UnLCB0aGlzLCBvcHRpb25zKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICAvLyBSZW1vdmUgYW4gYXR0cmlidXRlIGZyb20gdGhlIG9iamVjdCwgYWxzbyBmaXJpbmcgYSBgY2hhbmdlYC5cbiAgICB1bnNldDogZnVuY3Rpb24oYXR0ciwgb3B0aW9ucykge1xuICAgICAgcmV0dXJuIHRoaXMuc2V0KGF0dHIsIHZvaWQgMCwgXy5leHRlbmQoe30sIG9wdGlvbnMsIHt1bnNldDogdHJ1ZX0pKTtcbiAgICB9LFxuXG4gICAgLy8gQ2xlYXIgYWxsIGF0dHJpYnV0ZXMgb2ZmIHRoaXMgbW9kZWwsIGFsc28gZmlyaW5nIGBjaGFuZ2VgXG4gICAgY2xlYXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgIHZhciBhdHRycyA9IHt9O1xuICAgICAgZm9yICh2YXIga2V5IGluIHRoaXMuYXR0cmlidXRlcykge1xuICAgICAgICBhdHRyc1trZXldID0gdm9pZCAwO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuc2V0KGF0dHJzLCBfLmV4dGVuZCh7fSwgb3B0aW9ucywge3Vuc2V0OiB0cnVlfSkpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIEJhY2tib25lLlZpZXdTdGF0ZTtcbn0pKTtcbiIsIkFQUC5TdG9yZSA9IChmdW5jdGlvbiAoXywgQmFja2JvbmUpIHtcblxuICB2YXIgc2xpZGVDb2xsZWN0aW9uID0gbmV3IEJhY2tib25lLkNvbGxlY3Rpb24oKTtcblxuICB2YXIgc3RhdGUgPSBuZXcgQmFja2JvbmUuVmlld1N0YXRlKHtcbiAgICBhY3RpdmVJbmRleDogLTFcbiAgfSk7XG5cblxuICByZXR1cm4ge1xuICAgIHN0YXJ0OiBmdW5jdGlvbihkYXRhSnNvbikge1xuICAgICAgc2xpZGVDb2xsZWN0aW9uLnJlc2V0KGRhdGFKc29uKTtcbiAgICAgIHNsaWRlQ29sbGVjdGlvbi5pbnZva2UoJ3NldCcsIHsgJ2RhdGFTZXQnOiBmYWxzZSB9KTtcbiAgICB9LFxuXG4gICAgZ2V0U3RhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHN0YXRlO1xuICAgIH0sXG5cbiAgICBnZXRTbGlkZUNvbGxlY3Rpb246IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHNsaWRlQ29sbGVjdGlvbjtcbiAgICB9XG4gIH07XG59KSh0aGlzLl8sIHRoaXMuQmFja2JvbmUpO1xuIiwiKGZ1bmN0aW9uIChfLCBCYWNrYm9uZSwgU3dpcGUpIHtcbiAgLy8gdGhlIG1lYXQgb2YgdGhlIGxvZ2ljLCBkZWZpbmVzIHRoZSBzbGlkZXNob3csIGhvb2tzIGludG8gZXhpc3RpbmcgZG9tIGVsZW1lbnRzIHJlcHJlc2VudGluZyBzbGlkZXMgYW5kIGNvbnRyb2xzXG4gIC8vIGhhbmRsZXMgZXZlbnRzIGFuZCB0aW1pbmcsIHBsYXksIHBhdXNlLCBqdW1wdG9cblxuICBBUFAuVmlld3MuU2xpZGVzaG93ID0gQmFja2JvbmUuVmlldy5leHRlbmQoe1xuXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgIHRoaXMudGltZVNldCA9IG9wdGlvbnMudGltZVNldDtcbiAgICAgIHRoaXMudGVtcGxhdGVOYW1lID0gb3B0aW9ucy50ZW1wbGF0ZU5hbWU7XG4gICAgICB0aGlzLmhhbmRsZSA9IG9wdGlvbnMuaGFuZGxlO1xuXG4gICAgICB0aGlzLnJlbmRlcigpO1xuXG4gICAgICB0aGlzLmxpc3RlblRvKEFQUC5TdG9yZS5nZXRTdGF0ZSgpLCAnY2hhbmdlOmFjdGl2ZUluZGV4JywgdGhpcy5zbGlkZSk7XG4gICAgICB2YXIgcmFuZG9tSW5kZXggPSAoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdGhpcy5jb2xsZWN0aW9uLmxlbmd0aCAtIDEpKVxuICAgICAgQVBQLlN0b3JlLmdldFN0YXRlKCkuc2V0KCdhY3RpdmVJbmRleCcsIHJhbmRvbUluZGV4KTtcblxuICAgICAgdmFyIGVsZW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbXlTd2lwZScpO1xuICAgICAgd2luZG93Lm15U3dpcGUgPSBTd2lwZShlbGVtLCB7XG4gICAgICAgIHN0YXJ0U2xpZGU6IHJhbmRvbUluZGV4LFxuICAgICAgICBhdXRvOiB0aGlzLnRpbWVTZXQsXG4gICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbihpbmRleCwgZWxlbSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdjYWxsYmFjaycpO1xuICAgICAgICAgIEFQUC5TdG9yZS5nZXRTdGF0ZSgpLnNldCgnYWN0aXZlSW5kZXgnLCBpbmRleCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgLy8gQVBQLllvdVR1YmUueW91dHViZVBsYXllcls0MF0ucGxheVZpZGVvKCk7XG5cbiAgICAgIHRoaXMuYmluZHMoKTtcbiAgICB9LFxuXG4gICAgYmluZHM6IGZ1bmN0aW9uKCkge1xuICAgICAgXy5iaW5kQWxsKHRoaXMsICdrZXlEb3duJyk7XG4gICAgICAkKGRvY3VtZW50KS5vbigna2V5ZG93bicsIHRoaXMua2V5RG93bik7XG4gICAgfSxcblxuICAgIGtleURvd246IGZ1bmN0aW9uIChldikge1xuICAgICAgc3dpdGNoIChldi5rZXlDb2RlKSB7XG4gICAgICAgIGNhc2UgMzc6XG4gICAgICAgICAgd2luZG93Lm15U3dpcGUucHJldigpXG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMzg6XG4gICAgICAgICAgdGhpcy5zdG9wVGltZXJTbGlkZSgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDM5OlxuICAgICAgICAgIHdpbmRvdy5teVN3aXBlLm5leHQoKVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDQwOlxuICAgICAgICAgIHRoaXMuc3RvcFRpbWVyU2xpZGUoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgc2xpZGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBuZXh0O1xuICAgICAgdmFyIHByZXY7XG4gICAgICB2YXIgYWN0aXZlID0gQVBQLlN0b3JlLmdldFN0YXRlKCkuZ2V0KCdhY3RpdmVJbmRleCcpO1xuICAgICAgdmFyIHNsaWRlc0xlbmdodCA9IHRoaXMuY29sbGVjdGlvbi5sZW5ndGg7XG5cbiAgICAgIGlmIChhY3RpdmUgPT09IHNsaWRlc0xlbmdodCkge1xuICAgICAgICBhY3RpdmUgPSAwO1xuICAgICAgfSBlbHNlIGlmIChhY3RpdmUgPT09IC0xKSB7XG4gICAgICAgIGFjdGl2ZSA9IChzbGlkZXNMZW5naHQgLSAxKTtcbiAgICAgIH1cblxuICAgICAgQVBQLlN0b3JlLmdldFN0YXRlKCkuc2V0KCdhY3RpdmVJbmRleCcsIGFjdGl2ZSwge1xuICAgICAgICBzaWxlbnQ6IHRydWUsXG4gICAgICB9KVxuXG4gICAgICBpZiAoYWN0aXZlID09PSAoc2xpZGVzTGVuZ2h0IC0gMSkpIHtcbiAgICAgICAgbmV4dCA9IDA7XG4gICAgICAgIHByZXYgPSBhY3RpdmUgLSAxO1xuICAgICAgfSBlbHNlIGlmIChhY3RpdmUgPT09IDApIHtcbiAgICAgICAgcHJldiA9IChzbGlkZXNMZW5naHQgLSAxKTtcbiAgICAgICAgbmV4dCA9IGFjdGl2ZSArIDE7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuZXh0ID0gYWN0aXZlICsgMTtcbiAgICAgICAgcHJldiA9IGFjdGl2ZSAtIDE7XG4gICAgICB9XG5cbiAgICAgIHZhciBwcmV2RWwgPSB0aGlzLiRlbC5maW5kKCdbZGF0YS1pZD1cIicgKyBwcmV2ICsgJ1wiXScpO1xuICAgICAgaWYoIXRoaXMuY29sbGVjdGlvbi5nZXQocHJldikuZ2V0KCdkYXRhU2V0JykpIHtcbiAgICAgICAgdGhpcy5hZGRDb250ZW50VG9UZW1wbGF0ZShwcmV2RWwsIHByZXYpO1xuICAgICAgICBpZih0aGlzLmhhbmRsZSA9PT0gJ2JvbGNvbXJlY2xhbWVzJykge1xuICAgICAgICAgIGFkZFBsYXllcihwcmV2LCB0aGlzLmNvbGxlY3Rpb24uZ2V0KHByZXYpLmdldCgndXJsJykpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29sbGVjdGlvbi5nZXQocHJldikuc2V0KCdkYXRhU2V0JywgdHJ1ZSk7XG4gICAgICB9XG5cbiAgICAgIHZhciBhY3RpdmVFbCA9IHRoaXMuJGVsLmZpbmQoJ1tkYXRhLWlkPVwiJyArIGFjdGl2ZSArICdcIl0nKTtcbiAgICAgIGlmKCF0aGlzLmNvbGxlY3Rpb24uZ2V0KGFjdGl2ZSkuZ2V0KCdkYXRhU2V0JykpIHtcbiAgICAgICAgdGhpcy5hZGRDb250ZW50VG9UZW1wbGF0ZShhY3RpdmVFbCwgYWN0aXZlKTtcbiAgICAgICAgaWYodGhpcy5oYW5kbGUgPT09ICdib2xjb21yZWNsYW1lcycpIHtcbiAgICAgICAgICBhZGRQbGF5ZXIoYWN0aXZlLCB0aGlzLmNvbGxlY3Rpb24uZ2V0KGFjdGl2ZSkuZ2V0KCd1cmwnKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uLmdldChhY3RpdmUpLnNldCgnZGF0YVNldCcsIHRydWUpO1xuICAgICAgfVxuXG4gICAgICB2YXIgbmV4dEVsID0gdGhpcy4kZWwuZmluZCgnW2RhdGEtaWQ9XCInICsgbmV4dCArICdcIl0nKTtcbiAgICAgIGlmKCF0aGlzLmNvbGxlY3Rpb24uZ2V0KG5leHQpLmdldCgnZGF0YVNldCcpKSB7XG4gICAgICAgIHRoaXMuYWRkQ29udGVudFRvVGVtcGxhdGUobmV4dEVsLCBuZXh0KTtcbiAgICAgICAgaWYodGhpcy5oYW5kbGUgPT09ICdib2xjb21yZWNsYW1lcycpIHtcbiAgICAgICAgICBhZGRQbGF5ZXIobmV4dCwgdGhpcy5jb2xsZWN0aW9uLmdldChuZXh0KS5nZXQoJ3VybCcpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNvbGxlY3Rpb24uZ2V0KG5leHQpLnNldCgnZGF0YVNldCcsIHRydWUpO1xuICAgICAgfVxuXG4gICAgfSxcblxuICAgIGdldFRlbXBsYXRlRGF0YTogZnVuY3Rpb24oc2xpZGVucikge1xuICAgICAgdmFyIGRhdGEgPSB0aGlzLmNvbGxlY3Rpb24uZ2V0KHNsaWRlbnIpO1xuICAgICAgcmV0dXJuIGRhdGEudG9KU09OKCk7XG4gICAgfSxcblxuICAgIGFkZENvbnRlbnRUb1RlbXBsYXRlOiBmdW5jdGlvbihlbCwgc2xpZGVucikge1xuICAgICAgdmFyIHNvdXJjZSA9ICQodGhpcy50ZW1wbGF0ZU5hbWUpLmh0bWwoKTtcbiAgICAgIHRoaXMudGVtcGxhdGUgPSBIYW5kbGViYXJzLmNvbXBpbGUoc291cmNlKTtcbiAgICAgIGVsLmFwcGVuZCh0aGlzLnRlbXBsYXRlKHRoaXMuZ2V0VGVtcGxhdGVEYXRhKHNsaWRlbnIpKSk7XG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHNvdXJjZSA9ICQoJyNwbGFjZWhvbGRlci10ZW1wbGF0ZScpLmh0bWwoKTtcbiAgICAgIHRoaXMudGVtcGxhdGUgPSBIYW5kbGViYXJzLmNvbXBpbGUoc291cmNlKTtcbiAgICAgIHRoaXMuY29sbGVjdGlvbi5lYWNoKGZ1bmN0aW9uKG1vZGVsKSB7XG4gICAgICAgICAgdGhpcy4kZWwuYXBwZW5kKHRoaXMudGVtcGxhdGUobW9kZWwudG9KU09OKCkpKTtcbiAgICAgIH0sIHRoaXMpO1xuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gIH0pO1xuXG59KSh0aGlzLl8sIEJhY2tib25lLCBTd2lwZSk7XG4iLCJ2YXIgdGFnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG5cbnRhZy5zcmMgPSBcImh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL2lmcmFtZV9hcGlcIjtcbnZhciBmaXJzdFNjcmlwdFRhZyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzY3JpcHQnKVswXTtcbmZpcnN0U2NyaXB0VGFnLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHRhZywgZmlyc3RTY3JpcHRUYWcpO1xuXG5mdW5jdGlvbiBhZGRQbGF5ZXIoc2xpZGVOciwgaWQpIHtcbiAgY29uc29sZS5sb2coc2xpZGVOcik7XG4gIEFQUC5Zb3VUdWJlLnlvdXR1YmVQbGF5ZXIgPSBbXTtcbiAgQVBQLllvdVR1YmUueW91dHViZVBsYXllcltzbGlkZU5yXSA9IG5ldyBZVC5QbGF5ZXIoJ3lvdXR1YmUtcGxheWVyJyArIHNsaWRlTnIsIHtcbiAgICB3aWR0aDogXCIxMDAlXCIsXG4gICAgaGVpZ2h0OiBcIjEwMCVcIixcbiAgICB2aWRlb0lkOiBpZCxcbiAgICBldmVudHM6IHtcbiAgICAgICdvblN0YXRlQ2hhbmdlJzogb25QbGF5ZXJTdGF0ZUNoYW5nZVxuICAgIH1cbiAgfSk7XG4gIGNvbnNvbGUubG9nKEFQUC5Zb3VUdWJlLnlvdXR1YmVQbGF5ZXJbc2xpZGVOcl0pO1xufVxuXG5mdW5jdGlvbiBvblBsYXllclN0YXRlQ2hhbmdlKGV2ZW50KSB7XG4gIGNvbnNvbGUubG9nKGV2ZW50LnRhcmdldCk7XG4gIHN3aXRjaChldmVudC5kYXRhKSB7XG4gICAgY2FzZSAtMTpcbiAgICAgY29uc29sZS5sb2coJ3ZpZGVvIHVuc3RhcnRlZCcpO1xuICAgICBjb25zb2xlLmxvZygnRHVyYXRpb246JyArIGV2ZW50LnRhcmdldC5nZXREdXJhdGlvbigpKTtcbiAgICBjYXNlIDA6XG4gICAgICBjb25zb2xlLmxvZygndmlkZW8gZW5kZWQnKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgMTpcbiAgICAgIGNvbnNvbGUubG9nKCd2aWRlbyBwbGF5aW5nIGZyb20gJyArIGV2ZW50LnRhcmdldC5nZXRDdXJyZW50VGltZSgpKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgMjpcbiAgICAgIGNvbnNvbGUubG9nKCd2aWRlbyBwYXVzZWQgYXQgJyArIGV2ZW50LnRhcmdldC5nZXRDdXJyZW50VGltZSgpKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgMzpcbiAgICAgIGNvbnNvbGUubG9nKCd2aWRlbyBidWZmZXJpbmcnKTtcbiAgICBjYXNlIDU6XG4gICAgICBjb25zb2xlLmxvZygndmlkZW8gY3VlZCcpO1xuICB9XG59XG4iXX0=
