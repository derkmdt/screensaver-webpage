function loadData(e,t,n){jQuery(".backdrop."+e).addClass("visible"),$.ajax({url:t,type:"GET",success:function(t){if(void 0===t.errors||t.errors.length<1){var i,o=8e3;-1!=n.feed.indexOf("bolpuntcom")?i=t.products:-1!=n.feed.indexOf("bolcomreclames")?(i=t,o=0):i=-1!=n.feed.indexOf("nunl")?t:processTweets(t),jQuery(".backdrop."+e+" .tw").addClass("animation"),jQuery(".backdrop."+e+" .tw").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(t){APP.Store.start(i),APP.Slideshow=new APP.Views.Slideshow({el:$(".template-holder"),templateName:"#"+e+"-template",collection:new APP.Store.getSlideCollection,timeSet:o,handle:e}),$(".backdrop."+e).removeClass("visible")})}else $(".post .message .text-message").text("Response error")},error:function(e){$(".post .message .text-message").text("Request error")}})}function Swipe(e,t){"use strict";function n(){g=b.children,w=g.length,g.length<2&&(t.continuous=!1),p.transitions&&t.continuous&&g.length<3&&(b.appendChild(g[0].cloneNode(!0)),b.appendChild(b.children[1].cloneNode(!0)),g=b.children),m=new Array(g.length),v=e.getBoundingClientRect().width||e.offsetWidth,b.style.width=g.length*v+"px";for(var n=g.length;n--;){var i=g[n];i.style.width=v+"px",i.setAttribute("data-index",n),p.transitions&&(i.style.left=n*-v+"px",s(n,y>n?-v:y<n?v:0,0))}t.continuous&&p.transitions&&(s(a(y-1),-v,0),s(a(y+1),v,0)),p.transitions||(b.style.left=y*-v+"px"),e.style.visibility="visible"}function i(){t.continuous?r(y-1):y&&r(y-1)}function o(){t.continuous?r(y+1):y<g.length-1&&r(y+1)}function a(e){return(g.length+e%g.length)%g.length}function r(e,n){if(y!=e){if(p.transitions){var i=Math.abs(y-e)/(y-e);if(t.continuous){var o=i;(i=-m[a(e)]/v)!==o&&(e=-i*g.length+e)}for(var r=Math.abs(y-e)-1;r--;)s(a((e>y?e:y)-r-1),v*i,0);e=a(e),s(y,v*i,n||S),s(e,0,n||S),t.continuous&&s(a(e-i),-v*i,0)}else e=a(e),c(y*-v,e*-v,n||S);y=e,f(t.callback&&t.callback(y,g[y]))}}function s(e,t,n){l(e,t,n),m[e]=t}function l(e,t,n){var i=g[e],o=i&&i.style;o&&(o.webkitTransitionDuration=o.MozTransitionDuration=o.msTransitionDuration=o.OTransitionDuration=o.transitionDuration=n+"ms",o.webkitTransform="translate("+t+"px,0)translateZ(0)",o.msTransform=o.MozTransform=o.OTransform="translateX("+t+"px)")}function c(e,n,i){if(i)var o=+new Date,a=setInterval(function(){var r=+new Date-o;if(r>i)return b.style.left=n+"px",k&&d(),t.transitionEnd&&t.transitionEnd.call(event,y,g[y]),void clearInterval(a);b.style.left=(n-e)*(Math.floor(r/i*100)/100)+e+"px"},4);else b.style.left=n+"px"}function d(){x=setTimeout(o,k)}function u(){k=0,clearTimeout(x)}var h=function(){},f=function(e){setTimeout(e||h,0)},p={addEventListener:!!window.addEventListener,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,transitions:function(e){var t=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];for(var n in t)if(void 0!==e.style[t[n]])return!0;return!1}(document.createElement("swipe"))};if(e){var g,m,v,w,b=e.children[0];t=t||{};var y=parseInt(t.startSlide,10)||0,S=t.speed||300;t.continuous=void 0===t.continuous||t.continuous;var x,T,k=t.auto||0,E={},P={},A={handleEvent:function(e){switch(e.type){case"touchstart":this.start(e);break;case"touchmove":this.move(e);break;case"touchend":f(this.end(e));break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":f(this.transitionEnd(e));break;case"resize":f(n)}t.stopPropagation&&e.stopPropagation()},start:function(e){var t=e.touches[0];E={x:t.pageX,y:t.pageY,time:+new Date},T=void 0,P={},b.addEventListener("touchmove",this,!1),b.addEventListener("touchend",this,!1)},move:function(e){if(!(e.touches.length>1||e.scale&&1!==e.scale)){t.disableScroll&&e.preventDefault();var n=e.touches[0];P={x:n.pageX-E.x,y:n.pageY-E.y},void 0===T&&(T=!!(T||Math.abs(P.x)<Math.abs(P.y))),T||(e.preventDefault(),u(),t.continuous?(l(a(y-1),P.x+m[a(y-1)],0),l(y,P.x+m[y],0),l(a(y+1),P.x+m[a(y+1)],0)):(P.x=P.x/(!y&&P.x>0||y==g.length-1&&P.x<0?Math.abs(P.x)/v+1:1),l(y-1,P.x+m[y-1],0),l(y,P.x+m[y],0),l(y+1,P.x+m[y+1],0)))}},end:function(e){var n=+new Date-E.time,i=Number(n)<250&&Math.abs(P.x)>20||Math.abs(P.x)>v/2,o=!y&&P.x>0||y==g.length-1&&P.x<0;t.continuous&&(o=!1);var r=P.x<0;T||(i&&!o?(r?(t.continuous?(s(a(y-1),-v,0),s(a(y+2),v,0)):s(y-1,-v,0),s(y,m[y]-v,S),s(a(y+1),m[a(y+1)]-v,S),y=a(y+1)):(t.continuous?(s(a(y+1),v,0),s(a(y-2),-v,0)):s(y+1,v,0),s(y,m[y]+v,S),s(a(y-1),m[a(y-1)]+v,S),y=a(y-1)),t.callback&&t.callback(y,g[y])):t.continuous?(s(a(y-1),-v,S),s(y,0,S),s(a(y+1),v,S)):(s(y-1,-v,S),s(y,0,S),s(y+1,v,S))),b.removeEventListener("touchmove",A,!1),b.removeEventListener("touchend",A,!1)},transitionEnd:function(e){parseInt(e.target.getAttribute("data-index"),10)==y&&(k&&d(),t.transitionEnd&&t.transitionEnd.call(e,y,g[y]))}};return n(),k&&d(),p.addEventListener?(p.touch&&b.addEventListener("touchstart",A,!1),p.transitions&&(b.addEventListener("webkitTransitionEnd",A,!1),b.addEventListener("msTransitionEnd",A,!1),b.addEventListener("oTransitionEnd",A,!1),b.addEventListener("otransitionend",A,!1),b.addEventListener("transitionend",A,!1)),window.addEventListener("resize",A,!1)):window.onresize=function(){n()},{setup:function(){n()},slide:function(e,t){u(),r(e,t)},prev:function(){u(),i()},next:function(){u(),o()},stop:function(){u()},getPos:function(){return y},getNumSlides:function(){return w},kill:function(){u(),b.style.width="",b.style.left="";for(var e=g.length;e--;){var t=g[e];t.style.width="",t.style.left="",p.transitions&&l(e,0,0)}p.addEventListener?(b.removeEventListener("touchstart",A,!1),b.removeEventListener("webkitTransitionEnd",A,!1),b.removeEventListener("msTransitionEnd",A,!1),b.removeEventListener("oTransitionEnd",A,!1),b.removeEventListener("otransitionend",A,!1),b.removeEventListener("transitionend",A,!1),window.removeEventListener("resize",A,!1)):window.onresize=null}}}}function distanceOfTimeInWords(e,t,n){var i=e.getTime(),o=t.getTime(),a=Math.round(Math.abs(i-o)/1e3),r=Math.round(a/60);return r<=1?n?a<5?"5 seconde geleden":a<10?"10 seconde geleden":a<20?"20 seconde geleden":a<40?"30 seconde geleden":a<60?"een minuut geleden":"1 minuut geleden":0===r?"minder dan een minuut":"1 minuut":r<45?r+" minuten geleden":r<70?"1 uur geleden":r<1440?Math.round(r/60)+" uur geleden":r<2880?"1 dag geleden":r<43200?Math.round(r/1440)+" dagen geleden":r<86400?"ruim 1 maand geleden":r<525600?Math.round(r/43200)+" maanden geleden":Math.round(r/525600)+" jaren geleden"}function processTweets(e,t){var n=[];return $.each(e,function(e,t){var i=t;i.hasExternalUrl||(t.text=t.text.parseURL()),i.text=t.text.parseUsername().parseHashtag();var o=i.created.parseDate();delete i.created;var a=new Date;i.date=distanceOfTimeInWords(a,o,!0)+" geplaatst",i.tweetUrl="https://twitter.com/-/status/"+i.tweetId,i.retweetUrl="https://twitter.com/intent/retweet?tweet_id="+i.tweetId,i.replyUrl="https://twitter.com/intent/tweet?in_reply_to="+i.tweetId,i.likeUrl="https://twitter.com/intent/like?tweet_id="+i.tweetId,i.followUrl="https://twitter.com/intent/follow?screen_name="+i.screenName,n.push(i)}),n}function addPlayer(e,t){console.log(e),APP.YouTube.youtubePlayer=[],APP.YouTube.youtubePlayer[e]=new YT.Player("youtube-player"+e,{width:"100%",height:"100%",videoId:t,events:{onStateChange:onPlayerStateChange}}),console.log(APP.YouTube.youtubePlayer[e])}function onPlayerStateChange(e){switch(console.log(e.target),e.data){case-1:console.log("video unstarted"),console.log("Duration:"+e.target.getDuration());case 0:console.log("video ended");break;case 1:console.log("video playing from "+e.target.getCurrentTime());break;case 2:console.log("video paused at "+e.target.getCurrentTime());break;case 3:console.log("video buffering");case 5:console.log("video cued")}}!function(){APP={Views:{},YouTube:{}}}(),function(e,t){if("function"==typeof define&&define.amd)define(["underscore","backbone"],function(n,i){t(e,n,i)});else if("undefined"!=typeof exports){var n=require("underscore"),i=require("backbone");t(e,n,i)}else t(e,e._,e.Backbone)}(this,function(e,t,n){var i=n.ViewState=function(e){var n=e||{};this.attributes=t.clone(n)};return t.extend(i.prototype,n.Events,{get:function(e){return this.attributes[e]},getAttributes:function(){return t.clone(this.attributes)},set:function(e,n,i){var o,a,r,s,l,c=[];if(null===e)return this;"object"==typeof e?(o=e,i=n):(o={})[e]=n,i||(i={}),l=i.unset,s=i.silent,r=this.attributes;for(a in o)n=o[a],t.isEqual(r[a],n)||c.push(a),l?delete r[a]:r[a]=n;if(!s){for(var d=0,u=c.length;d<u;d++)this.trigger("change:"+c[d],this,r[c[d]],i);this.trigger("change",this,i)}return this},unset:function(e,n){return this.set(e,void 0,t.extend({},n,{unset:!0}))},clear:function(e){var n={};for(var i in this.attributes)n[i]=void 0;return this.set(n,t.extend({},e,{unset:!0}))}}),n.ViewState}),APP.Store=function(e,t){var n=new t.Collection,i=new t.ViewState({activeIndex:-1});return{start:function(e){n.reset(e),n.invoke("set",{dataSet:!1})},getState:function(){return i},getSlideCollection:function(){return n}}}(this._,this.Backbone),(window.jQuery||window.Zepto)&&function(e){e.fn.Swipe=function(t){return this.each(function(){e(this).data("Swipe",new Swipe(e(this)[0],t))})}}(window.jQuery||window.Zepto),String.prototype.parseURL=function(){return this.replace(/[A-Za-z]+:\/\/[A-Za-z0-9-_]+\.[A-Za-z0-9-_:%&~\?\/.=]+/g,function(e){return e.link(e).openUrlBlank()})},String.prototype.parseUsername=function(){return this.replace(/ [@]+[A-Za-z0-9-_]+/g,function(e){var t=e.replace(" @","");return e.link("https://twitter.com/"+t).openUrlBlank()})},String.prototype.parseHashtag=function(){return this.replace(/ [#]+[A-Za-z0-9-_]+/g,function(e){var t=e.replace(" #","%23");return e.link("https://twitter.com/search?q="+t).openUrlBlank()})},String.prototype.parseDate=function(){var e=this.replace(/(\+\S+) (.*)/,"$2 $1");return new Date(Date.parse(e))},String.prototype.openUrlBlank=function(){return this.replace(/^<a/,'$& target="_blank"')},function(e,t,n){APP.Views.Slideshow=t.View.extend({initialize:function(e){this.timeSet=e.timeSet,this.templateName=e.templateName,this.handle=e.handle,this.render(),this.listenTo(APP.Store.getState(),"change:activeIndex",this.slide);var t=Math.floor(Math.random()*this.collection.length-1);APP.Store.getState().set("activeIndex",t);var i=document.getElementById("mySwipe");window.mySwipe=n(i,{startSlide:t,auto:this.timeSet,callback:function(e,t){console.log("callback"),APP.Store.getState().set("activeIndex",e)}}),this.binds()},binds:function(){e.bindAll(this,"keyDown"),$(document).on("keydown",this.keyDown)},keyDown:function(e){switch(e.keyCode){case 37:window.mySwipe.prev();break;case 38:this.stopTimerSlide();break;case 39:window.mySwipe.next();break;case 40:this.stopTimerSlide()}},slide:function(){var e,t,n=APP.Store.getState().get("activeIndex"),i=this.collection.length;n===i?n=0:-1===n&&(n=i-1),APP.Store.getState().set("activeIndex",n,{silent:!0}),n===i-1?(e=0,t=n-1):0===n?(t=i-1,e=n+1):(e=n+1,t=n-1);var o=this.$el.find('[data-id="'+t+'"]');this.collection.get(t).get("dataSet")||(this.addContentToTemplate(o,t),"bolcomreclames"===this.handle&&addPlayer(t,this.collection.get(t).get("url")),this.collection.get(t).set("dataSet",!0));var a=this.$el.find('[data-id="'+n+'"]');this.collection.get(n).get("dataSet")||(this.addContentToTemplate(a,n),"bolcomreclames"===this.handle&&addPlayer(n,this.collection.get(n).get("url")),this.collection.get(n).set("dataSet",!0));var r=this.$el.find('[data-id="'+e+'"]');this.collection.get(e).get("dataSet")||(this.addContentToTemplate(r,e),"bolcomreclames"===this.handle&&addPlayer(e,this.collection.get(e).get("url")),this.collection.get(e).set("dataSet",!0))},getTemplateData:function(e){return this.collection.get(e).toJSON()},addContentToTemplate:function(e,t){var n=$(this.templateName).html();this.template=Handlebars.compile(n),e.append(this.template(this.getTemplateData(t)))},render:function(){var e=$("#placeholder-template").html();return this.template=Handlebars.compile(e),this.collection.each(function(e){this.$el.append(this.template(e.toJSON()))},this),this}})}(this._,Backbone,Swipe);var tag=document.createElement("script");tag.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRhdGEuanMiLCJzd2lwZS5qcyIsInR3aXR0ZXIuanMiLCJ5b3V0dWJlLmpzIiwiYXBwLmpzIiwiYmFja2JvbmUtdmlld3N0YXRlLmpzIiwiU3RvcmUuanMiLCJ2aWV3cy9zbGlkZXNob3cuanMiXSwibmFtZXMiOlsibG9hZERhdGEiLCJoYW5kbGUiLCJkYXRhVXJsIiwicXVlcnkiLCJqUXVlcnkiLCJhZGRDbGFzcyIsIiQiLCJhamF4IiwidXJsIiwidHlwZSIsInN1Y2Nlc3MiLCJyZXNwb25zZSIsImVycm9ycyIsImxlbmd0aCIsImRhdGEiLCJ0aW1lU2V0IiwiZmVlZCIsImluZGV4T2YiLCJwcm9kdWN0cyIsInByb2Nlc3NUd2VldHMiLCJvbmUiLCJlIiwiQVBQIiwiU3RvcmUiLCJzdGFydCIsIlNsaWRlc2hvdyIsIlZpZXdzIiwiZWwiLCJ0ZW1wbGF0ZU5hbWUiLCJjb2xsZWN0aW9uIiwiZ2V0U2xpZGVDb2xsZWN0aW9uIiwicmVtb3ZlQ2xhc3MiLCJ0ZXh0IiwiZXJyb3IiLCJTd2lwZSIsImNvbnRhaW5lciIsIm9wdGlvbnMiLCJzZXR1cCIsInNsaWRlcyIsImVsZW1lbnQiLCJjaGlsZHJlbiIsImNvbnRpbnVvdXMiLCJicm93c2VyIiwidHJhbnNpdGlvbnMiLCJhcHBlbmRDaGlsZCIsImNsb25lTm9kZSIsInNsaWRlUG9zIiwiQXJyYXkiLCJ3aWR0aCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsIm9mZnNldFdpZHRoIiwic3R5bGUiLCJwb3MiLCJzbGlkZSIsInNldEF0dHJpYnV0ZSIsImxlZnQiLCJtb3ZlIiwiaW5kZXgiLCJjaXJjbGUiLCJ2aXNpYmlsaXR5IiwicHJldiIsIm5leHQiLCJ0byIsInNsaWRlU3BlZWQiLCJkaXJlY3Rpb24iLCJNYXRoIiwiYWJzIiwibmF0dXJhbF9kaXJlY3Rpb24iLCJkaWZmIiwic3BlZWQiLCJhbmltYXRlIiwib2ZmbG9hZEZuIiwiY2FsbGJhY2siLCJkaXN0IiwidHJhbnNsYXRlIiwid2Via2l0VHJhbnNpdGlvbkR1cmF0aW9uIiwiTW96VHJhbnNpdGlvbkR1cmF0aW9uIiwibXNUcmFuc2l0aW9uRHVyYXRpb24iLCJPVHJhbnNpdGlvbkR1cmF0aW9uIiwidHJhbnNpdGlvbkR1cmF0aW9uIiwid2Via2l0VHJhbnNmb3JtIiwibXNUcmFuc2Zvcm0iLCJNb3pUcmFuc2Zvcm0iLCJPVHJhbnNmb3JtIiwiZnJvbSIsIkRhdGUiLCJ0aW1lciIsInNldEludGVydmFsIiwidGltZUVsYXAiLCJkZWxheSIsImJlZ2luIiwidHJhbnNpdGlvbkVuZCIsImNhbGwiLCJldmVudCIsImNsZWFySW50ZXJ2YWwiLCJmbG9vciIsImludGVydmFsIiwic2V0VGltZW91dCIsInN0b3AiLCJjbGVhclRpbWVvdXQiLCJub29wIiwiZm4iLCJhZGRFdmVudExpc3RlbmVyIiwid2luZG93IiwidG91Y2giLCJEb2N1bWVudFRvdWNoIiwiZG9jdW1lbnQiLCJ0ZW1wIiwicHJvcHMiLCJpIiwidW5kZWZpbmVkIiwiY3JlYXRlRWxlbWVudCIsInBhcnNlSW50Iiwic3RhcnRTbGlkZSIsImlzU2Nyb2xsaW5nIiwiYXV0byIsImRlbHRhIiwiZXZlbnRzIiwiaGFuZGxlRXZlbnQiLCJ0aGlzIiwiZW5kIiwic3RvcFByb3BhZ2F0aW9uIiwidG91Y2hlcyIsIngiLCJwYWdlWCIsInkiLCJwYWdlWSIsInRpbWUiLCJzY2FsZSIsImRpc2FibGVTY3JvbGwiLCJwcmV2ZW50RGVmYXVsdCIsImR1cmF0aW9uIiwiaXNWYWxpZFNsaWRlIiwiTnVtYmVyIiwiaXNQYXN0Qm91bmRzIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInRhcmdldCIsImdldEF0dHJpYnV0ZSIsIm9ucmVzaXplIiwiZ2V0UG9zIiwiZ2V0TnVtU2xpZGVzIiwia2lsbCIsImRpc3RhbmNlT2ZUaW1lSW5Xb3JkcyIsImZyb21UaW1lIiwidG9UaW1lIiwiaW5jbHVkZVNlY29uZHMiLCJmcm9tU2Vjb25kcyIsImdldFRpbWUiLCJ0b1NlY29uZHMiLCJkaXN0YW5jZUluU2Vjb25kcyIsInJvdW5kIiwiZGlzdGFuY2VJbk1pbnV0ZXMiLCJ1bmlxdWUiLCJ0d2VldHMiLCJlYWNoIiwib2JqIiwiaGFzRXh0ZXJuYWxVcmwiLCJwYXJzZVVSTCIsInBhcnNlVXNlcm5hbWUiLCJwYXJzZUhhc2h0YWciLCJjcmVhdGVkIiwicGFyc2VEYXRlIiwibm93IiwiZGF0ZSIsInR3ZWV0VXJsIiwidHdlZXRJZCIsInJldHdlZXRVcmwiLCJyZXBseVVybCIsImxpa2VVcmwiLCJmb2xsb3dVcmwiLCJzY3JlZW5OYW1lIiwicHVzaCIsImFkZFBsYXllciIsInNsaWRlTnIiLCJpZCIsImNvbnNvbGUiLCJsb2ciLCJZb3VUdWJlIiwieW91dHViZVBsYXllciIsIllUIiwiUGxheWVyIiwiaGVpZ2h0IiwidmlkZW9JZCIsIm9uU3RhdGVDaGFuZ2UiLCJvblBsYXllclN0YXRlQ2hhbmdlIiwiZ2V0RHVyYXRpb24iLCJnZXRDdXJyZW50VGltZSIsInJvb3QiLCJmYWN0b3J5IiwiZGVmaW5lIiwiYW1kIiwiXyIsIkJhY2tib25lIiwiZXhwb3J0cyIsInJlcXVpcmUiLCJWaWV3U3RhdGUiLCJhdHRyaWJ1dGVzIiwiYXR0cnMiLCJjbG9uZSIsImV4dGVuZCIsInByb3RvdHlwZSIsIkV2ZW50cyIsImdldCIsImF0dHIiLCJnZXRBdHRyaWJ1dGVzIiwic2V0Iiwia2V5IiwidmFsIiwiY3VycmVudCIsInNpbGVudCIsInVuc2V0IiwiY2hhbmdlcyIsImlzRXF1YWwiLCJsIiwidHJpZ2dlciIsImNsZWFyIiwic2xpZGVDb2xsZWN0aW9uIiwiQ29sbGVjdGlvbiIsInN0YXRlIiwiYWN0aXZlSW5kZXgiLCJkYXRhSnNvbiIsInJlc2V0IiwiaW52b2tlIiwiZGF0YVNldCIsImdldFN0YXRlIiwiWmVwdG8iLCJwYXJhbXMiLCJTdHJpbmciLCJyZXBsYWNlIiwidSIsImxpbmsiLCJvcGVuVXJsQmxhbmsiLCJ1c2VybmFtZSIsInQiLCJ0YWciLCJuZXd0ZXh0IiwicGFyc2UiLCJWaWV3IiwiaW5pdGlhbGl6ZSIsInJlbmRlciIsImxpc3RlblRvIiwicmFuZG9tSW5kZXgiLCJyYW5kb20iLCJlbGVtIiwiZ2V0RWxlbWVudEJ5SWQiLCJteVN3aXBlIiwiYmluZHMiLCJiaW5kQWxsIiwib24iLCJrZXlEb3duIiwiZXYiLCJrZXlDb2RlIiwic3RvcFRpbWVyU2xpZGUiLCJhY3RpdmUiLCJzbGlkZXNMZW5naHQiLCJwcmV2RWwiLCIkZWwiLCJmaW5kIiwiYWRkQ29udGVudFRvVGVtcGxhdGUiLCJhY3RpdmVFbCIsIm5leHRFbCIsImdldFRlbXBsYXRlRGF0YSIsInNsaWRlbnIiLCJ0b0pTT04iLCJzb3VyY2UiLCJodG1sIiwidGVtcGxhdGUiLCJIYW5kbGViYXJzIiwiY29tcGlsZSIsImFwcGVuZCIsIm1vZGVsIiwic3JjIiwiZmlyc3RTY3JpcHRUYWciLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInBhcmVudE5vZGUiLCJpbnNlcnRCZWZvcmUiXSwibWFwcGluZ3MiOiJBQUFBLFNBQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEdBQ0FDLE9BQUEsYUFBQUgsR0FBQUksU0FBQSxXQUVBQyxFQUFBQyxNQUNBQyxJQUFBTixFQUNBTyxLQUFBLE1BQ0FDLFFBQUEsU0FBQUMsR0FDQSxRQUFBLElBQUFBLEVBQUFDLFFBQUFELEVBQUFDLE9BQUFDLE9BQUEsRUFBQSxDQUNBLElBQUFDLEVBQ0FDLEVBQUEsS0FDQSxHQUFBWixFQUFBYSxLQUFBQyxRQUFBLGNBQ0FILEVBQUFILEVBQUFPLFVBQ0EsR0FBQWYsRUFBQWEsS0FBQUMsUUFBQSxtQkFDQUgsRUFBQUgsRUFDQUksRUFBQSxHQUVBRCxHQURBLEdBQUFYLEVBQUFhLEtBQUFDLFFBQUEsUUFDQU4sRUFFQVEsY0FBQVIsR0FHQVAsT0FBQSxhQUFBSCxFQUFBLFFBQUFJLFNBQUEsYUFDQUQsT0FBQSxhQUFBSCxFQUFBLFFBQUFtQixJQUFBLCtEQUFBLFNBQUFDLEdBQ0FDLElBQUFDLE1BQUFDLE1BQUFWLEdBQ0FRLElBQUFHLFVBQUEsSUFBQUgsSUFBQUksTUFBQUQsV0FDQUUsR0FBQXJCLEVBQUEsb0JBQ0FzQixhQUFB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Q0FELGVBQUFFLFdBQUFDLGFBQUF6QyxJQUFBc0MiLCJmaWxlIjoic2NyZWVuc2F2ZXIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gbG9hZERhdGEoaGFuZGxlLCBkYXRhVXJsLCBxdWVyeSkge1xuICBqUXVlcnkoJy5iYWNrZHJvcC4nICsgaGFuZGxlKS5hZGRDbGFzcygndmlzaWJsZScpO1xuXG4gICQuYWpheCh7XG4gICAgdXJsOiBkYXRhVXJsLFxuICAgIHR5cGU6ICdHRVQnLFxuICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgaWYgKHR5cGVvZiByZXNwb25zZS5lcnJvcnMgPT09ICd1bmRlZmluZWQnIHx8IHJlc3BvbnNlLmVycm9ycy5sZW5ndGggPCAxKSB7XG4gICAgICAgIHZhciBkYXRhO1xuICAgICAgICB2YXIgdGltZVNldCA9IDgwMDA7XG4gICAgICAgIGlmIChxdWVyeS5mZWVkLmluZGV4T2YoJ2JvbHB1bnRjb20nKSAhPSAtMSkge1xuICAgICAgICAgIGRhdGEgPSByZXNwb25zZS5wcm9kdWN0cztcbiAgICAgICAgfSBlbHNlIGlmKHF1ZXJ5LmZlZWQuaW5kZXhPZignYm9sY29tcmVjbGFtZXMnKSAhPSAtMSkge1xuICAgICAgICAgIGRhdGEgPSByZXNwb25zZTtcbiAgICAgICAgICB0aW1lU2V0ID0gMDtcbiAgICAgICAgfSBlbHNlIGlmKHF1ZXJ5LmZlZWQuaW5kZXhPZignbnVubCcpICE9IC0xKSB7XG4gICAgICAgICAgZGF0YSA9IHJlc3BvbnNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRhdGEgPSBwcm9jZXNzVHdlZXRzKHJlc3BvbnNlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGpRdWVyeSgnLmJhY2tkcm9wLicgKyBoYW5kbGUgKyAnIC50dycpLmFkZENsYXNzKCdhbmltYXRpb24nKTtcbiAgICAgICAgalF1ZXJ5KCcuYmFja2Ryb3AuJyArIGhhbmRsZSArICcgLnR3Jykub25lKCd3ZWJraXRBbmltYXRpb25FbmQgb2FuaW1hdGlvbmVuZCBtc0FuaW1hdGlvbkVuZCBhbmltYXRpb25lbmQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIEFQUC5TdG9yZS5zdGFydChkYXRhKTtcbiAgICAgICAgICBBUFAuU2xpZGVzaG93ID0gbmV3IEFQUC5WaWV3cy5TbGlkZXNob3coe1xuICAgICAgICAgICAgZWw6ICQoJy50ZW1wbGF0ZS1ob2xkZXInKSxcbiAgICAgICAgICAgIHRlbXBsYXRlTmFtZTogJyMnICsgaGFuZGxlICsgJy10ZW1wbGF0ZScsXG4gICAgICAgICAgICBjb2xsZWN0aW9uOiBuZXcgQVBQLlN0b3JlLmdldFNsaWRlQ29sbGVjdGlvbigpLFxuICAgICAgICAgICAgdGltZVNldDogdGltZVNldCxcbiAgICAgICAgICAgIGhhbmRsZTogaGFuZGxlXG4gICAgICAgICAgfSlcblxuICAgICAgICAgICQoJy5iYWNrZHJvcC4nICsgaGFuZGxlKS5yZW1vdmVDbGFzcygndmlzaWJsZScpO1xuICAgICAgICB9KTtcblxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJCgnLnBvc3QgLm1lc3NhZ2UgLnRleHQtbWVzc2FnZScpLnRleHQoJ1Jlc3BvbnNlIGVycm9yJyk7XG4gICAgICB9XG4gICAgfSxcbiAgICBlcnJvcjogZnVuY3Rpb24gKGVycm9ycykge1xuICAgICAgJCgnLnBvc3QgLm1lc3NhZ2UgLnRleHQtbWVzc2FnZScpLnRleHQoJ1JlcXVlc3QgZXJyb3InKTtcbiAgICB9LFxuICB9KTtcblxufVxuIiwiLypcbiAqIFN3aXBlIDIuMFxuICpcbiAqIEJyYWQgQmlyZHNhbGxcbiAqIENvcHlyaWdodCAyMDEzLCBNSVQgTGljZW5zZVxuICpcbiovXG5cbmZ1bmN0aW9uIFN3aXBlKGNvbnRhaW5lciwgb3B0aW9ucykge1xuXG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIC8vIHV0aWxpdGllc1xuICB2YXIgbm9vcCA9IGZ1bmN0aW9uKCkge307IC8vIHNpbXBsZSBubyBvcGVyYXRpb24gZnVuY3Rpb25cbiAgdmFyIG9mZmxvYWRGbiA9IGZ1bmN0aW9uKGZuKSB7IHNldFRpbWVvdXQoZm4gfHwgbm9vcCwgMCkgfTsgLy8gb2ZmbG9hZCBhIGZ1bmN0aW9ucyBleGVjdXRpb25cblxuICAvLyBjaGVjayBicm93c2VyIGNhcGFiaWxpdGllc1xuICB2YXIgYnJvd3NlciA9IHtcbiAgICBhZGRFdmVudExpc3RlbmVyOiAhIXdpbmRvdy5hZGRFdmVudExpc3RlbmVyLFxuICAgIHRvdWNoOiAoJ29udG91Y2hzdGFydCcgaW4gd2luZG93KSB8fCB3aW5kb3cuRG9jdW1lbnRUb3VjaCAmJiBkb2N1bWVudCBpbnN0YW5jZW9mIERvY3VtZW50VG91Y2gsXG4gICAgdHJhbnNpdGlvbnM6IChmdW5jdGlvbih0ZW1wKSB7XG4gICAgICB2YXIgcHJvcHMgPSBbJ3RyYW5zaXRpb25Qcm9wZXJ0eScsICdXZWJraXRUcmFuc2l0aW9uJywgJ01velRyYW5zaXRpb24nLCAnT1RyYW5zaXRpb24nLCAnbXNUcmFuc2l0aW9uJ107XG4gICAgICBmb3IgKCB2YXIgaSBpbiBwcm9wcyApIGlmICh0ZW1wLnN0eWxlWyBwcm9wc1tpXSBdICE9PSB1bmRlZmluZWQpIHJldHVybiB0cnVlO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N3aXBlJykpXG4gIH07XG5cbiAgLy8gcXVpdCBpZiBubyByb290IGVsZW1lbnRcbiAgaWYgKCFjb250YWluZXIpIHJldHVybjtcbiAgdmFyIGVsZW1lbnQgPSBjb250YWluZXIuY2hpbGRyZW5bMF07XG4gIHZhciBzbGlkZXMsIHNsaWRlUG9zLCB3aWR0aCwgbGVuZ3RoO1xuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgdmFyIGluZGV4ID0gcGFyc2VJbnQob3B0aW9ucy5zdGFydFNsaWRlLCAxMCkgfHwgMDtcbiAgdmFyIHNwZWVkID0gb3B0aW9ucy5zcGVlZCB8fCAzMDA7XG4gIG9wdGlvbnMuY29udGludW91cyA9IG9wdGlvbnMuY29udGludW91cyAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5jb250aW51b3VzIDogdHJ1ZTtcblxuICBmdW5jdGlvbiBzZXR1cCgpIHtcblxuICAgIC8vIGNhY2hlIHNsaWRlc1xuICAgIHNsaWRlcyA9IGVsZW1lbnQuY2hpbGRyZW47XG4gICAgbGVuZ3RoID0gc2xpZGVzLmxlbmd0aDtcblxuICAgIC8vIHNldCBjb250aW51b3VzIHRvIGZhbHNlIGlmIG9ubHkgb25lIHNsaWRlXG4gICAgaWYgKHNsaWRlcy5sZW5ndGggPCAyKSBvcHRpb25zLmNvbnRpbnVvdXMgPSBmYWxzZTtcblxuICAgIC8vc3BlY2lhbCBjYXNlIGlmIHR3byBzbGlkZXNcbiAgICBpZiAoYnJvd3Nlci50cmFuc2l0aW9ucyAmJiBvcHRpb25zLmNvbnRpbnVvdXMgJiYgc2xpZGVzLmxlbmd0aCA8IDMpIHtcbiAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoc2xpZGVzWzBdLmNsb25lTm9kZSh0cnVlKSk7XG4gICAgICBlbGVtZW50LmFwcGVuZENoaWxkKGVsZW1lbnQuY2hpbGRyZW5bMV0uY2xvbmVOb2RlKHRydWUpKTtcbiAgICAgIHNsaWRlcyA9IGVsZW1lbnQuY2hpbGRyZW47XG4gICAgfVxuXG4gICAgLy8gY3JlYXRlIGFuIGFycmF5IHRvIHN0b3JlIGN1cnJlbnQgcG9zaXRpb25zIG9mIGVhY2ggc2xpZGVcbiAgICBzbGlkZVBvcyA9IG5ldyBBcnJheShzbGlkZXMubGVuZ3RoKTtcblxuICAgIC8vIGRldGVybWluZSB3aWR0aCBvZiBlYWNoIHNsaWRlXG4gICAgd2lkdGggPSBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGggfHwgY29udGFpbmVyLm9mZnNldFdpZHRoO1xuXG4gICAgZWxlbWVudC5zdHlsZS53aWR0aCA9IChzbGlkZXMubGVuZ3RoICogd2lkdGgpICsgJ3B4JztcblxuICAgIC8vIHN0YWNrIGVsZW1lbnRzXG4gICAgdmFyIHBvcyA9IHNsaWRlcy5sZW5ndGg7XG4gICAgd2hpbGUocG9zLS0pIHtcblxuICAgICAgdmFyIHNsaWRlID0gc2xpZGVzW3Bvc107XG5cbiAgICAgIHNsaWRlLnN0eWxlLndpZHRoID0gd2lkdGggKyAncHgnO1xuICAgICAgc2xpZGUuc2V0QXR0cmlidXRlKCdkYXRhLWluZGV4JywgcG9zKTtcblxuICAgICAgaWYgKGJyb3dzZXIudHJhbnNpdGlvbnMpIHtcbiAgICAgICAgc2xpZGUuc3R5bGUubGVmdCA9IChwb3MgKiAtd2lkdGgpICsgJ3B4JztcbiAgICAgICAgbW92ZShwb3MsIGluZGV4ID4gcG9zID8gLXdpZHRoIDogKGluZGV4IDwgcG9zID8gd2lkdGggOiAwKSwgMCk7XG4gICAgICB9XG5cbiAgICB9XG5cbiAgICAvLyByZXBvc2l0aW9uIGVsZW1lbnRzIGJlZm9yZSBhbmQgYWZ0ZXIgaW5kZXhcbiAgICBpZiAob3B0aW9ucy5jb250aW51b3VzICYmIGJyb3dzZXIudHJhbnNpdGlvbnMpIHtcbiAgICAgIG1vdmUoY2lyY2xlKGluZGV4LTEpLCAtd2lkdGgsIDApO1xuICAgICAgbW92ZShjaXJjbGUoaW5kZXgrMSksIHdpZHRoLCAwKTtcbiAgICB9XG5cbiAgICBpZiAoIWJyb3dzZXIudHJhbnNpdGlvbnMpIGVsZW1lbnQuc3R5bGUubGVmdCA9IChpbmRleCAqIC13aWR0aCkgKyAncHgnO1xuXG4gICAgY29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIHByZXYoKSB7XG5cbiAgICBpZiAob3B0aW9ucy5jb250aW51b3VzKSBzbGlkZShpbmRleC0xKTtcbiAgICBlbHNlIGlmIChpbmRleCkgc2xpZGUoaW5kZXgtMSk7XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIG5leHQoKSB7XG5cbiAgICBpZiAob3B0aW9ucy5jb250aW51b3VzKSBzbGlkZShpbmRleCsxKTtcbiAgICBlbHNlIGlmIChpbmRleCA8IHNsaWRlcy5sZW5ndGggLSAxKSBzbGlkZShpbmRleCsxKTtcblxuICB9XG5cbiAgZnVuY3Rpb24gY2lyY2xlKGluZGV4KSB7XG5cbiAgICAvLyBhIHNpbXBsZSBwb3NpdGl2ZSBtb2R1bG8gdXNpbmcgc2xpZGVzLmxlbmd0aFxuICAgIHJldHVybiAoc2xpZGVzLmxlbmd0aCArIChpbmRleCAlIHNsaWRlcy5sZW5ndGgpKSAlIHNsaWRlcy5sZW5ndGg7XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIHNsaWRlKHRvLCBzbGlkZVNwZWVkKSB7XG5cbiAgICAvLyBkbyBub3RoaW5nIGlmIGFscmVhZHkgb24gcmVxdWVzdGVkIHNsaWRlXG4gICAgaWYgKGluZGV4ID09IHRvKSByZXR1cm47XG5cbiAgICBpZiAoYnJvd3Nlci50cmFuc2l0aW9ucykge1xuXG4gICAgICB2YXIgZGlyZWN0aW9uID0gTWF0aC5hYnMoaW5kZXgtdG8pIC8gKGluZGV4LXRvKTsgLy8gMTogYmFja3dhcmQsIC0xOiBmb3J3YXJkXG5cbiAgICAgIC8vIGdldCB0aGUgYWN0dWFsIHBvc2l0aW9uIG9mIHRoZSBzbGlkZVxuICAgICAgaWYgKG9wdGlvbnMuY29udGludW91cykge1xuICAgICAgICB2YXIgbmF0dXJhbF9kaXJlY3Rpb24gPSBkaXJlY3Rpb247XG4gICAgICAgIGRpcmVjdGlvbiA9IC1zbGlkZVBvc1tjaXJjbGUodG8pXSAvIHdpZHRoO1xuXG4gICAgICAgIC8vIGlmIGdvaW5nIGZvcndhcmQgYnV0IHRvIDwgaW5kZXgsIHVzZSB0byA9IHNsaWRlcy5sZW5ndGggKyB0b1xuICAgICAgICAvLyBpZiBnb2luZyBiYWNrd2FyZCBidXQgdG8gPiBpbmRleCwgdXNlIHRvID0gLXNsaWRlcy5sZW5ndGggKyB0b1xuICAgICAgICBpZiAoZGlyZWN0aW9uICE9PSBuYXR1cmFsX2RpcmVjdGlvbikgdG8gPSAgLWRpcmVjdGlvbiAqIHNsaWRlcy5sZW5ndGggKyB0bztcblxuICAgICAgfVxuXG4gICAgICB2YXIgZGlmZiA9IE1hdGguYWJzKGluZGV4LXRvKSAtIDE7XG5cbiAgICAgIC8vIG1vdmUgYWxsIHRoZSBzbGlkZXMgYmV0d2VlbiBpbmRleCBhbmQgdG8gaW4gdGhlIHJpZ2h0IGRpcmVjdGlvblxuICAgICAgd2hpbGUgKGRpZmYtLSkgbW92ZSggY2lyY2xlKCh0byA+IGluZGV4ID8gdG8gOiBpbmRleCkgLSBkaWZmIC0gMSksIHdpZHRoICogZGlyZWN0aW9uLCAwKTtcblxuICAgICAgdG8gPSBjaXJjbGUodG8pO1xuXG4gICAgICBtb3ZlKGluZGV4LCB3aWR0aCAqIGRpcmVjdGlvbiwgc2xpZGVTcGVlZCB8fCBzcGVlZCk7XG4gICAgICBtb3ZlKHRvLCAwLCBzbGlkZVNwZWVkIHx8IHNwZWVkKTtcblxuICAgICAgaWYgKG9wdGlvbnMuY29udGludW91cykgbW92ZShjaXJjbGUodG8gLSBkaXJlY3Rpb24pLCAtKHdpZHRoICogZGlyZWN0aW9uKSwgMCk7IC8vIHdlIG5lZWQgdG8gZ2V0IHRoZSBuZXh0IGluIHBsYWNlXG5cbiAgICB9IGVsc2Uge1xuXG4gICAgICB0byA9IGNpcmNsZSh0byk7XG4gICAgICBhbmltYXRlKGluZGV4ICogLXdpZHRoLCB0byAqIC13aWR0aCwgc2xpZGVTcGVlZCB8fCBzcGVlZCk7XG4gICAgICAvL25vIGZhbGxiYWNrIGZvciBhIGNpcmN1bGFyIGNvbnRpbnVvdXMgaWYgdGhlIGJyb3dzZXIgZG9lcyBub3QgYWNjZXB0IHRyYW5zaXRpb25zXG4gICAgfVxuXG4gICAgaW5kZXggPSB0bztcbiAgICBvZmZsb2FkRm4ob3B0aW9ucy5jYWxsYmFjayAmJiBvcHRpb25zLmNhbGxiYWNrKGluZGV4LCBzbGlkZXNbaW5kZXhdKSk7XG4gIH1cblxuICBmdW5jdGlvbiBtb3ZlKGluZGV4LCBkaXN0LCBzcGVlZCkge1xuXG4gICAgdHJhbnNsYXRlKGluZGV4LCBkaXN0LCBzcGVlZCk7XG4gICAgc2xpZGVQb3NbaW5kZXhdID0gZGlzdDtcblxuICB9XG5cbiAgZnVuY3Rpb24gdHJhbnNsYXRlKGluZGV4LCBkaXN0LCBzcGVlZCkge1xuXG4gICAgdmFyIHNsaWRlID0gc2xpZGVzW2luZGV4XTtcbiAgICB2YXIgc3R5bGUgPSBzbGlkZSAmJiBzbGlkZS5zdHlsZTtcblxuICAgIGlmICghc3R5bGUpIHJldHVybjtcblxuICAgIHN0eWxlLndlYmtpdFRyYW5zaXRpb25EdXJhdGlvbiA9XG4gICAgc3R5bGUuTW96VHJhbnNpdGlvbkR1cmF0aW9uID1cbiAgICBzdHlsZS5tc1RyYW5zaXRpb25EdXJhdGlvbiA9XG4gICAgc3R5bGUuT1RyYW5zaXRpb25EdXJhdGlvbiA9XG4gICAgc3R5bGUudHJhbnNpdGlvbkR1cmF0aW9uID0gc3BlZWQgKyAnbXMnO1xuXG4gICAgc3R5bGUud2Via2l0VHJhbnNmb3JtID0gJ3RyYW5zbGF0ZSgnICsgZGlzdCArICdweCwwKScgKyAndHJhbnNsYXRlWigwKSc7XG4gICAgc3R5bGUubXNUcmFuc2Zvcm0gPVxuICAgIHN0eWxlLk1velRyYW5zZm9ybSA9XG4gICAgc3R5bGUuT1RyYW5zZm9ybSA9ICd0cmFuc2xhdGVYKCcgKyBkaXN0ICsgJ3B4KSc7XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIGFuaW1hdGUoZnJvbSwgdG8sIHNwZWVkKSB7XG5cbiAgICAvLyBpZiBub3QgYW4gYW5pbWF0aW9uLCBqdXN0IHJlcG9zaXRpb25cbiAgICBpZiAoIXNwZWVkKSB7XG5cbiAgICAgIGVsZW1lbnQuc3R5bGUubGVmdCA9IHRvICsgJ3B4JztcbiAgICAgIHJldHVybjtcblxuICAgIH1cblxuICAgIHZhciBzdGFydCA9ICtuZXcgRGF0ZTtcblxuICAgIHZhciB0aW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuXG4gICAgICB2YXIgdGltZUVsYXAgPSArbmV3IERhdGUgLSBzdGFydDtcblxuICAgICAgaWYgKHRpbWVFbGFwID4gc3BlZWQpIHtcblxuICAgICAgICBlbGVtZW50LnN0eWxlLmxlZnQgPSB0byArICdweCc7XG5cbiAgICAgICAgaWYgKGRlbGF5KSBiZWdpbigpO1xuXG4gICAgICAgIG9wdGlvbnMudHJhbnNpdGlvbkVuZCAmJiBvcHRpb25zLnRyYW5zaXRpb25FbmQuY2FsbChldmVudCwgaW5kZXgsIHNsaWRlc1tpbmRleF0pO1xuXG4gICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpO1xuICAgICAgICByZXR1cm47XG5cbiAgICAgIH1cblxuICAgICAgZWxlbWVudC5zdHlsZS5sZWZ0ID0gKCggKHRvIC0gZnJvbSkgKiAoTWF0aC5mbG9vcigodGltZUVsYXAgLyBzcGVlZCkgKiAxMDApIC8gMTAwKSApICsgZnJvbSkgKyAncHgnO1xuXG4gICAgfSwgNCk7XG5cbiAgfVxuXG4gIC8vIHNldHVwIGF1dG8gc2xpZGVzaG93XG4gIHZhciBkZWxheSA9IG9wdGlvbnMuYXV0byB8fCAwO1xuICB2YXIgaW50ZXJ2YWw7XG5cbiAgZnVuY3Rpb24gYmVnaW4oKSB7XG5cbiAgICBpbnRlcnZhbCA9IHNldFRpbWVvdXQobmV4dCwgZGVsYXkpO1xuXG4gIH1cblxuICBmdW5jdGlvbiBzdG9wKCkge1xuXG4gICAgZGVsYXkgPSAwO1xuICAgIGNsZWFyVGltZW91dChpbnRlcnZhbCk7XG5cbiAgfVxuXG5cbiAgLy8gc2V0dXAgaW5pdGlhbCB2YXJzXG4gIHZhciBzdGFydCA9IHt9O1xuICB2YXIgZGVsdGEgPSB7fTtcbiAgdmFyIGlzU2Nyb2xsaW5nO1xuXG4gIC8vIHNldHVwIGV2ZW50IGNhcHR1cmluZ1xuICB2YXIgZXZlbnRzID0ge1xuXG4gICAgaGFuZGxlRXZlbnQ6IGZ1bmN0aW9uKGV2ZW50KSB7XG5cbiAgICAgIHN3aXRjaCAoZXZlbnQudHlwZSkge1xuICAgICAgICBjYXNlICd0b3VjaHN0YXJ0JzogdGhpcy5zdGFydChldmVudCk7IGJyZWFrO1xuICAgICAgICBjYXNlICd0b3VjaG1vdmUnOiB0aGlzLm1vdmUoZXZlbnQpOyBicmVhaztcbiAgICAgICAgY2FzZSAndG91Y2hlbmQnOiBvZmZsb2FkRm4odGhpcy5lbmQoZXZlbnQpKTsgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3dlYmtpdFRyYW5zaXRpb25FbmQnOlxuICAgICAgICBjYXNlICdtc1RyYW5zaXRpb25FbmQnOlxuICAgICAgICBjYXNlICdvVHJhbnNpdGlvbkVuZCc6XG4gICAgICAgIGNhc2UgJ290cmFuc2l0aW9uZW5kJzpcbiAgICAgICAgY2FzZSAndHJhbnNpdGlvbmVuZCc6IG9mZmxvYWRGbih0aGlzLnRyYW5zaXRpb25FbmQoZXZlbnQpKTsgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3Jlc2l6ZSc6IG9mZmxvYWRGbihzZXR1cCk7IGJyZWFrO1xuICAgICAgfVxuXG4gICAgICBpZiAob3B0aW9ucy5zdG9wUHJvcGFnYXRpb24pIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgfSxcbiAgICBzdGFydDogZnVuY3Rpb24oZXZlbnQpIHtcblxuICAgICAgdmFyIHRvdWNoZXMgPSBldmVudC50b3VjaGVzWzBdO1xuXG4gICAgICAvLyBtZWFzdXJlIHN0YXJ0IHZhbHVlc1xuICAgICAgc3RhcnQgPSB7XG5cbiAgICAgICAgLy8gZ2V0IGluaXRpYWwgdG91Y2ggY29vcmRzXG4gICAgICAgIHg6IHRvdWNoZXMucGFnZVgsXG4gICAgICAgIHk6IHRvdWNoZXMucGFnZVksXG5cbiAgICAgICAgLy8gc3RvcmUgdGltZSB0byBkZXRlcm1pbmUgdG91Y2ggZHVyYXRpb25cbiAgICAgICAgdGltZTogK25ldyBEYXRlXG5cbiAgICAgIH07XG5cbiAgICAgIC8vIHVzZWQgZm9yIHRlc3RpbmcgZmlyc3QgbW92ZSBldmVudFxuICAgICAgaXNTY3JvbGxpbmcgPSB1bmRlZmluZWQ7XG5cbiAgICAgIC8vIHJlc2V0IGRlbHRhIGFuZCBlbmQgbWVhc3VyZW1lbnRzXG4gICAgICBkZWx0YSA9IHt9O1xuXG4gICAgICAvLyBhdHRhY2ggdG91Y2htb3ZlIGFuZCB0b3VjaGVuZCBsaXN0ZW5lcnNcbiAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgdGhpcywgZmFsc2UpO1xuICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIHRoaXMsIGZhbHNlKTtcblxuICAgIH0sXG4gICAgbW92ZTogZnVuY3Rpb24oZXZlbnQpIHtcblxuICAgICAgLy8gZW5zdXJlIHN3aXBpbmcgd2l0aCBvbmUgdG91Y2ggYW5kIG5vdCBwaW5jaGluZ1xuICAgICAgaWYgKCBldmVudC50b3VjaGVzLmxlbmd0aCA+IDEgfHwgZXZlbnQuc2NhbGUgJiYgZXZlbnQuc2NhbGUgIT09IDEpIHJldHVyblxuXG4gICAgICBpZiAob3B0aW9ucy5kaXNhYmxlU2Nyb2xsKSBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICB2YXIgdG91Y2hlcyA9IGV2ZW50LnRvdWNoZXNbMF07XG5cbiAgICAgIC8vIG1lYXN1cmUgY2hhbmdlIGluIHggYW5kIHlcbiAgICAgIGRlbHRhID0ge1xuICAgICAgICB4OiB0b3VjaGVzLnBhZ2VYIC0gc3RhcnQueCxcbiAgICAgICAgeTogdG91Y2hlcy5wYWdlWSAtIHN0YXJ0LnlcbiAgICAgIH1cblxuICAgICAgLy8gZGV0ZXJtaW5lIGlmIHNjcm9sbGluZyB0ZXN0IGhhcyBydW4gLSBvbmUgdGltZSB0ZXN0XG4gICAgICBpZiAoIHR5cGVvZiBpc1Njcm9sbGluZyA9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBpc1Njcm9sbGluZyA9ICEhKCBpc1Njcm9sbGluZyB8fCBNYXRoLmFicyhkZWx0YS54KSA8IE1hdGguYWJzKGRlbHRhLnkpICk7XG4gICAgICB9XG5cbiAgICAgIC8vIGlmIHVzZXIgaXMgbm90IHRyeWluZyB0byBzY3JvbGwgdmVydGljYWxseVxuICAgICAgaWYgKCFpc1Njcm9sbGluZykge1xuXG4gICAgICAgIC8vIHByZXZlbnQgbmF0aXZlIHNjcm9sbGluZ1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIC8vIHN0b3Agc2xpZGVzaG93XG4gICAgICAgIHN0b3AoKTtcblxuICAgICAgICAvLyBpbmNyZWFzZSByZXNpc3RhbmNlIGlmIGZpcnN0IG9yIGxhc3Qgc2xpZGVcbiAgICAgICAgaWYgKG9wdGlvbnMuY29udGludW91cykgeyAvLyB3ZSBkb24ndCBhZGQgcmVzaXN0YW5jZSBhdCB0aGUgZW5kXG5cbiAgICAgICAgICB0cmFuc2xhdGUoY2lyY2xlKGluZGV4LTEpLCBkZWx0YS54ICsgc2xpZGVQb3NbY2lyY2xlKGluZGV4LTEpXSwgMCk7XG4gICAgICAgICAgdHJhbnNsYXRlKGluZGV4LCBkZWx0YS54ICsgc2xpZGVQb3NbaW5kZXhdLCAwKTtcbiAgICAgICAgICB0cmFuc2xhdGUoY2lyY2xlKGluZGV4KzEpLCBkZWx0YS54ICsgc2xpZGVQb3NbY2lyY2xlKGluZGV4KzEpXSwgMCk7XG5cbiAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgIGRlbHRhLnggPVxuICAgICAgICAgICAgZGVsdGEueCAvXG4gICAgICAgICAgICAgICggKCFpbmRleCAmJiBkZWx0YS54ID4gMCAgICAgICAgICAgICAgIC8vIGlmIGZpcnN0IHNsaWRlIGFuZCBzbGlkaW5nIGxlZnRcbiAgICAgICAgICAgICAgICB8fCBpbmRleCA9PSBzbGlkZXMubGVuZ3RoIC0gMSAgICAgICAgLy8gb3IgaWYgbGFzdCBzbGlkZSBhbmQgc2xpZGluZyByaWdodFxuICAgICAgICAgICAgICAgICYmIGRlbHRhLnggPCAwICAgICAgICAgICAgICAgICAgICAgICAvLyBhbmQgaWYgc2xpZGluZyBhdCBhbGxcbiAgICAgICAgICAgICAgKSA/XG4gICAgICAgICAgICAgICggTWF0aC5hYnMoZGVsdGEueCkgLyB3aWR0aCArIDEgKSAgICAgIC8vIGRldGVybWluZSByZXNpc3RhbmNlIGxldmVsXG4gICAgICAgICAgICAgIDogMSApOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vIHJlc2lzdGFuY2UgaWYgZmFsc2VcblxuICAgICAgICAgIC8vIHRyYW5zbGF0ZSAxOjFcbiAgICAgICAgICB0cmFuc2xhdGUoaW5kZXgtMSwgZGVsdGEueCArIHNsaWRlUG9zW2luZGV4LTFdLCAwKTtcbiAgICAgICAgICB0cmFuc2xhdGUoaW5kZXgsIGRlbHRhLnggKyBzbGlkZVBvc1tpbmRleF0sIDApO1xuICAgICAgICAgIHRyYW5zbGF0ZShpbmRleCsxLCBkZWx0YS54ICsgc2xpZGVQb3NbaW5kZXgrMV0sIDApO1xuICAgICAgICB9XG5cbiAgICAgIH1cblxuICAgIH0sXG4gICAgZW5kOiBmdW5jdGlvbihldmVudCkge1xuXG4gICAgICAvLyBtZWFzdXJlIGR1cmF0aW9uXG4gICAgICB2YXIgZHVyYXRpb24gPSArbmV3IERhdGUgLSBzdGFydC50aW1lO1xuXG4gICAgICAvLyBkZXRlcm1pbmUgaWYgc2xpZGUgYXR0ZW1wdCB0cmlnZ2VycyBuZXh0L3ByZXYgc2xpZGVcbiAgICAgIHZhciBpc1ZhbGlkU2xpZGUgPVxuICAgICAgICAgICAgTnVtYmVyKGR1cmF0aW9uKSA8IDI1MCAgICAgICAgICAgICAgIC8vIGlmIHNsaWRlIGR1cmF0aW9uIGlzIGxlc3MgdGhhbiAyNTBtc1xuICAgICAgICAgICAgJiYgTWF0aC5hYnMoZGVsdGEueCkgPiAyMCAgICAgICAgICAgIC8vIGFuZCBpZiBzbGlkZSBhbXQgaXMgZ3JlYXRlciB0aGFuIDIwcHhcbiAgICAgICAgICAgIHx8IE1hdGguYWJzKGRlbHRhLngpID4gd2lkdGgvMjsgICAgICAvLyBvciBpZiBzbGlkZSBhbXQgaXMgZ3JlYXRlciB0aGFuIGhhbGYgdGhlIHdpZHRoXG5cbiAgICAgIC8vIGRldGVybWluZSBpZiBzbGlkZSBhdHRlbXB0IGlzIHBhc3Qgc3RhcnQgYW5kIGVuZFxuICAgICAgdmFyIGlzUGFzdEJvdW5kcyA9XG4gICAgICAgICAgICAhaW5kZXggJiYgZGVsdGEueCA+IDAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgZmlyc3Qgc2xpZGUgYW5kIHNsaWRlIGFtdCBpcyBncmVhdGVyIHRoYW4gMFxuICAgICAgICAgICAgfHwgaW5kZXggPT0gc2xpZGVzLmxlbmd0aCAtIDEgJiYgZGVsdGEueCA8IDA7ICAgIC8vIG9yIGlmIGxhc3Qgc2xpZGUgYW5kIHNsaWRlIGFtdCBpcyBsZXNzIHRoYW4gMFxuXG4gICAgICBpZiAob3B0aW9ucy5jb250aW51b3VzKSBpc1Bhc3RCb3VuZHMgPSBmYWxzZTtcblxuICAgICAgLy8gZGV0ZXJtaW5lIGRpcmVjdGlvbiBvZiBzd2lwZSAodHJ1ZTpyaWdodCwgZmFsc2U6bGVmdClcbiAgICAgIHZhciBkaXJlY3Rpb24gPSBkZWx0YS54IDwgMDtcblxuICAgICAgLy8gaWYgbm90IHNjcm9sbGluZyB2ZXJ0aWNhbGx5XG4gICAgICBpZiAoIWlzU2Nyb2xsaW5nKSB7XG5cbiAgICAgICAgaWYgKGlzVmFsaWRTbGlkZSAmJiAhaXNQYXN0Qm91bmRzKSB7XG5cbiAgICAgICAgICBpZiAoZGlyZWN0aW9uKSB7XG5cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmNvbnRpbnVvdXMpIHsgLy8gd2UgbmVlZCB0byBnZXQgdGhlIG5leHQgaW4gdGhpcyBkaXJlY3Rpb24gaW4gcGxhY2VcblxuICAgICAgICAgICAgICBtb3ZlKGNpcmNsZShpbmRleC0xKSwgLXdpZHRoLCAwKTtcbiAgICAgICAgICAgICAgbW92ZShjaXJjbGUoaW5kZXgrMiksIHdpZHRoLCAwKTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgbW92ZShpbmRleC0xLCAtd2lkdGgsIDApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtb3ZlKGluZGV4LCBzbGlkZVBvc1tpbmRleF0td2lkdGgsIHNwZWVkKTtcbiAgICAgICAgICAgIG1vdmUoY2lyY2xlKGluZGV4KzEpLCBzbGlkZVBvc1tjaXJjbGUoaW5kZXgrMSldLXdpZHRoLCBzcGVlZCk7XG4gICAgICAgICAgICBpbmRleCA9IGNpcmNsZShpbmRleCsxKTtcblxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5jb250aW51b3VzKSB7IC8vIHdlIG5lZWQgdG8gZ2V0IHRoZSBuZXh0IGluIHRoaXMgZGlyZWN0aW9uIGluIHBsYWNlXG5cbiAgICAgICAgICAgICAgbW92ZShjaXJjbGUoaW5kZXgrMSksIHdpZHRoLCAwKTtcbiAgICAgICAgICAgICAgbW92ZShjaXJjbGUoaW5kZXgtMiksIC13aWR0aCwgMCk7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIG1vdmUoaW5kZXgrMSwgd2lkdGgsIDApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtb3ZlKGluZGV4LCBzbGlkZVBvc1tpbmRleF0rd2lkdGgsIHNwZWVkKTtcbiAgICAgICAgICAgIG1vdmUoY2lyY2xlKGluZGV4LTEpLCBzbGlkZVBvc1tjaXJjbGUoaW5kZXgtMSldK3dpZHRoLCBzcGVlZCk7XG4gICAgICAgICAgICBpbmRleCA9IGNpcmNsZShpbmRleC0xKTtcblxuICAgICAgICAgIH1cblxuICAgICAgICAgIG9wdGlvbnMuY2FsbGJhY2sgJiYgb3B0aW9ucy5jYWxsYmFjayhpbmRleCwgc2xpZGVzW2luZGV4XSk7XG5cbiAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgIGlmIChvcHRpb25zLmNvbnRpbnVvdXMpIHtcblxuICAgICAgICAgICAgbW92ZShjaXJjbGUoaW5kZXgtMSksIC13aWR0aCwgc3BlZWQpO1xuICAgICAgICAgICAgbW92ZShpbmRleCwgMCwgc3BlZWQpO1xuICAgICAgICAgICAgbW92ZShjaXJjbGUoaW5kZXgrMSksIHdpZHRoLCBzcGVlZCk7XG5cbiAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICBtb3ZlKGluZGV4LTEsIC13aWR0aCwgc3BlZWQpO1xuICAgICAgICAgICAgbW92ZShpbmRleCwgMCwgc3BlZWQpO1xuICAgICAgICAgICAgbW92ZShpbmRleCsxLCB3aWR0aCwgc3BlZWQpO1xuICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICAgIH1cblxuICAgICAgLy8ga2lsbCB0b3VjaG1vdmUgYW5kIHRvdWNoZW5kIGV2ZW50IGxpc3RlbmVycyB1bnRpbCB0b3VjaHN0YXJ0IGNhbGxlZCBhZ2FpblxuICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBldmVudHMsIGZhbHNlKVxuICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIGV2ZW50cywgZmFsc2UpXG5cbiAgICB9LFxuICAgIHRyYW5zaXRpb25FbmQ6IGZ1bmN0aW9uKGV2ZW50KSB7XG5cbiAgICAgIGlmIChwYXJzZUludChldmVudC50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLWluZGV4JyksIDEwKSA9PSBpbmRleCkge1xuXG4gICAgICAgIGlmIChkZWxheSkgYmVnaW4oKTtcblxuICAgICAgICBvcHRpb25zLnRyYW5zaXRpb25FbmQgJiYgb3B0aW9ucy50cmFuc2l0aW9uRW5kLmNhbGwoZXZlbnQsIGluZGV4LCBzbGlkZXNbaW5kZXhdKTtcblxuICAgICAgfVxuXG4gICAgfVxuXG4gIH1cblxuICAvLyB0cmlnZ2VyIHNldHVwXG4gIHNldHVwKCk7XG5cbiAgLy8gc3RhcnQgYXV0byBzbGlkZXNob3cgaWYgYXBwbGljYWJsZVxuICBpZiAoZGVsYXkpIGJlZ2luKCk7XG5cblxuICAvLyBhZGQgZXZlbnQgbGlzdGVuZXJzXG4gIGlmIChicm93c2VyLmFkZEV2ZW50TGlzdGVuZXIpIHtcblxuICAgIC8vIHNldCB0b3VjaHN0YXJ0IGV2ZW50IG9uIGVsZW1lbnRcbiAgICBpZiAoYnJvd3Nlci50b3VjaCkgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgZXZlbnRzLCBmYWxzZSk7XG5cbiAgICBpZiAoYnJvd3Nlci50cmFuc2l0aW9ucykge1xuICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd3ZWJraXRUcmFuc2l0aW9uRW5kJywgZXZlbnRzLCBmYWxzZSk7XG4gICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21zVHJhbnNpdGlvbkVuZCcsIGV2ZW50cywgZmFsc2UpO1xuICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdvVHJhbnNpdGlvbkVuZCcsIGV2ZW50cywgZmFsc2UpO1xuICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdvdHJhbnNpdGlvbmVuZCcsIGV2ZW50cywgZmFsc2UpO1xuICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0cmFuc2l0aW9uZW5kJywgZXZlbnRzLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgLy8gc2V0IHJlc2l6ZSBldmVudCBvbiB3aW5kb3dcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZXZlbnRzLCBmYWxzZSk7XG5cbiAgfSBlbHNlIHtcblxuICAgIHdpbmRvdy5vbnJlc2l6ZSA9IGZ1bmN0aW9uICgpIHsgc2V0dXAoKSB9OyAvLyB0byBwbGF5IG5pY2Ugd2l0aCBvbGQgSUVcblxuICB9XG5cbiAgLy8gZXhwb3NlIHRoZSBTd2lwZSBBUElcbiAgcmV0dXJuIHtcbiAgICBzZXR1cDogZnVuY3Rpb24oKSB7XG5cbiAgICAgIHNldHVwKCk7XG5cbiAgICB9LFxuICAgIHNsaWRlOiBmdW5jdGlvbih0bywgc3BlZWQpIHtcblxuICAgICAgLy8gY2FuY2VsIHNsaWRlc2hvd1xuICAgICAgc3RvcCgpO1xuXG4gICAgICBzbGlkZSh0bywgc3BlZWQpO1xuXG4gICAgfSxcbiAgICBwcmV2OiBmdW5jdGlvbigpIHtcblxuICAgICAgLy8gY2FuY2VsIHNsaWRlc2hvd1xuICAgICAgc3RvcCgpO1xuXG4gICAgICBwcmV2KCk7XG5cbiAgICB9LFxuICAgIG5leHQ6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAvLyBjYW5jZWwgc2xpZGVzaG93XG4gICAgICBzdG9wKCk7XG5cbiAgICAgIG5leHQoKTtcblxuICAgIH0sXG4gICAgc3RvcDogZnVuY3Rpb24oKSB7XG5cbiAgICAgIC8vIGNhbmNlbCBzbGlkZXNob3dcbiAgICAgIHN0b3AoKTtcblxuICAgIH0sXG4gICAgZ2V0UG9zOiBmdW5jdGlvbigpIHtcblxuICAgICAgLy8gcmV0dXJuIGN1cnJlbnQgaW5kZXggcG9zaXRpb25cbiAgICAgIHJldHVybiBpbmRleDtcblxuICAgIH0sXG4gICAgZ2V0TnVtU2xpZGVzOiBmdW5jdGlvbigpIHtcblxuICAgICAgLy8gcmV0dXJuIHRvdGFsIG51bWJlciBvZiBzbGlkZXNcbiAgICAgIHJldHVybiBsZW5ndGg7XG4gICAgfSxcbiAgICBraWxsOiBmdW5jdGlvbigpIHtcblxuICAgICAgLy8gY2FuY2VsIHNsaWRlc2hvd1xuICAgICAgc3RvcCgpO1xuXG4gICAgICAvLyByZXNldCBlbGVtZW50XG4gICAgICBlbGVtZW50LnN0eWxlLndpZHRoID0gJyc7XG4gICAgICBlbGVtZW50LnN0eWxlLmxlZnQgPSAnJztcblxuICAgICAgLy8gcmVzZXQgc2xpZGVzXG4gICAgICB2YXIgcG9zID0gc2xpZGVzLmxlbmd0aDtcbiAgICAgIHdoaWxlKHBvcy0tKSB7XG5cbiAgICAgICAgdmFyIHNsaWRlID0gc2xpZGVzW3Bvc107XG4gICAgICAgIHNsaWRlLnN0eWxlLndpZHRoID0gJyc7XG4gICAgICAgIHNsaWRlLnN0eWxlLmxlZnQgPSAnJztcblxuICAgICAgICBpZiAoYnJvd3Nlci50cmFuc2l0aW9ucykgdHJhbnNsYXRlKHBvcywgMCwgMCk7XG5cbiAgICAgIH1cblxuICAgICAgLy8gcmVtb3ZlZCBldmVudCBsaXN0ZW5lcnNcbiAgICAgIGlmIChicm93c2VyLmFkZEV2ZW50TGlzdGVuZXIpIHtcblxuICAgICAgICAvLyByZW1vdmUgY3VycmVudCBldmVudCBsaXN0ZW5lcnNcbiAgICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgZXZlbnRzLCBmYWxzZSk7XG4gICAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignd2Via2l0VHJhbnNpdGlvbkVuZCcsIGV2ZW50cywgZmFsc2UpO1xuICAgICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21zVHJhbnNpdGlvbkVuZCcsIGV2ZW50cywgZmFsc2UpO1xuICAgICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ29UcmFuc2l0aW9uRW5kJywgZXZlbnRzLCBmYWxzZSk7XG4gICAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignb3RyYW5zaXRpb25lbmQnLCBldmVudHMsIGZhbHNlKTtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd0cmFuc2l0aW9uZW5kJywgZXZlbnRzLCBmYWxzZSk7XG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCBldmVudHMsIGZhbHNlKTtcblxuICAgICAgfVxuICAgICAgZWxzZSB7XG5cbiAgICAgICAgd2luZG93Lm9ucmVzaXplID0gbnVsbDtcblxuICAgICAgfVxuXG4gICAgfVxuICB9XG5cbn1cblxuXG5pZiAoIHdpbmRvdy5qUXVlcnkgfHwgd2luZG93LlplcHRvICkge1xuICAoZnVuY3Rpb24oJCkge1xuICAgICQuZm4uU3dpcGUgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICQodGhpcykuZGF0YSgnU3dpcGUnLCBuZXcgU3dpcGUoJCh0aGlzKVswXSwgcGFyYW1zKSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0pKCB3aW5kb3cualF1ZXJ5IHx8IHdpbmRvdy5aZXB0byApXG59XG4iLCJmdW5jdGlvbiBkaXN0YW5jZU9mVGltZUluV29yZHMoZnJvbVRpbWUsIHRvVGltZSwgaW5jbHVkZVNlY29uZHMpIHtcbiAgdmFyIGZyb21TZWNvbmRzID0gZnJvbVRpbWUuZ2V0VGltZSgpO1xuICB2YXIgdG9TZWNvbmRzID0gdG9UaW1lLmdldFRpbWUoKTtcbiAgdmFyIGRpc3RhbmNlSW5TZWNvbmRzID0gTWF0aC5yb3VuZChNYXRoLmFicyhmcm9tU2Vjb25kcyAtIHRvU2Vjb25kcykgLyAxMDAwKTtcbiAgdmFyIGRpc3RhbmNlSW5NaW51dGVzID0gTWF0aC5yb3VuZChkaXN0YW5jZUluU2Vjb25kcyAvIDYwKTtcbiAgaWYgKGRpc3RhbmNlSW5NaW51dGVzIDw9IDEpIHtcbiAgICBpZiAoIWluY2x1ZGVTZWNvbmRzKVxuICAgICAgcmV0dXJuIChkaXN0YW5jZUluTWludXRlcyA9PT0gMCkgPyAnbWluZGVyIGRhbiBlZW4gbWludXV0JyA6ICcxIG1pbnV1dCc7XG4gICAgaWYgKGRpc3RhbmNlSW5TZWNvbmRzIDwgNSlcbiAgICAgIHJldHVybiAnNSBzZWNvbmRlIGdlbGVkZW4nO1xuICAgIGlmIChkaXN0YW5jZUluU2Vjb25kcyA8IDEwKVxuICAgICAgcmV0dXJuICcxMCBzZWNvbmRlIGdlbGVkZW4nO1xuICAgIGlmIChkaXN0YW5jZUluU2Vjb25kcyA8IDIwKVxuICAgICAgcmV0dXJuICcyMCBzZWNvbmRlIGdlbGVkZW4nO1xuICAgIGlmIChkaXN0YW5jZUluU2Vjb25kcyA8IDQwKVxuICAgICAgcmV0dXJuICczMCBzZWNvbmRlIGdlbGVkZW4nO1xuICAgIGlmIChkaXN0YW5jZUluU2Vjb25kcyA8IDYwKVxuICAgICAgcmV0dXJuICdlZW4gbWludXV0IGdlbGVkZW4nO1xuICAgIGVsc2VcbiAgICAgIHJldHVybiAnMSBtaW51dXQgZ2VsZWRlbic7XG4gIH1cblxuICBpZiAoZGlzdGFuY2VJbk1pbnV0ZXMgPCA0NSlcbiAgICByZXR1cm4gZGlzdGFuY2VJbk1pbnV0ZXMgKyAnIG1pbnV0ZW4gZ2VsZWRlbic7XG4gIGlmIChkaXN0YW5jZUluTWludXRlcyA8IDcwKVxuICAgIHJldHVybiAnMSB1dXIgZ2VsZWRlbic7XG4gIGlmIChkaXN0YW5jZUluTWludXRlcyA8IDE0NDApXG4gICAgcmV0dXJuIChNYXRoLnJvdW5kKGRpc3RhbmNlSW5NaW51dGVzIC8gNjApKSArICcgdXVyIGdlbGVkZW4nO1xuICBpZiAoZGlzdGFuY2VJbk1pbnV0ZXMgPCAyODgwKVxuICAgIHJldHVybiAnMSBkYWcgZ2VsZWRlbic7XG4gIGlmIChkaXN0YW5jZUluTWludXRlcyA8IDQzMjAwKVxuICAgIHJldHVybiAoTWF0aC5yb3VuZChkaXN0YW5jZUluTWludXRlcyAvIDE0NDApKSArICcgZGFnZW4gZ2VsZWRlbic7XG4gIGlmIChkaXN0YW5jZUluTWludXRlcyA8IDg2NDAwKVxuICAgIHJldHVybiAncnVpbSAxIG1hYW5kIGdlbGVkZW4nO1xuICBpZiAoZGlzdGFuY2VJbk1pbnV0ZXMgPCA1MjU2MDApXG4gICAgcmV0dXJuIChNYXRoLnJvdW5kKGRpc3RhbmNlSW5NaW51dGVzIC8gNDMyMDApKSArICcgbWFhbmRlbiBnZWxlZGVuJztcbiAgZWxzZVxuICAgIHJldHVybiAoTWF0aC5yb3VuZChkaXN0YW5jZUluTWludXRlcyAvIDUyNTYwMCkpICsgJyBqYXJlbiBnZWxlZGVuJztcbn07XG5cbi8vVHdpdHRlciBQYXJzZXJzXG5TdHJpbmcucHJvdG90eXBlLnBhcnNlVVJMID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5yZXBsYWNlKC9bQS1aYS16XSs6XFwvXFwvW0EtWmEtejAtOS1fXStcXC5bQS1aYS16MC05LV86JSZ+XFw/XFwvLj1dKy9nLCBmdW5jdGlvbiAodSkge1xuICAgIHJldHVybiB1LmxpbmsodSkub3BlblVybEJsYW5rKCk7XG4gIH0pO1xufTtcblxuU3RyaW5nLnByb3RvdHlwZS5wYXJzZVVzZXJuYW1lID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5yZXBsYWNlKC8gW0BdK1tBLVphLXowLTktX10rL2csIGZ1bmN0aW9uICh1KSB7XG4gICAgdmFyIHVzZXJuYW1lID0gdS5yZXBsYWNlKCcgQCcsICcnKTtcbiAgICByZXR1cm4gdS5saW5rKCdodHRwczovL3R3aXR0ZXIuY29tLycgKyB1c2VybmFtZSkub3BlblVybEJsYW5rKCk7XG4gIH0pO1xufTtcblxuU3RyaW5nLnByb3RvdHlwZS5wYXJzZUhhc2h0YWcgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzLnJlcGxhY2UoLyBbI10rW0EtWmEtejAtOS1fXSsvZywgZnVuY3Rpb24gKHQpIHtcbiAgICB2YXIgdGFnID0gdC5yZXBsYWNlKCcgIycsICclMjMnKTtcbiAgICByZXR1cm4gdC5saW5rKCdodHRwczovL3R3aXR0ZXIuY29tL3NlYXJjaD9xPScgKyB0YWcpLm9wZW5VcmxCbGFuaygpO1xuICB9KTtcbn07XG5cblN0cmluZy5wcm90b3R5cGUucGFyc2VEYXRlID0gZnVuY3Rpb24gKCkge1xuICB2YXIgbmV3dGV4dCA9IHRoaXMucmVwbGFjZSgvKFxcK1xcUyspICguKikvLCAnJDIgJDEnKTtcbiAgdmFyIGRhdGUgPSBuZXcgRGF0ZShEYXRlLnBhcnNlKG5ld3RleHQpKTtcbiAgcmV0dXJuIGRhdGU7XG59O1xuXG5TdHJpbmcucHJvdG90eXBlLm9wZW5VcmxCbGFuayA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHRoaXMucmVwbGFjZSgvXjxhLywgJyQmIHRhcmdldD1cIl9ibGFua1wiJyk7XG59XG5cbmZ1bmN0aW9uIHByb2Nlc3NUd2VldHMoZGF0YSwgdW5pcXVlKSB7XG4gIHZhciB0d2VldHMgPSBbXTtcbiAgJC5lYWNoKGRhdGEsIGZ1bmN0aW9uIChpLCBvYmopIHtcbiAgICB2YXIgZWxlbWVudCA9IG9iajtcbiAgICBpZighZWxlbWVudC5oYXNFeHRlcm5hbFVybCkge1xuICAgICAgb2JqLnRleHQgPSBvYmoudGV4dC5wYXJzZVVSTCgpO1xuICAgIH1cbiAgICBlbGVtZW50LnRleHQgPSBvYmoudGV4dC5wYXJzZVVzZXJuYW1lKCkucGFyc2VIYXNodGFnKCk7XG4gICAgdmFyIGNyZWF0ZWQgPSBlbGVtZW50LmNyZWF0ZWQucGFyc2VEYXRlKCk7XG4gICAgZGVsZXRlIGVsZW1lbnQuY3JlYXRlZDtcbiAgICB2YXIgbm93ID0gbmV3IERhdGUoKTtcbiAgICBlbGVtZW50LmRhdGUgPSBkaXN0YW5jZU9mVGltZUluV29yZHMobm93LCBjcmVhdGVkLCB0cnVlKSArICcgZ2VwbGFhdHN0JztcbiAgICBlbGVtZW50LnR3ZWV0VXJsID0gJ2h0dHBzOi8vdHdpdHRlci5jb20vLS9zdGF0dXMvJyArIGVsZW1lbnQudHdlZXRJZDtcbiAgICBlbGVtZW50LnJldHdlZXRVcmwgPSAnaHR0cHM6Ly90d2l0dGVyLmNvbS9pbnRlbnQvcmV0d2VldD90d2VldF9pZD0nICsgZWxlbWVudC50d2VldElkO1xuICAgIGVsZW1lbnQucmVwbHlVcmwgPSAnaHR0cHM6Ly90d2l0dGVyLmNvbS9pbnRlbnQvdHdlZXQ/aW5fcmVwbHlfdG89JyArIGVsZW1lbnQudHdlZXRJZDtcbiAgICBlbGVtZW50Lmxpa2VVcmwgPSAnaHR0cHM6Ly90d2l0dGVyLmNvbS9pbnRlbnQvbGlrZT90d2VldF9pZD0nICsgZWxlbWVudC50d2VldElkO1xuICAgIGVsZW1lbnQuZm9sbG93VXJsID0gJ2h0dHBzOi8vdHdpdHRlci5jb20vaW50ZW50L2ZvbGxvdz9zY3JlZW5fbmFtZT0nICsgZWxlbWVudC5zY3JlZW5OYW1lO1xuICAgIHR3ZWV0cy5wdXNoKGVsZW1lbnQpO1xuICB9KTtcbiAgcmV0dXJuIHR3ZWV0cztcbn07XG4iLCJ2YXIgdGFnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG5cbnRhZy5zcmMgPSBcImh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL2lmcmFtZV9hcGlcIjtcbnZhciBmaXJzdFNjcmlwdFRhZyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzY3JpcHQnKVswXTtcbmZpcnN0U2NyaXB0VGFnLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHRhZywgZmlyc3RTY3JpcHRUYWcpO1xuXG5mdW5jdGlvbiBhZGRQbGF5ZXIoc2xpZGVOciwgaWQpIHtcbiAgY29uc29sZS5sb2coc2xpZGVOcik7XG4gIEFQUC5Zb3VUdWJlLnlvdXR1YmVQbGF5ZXIgPSBbXTtcbiAgQVBQLllvdVR1YmUueW91dHViZVBsYXllcltzbGlkZU5yXSA9IG5ldyBZVC5QbGF5ZXIoJ3lvdXR1YmUtcGxheWVyJyArIHNsaWRlTnIsIHtcbiAgICB3aWR0aDogXCIxMDAlXCIsXG4gICAgaGVpZ2h0OiBcIjEwMCVcIixcbiAgICB2aWRlb0lkOiBpZCxcbiAgICBldmVudHM6IHtcbiAgICAgICdvblN0YXRlQ2hhbmdlJzogb25QbGF5ZXJTdGF0ZUNoYW5nZVxuICAgIH1cbiAgfSk7XG4gIGNvbnNvbGUubG9nKEFQUC5Zb3VUdWJlLnlvdXR1YmVQbGF5ZXJbc2xpZGVOcl0pO1xufVxuXG5mdW5jdGlvbiBvblBsYXllclN0YXRlQ2hhbmdlKGV2ZW50KSB7XG4gIGNvbnNvbGUubG9nKGV2ZW50LnRhcmdldCk7XG4gIHN3aXRjaChldmVudC5kYXRhKSB7XG4gICAgY2FzZSAtMTpcbiAgICAgY29uc29sZS5sb2coJ3ZpZGVvIHVuc3RhcnRlZCcpO1xuICAgICBjb25zb2xlLmxvZygnRHVyYXRpb246JyArIGV2ZW50LnRhcmdldC5nZXREdXJhdGlvbigpKTtcbiAgICBjYXNlIDA6XG4gICAgICBjb25zb2xlLmxvZygndmlkZW8gZW5kZWQnKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgMTpcbiAgICAgIGNvbnNvbGUubG9nKCd2aWRlbyBwbGF5aW5nIGZyb20gJyArIGV2ZW50LnRhcmdldC5nZXRDdXJyZW50VGltZSgpKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgMjpcbiAgICAgIGNvbnNvbGUubG9nKCd2aWRlbyBwYXVzZWQgYXQgJyArIGV2ZW50LnRhcmdldC5nZXRDdXJyZW50VGltZSgpKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgMzpcbiAgICAgIGNvbnNvbGUubG9nKCd2aWRlbyBidWZmZXJpbmcnKTtcbiAgICBjYXNlIDU6XG4gICAgICBjb25zb2xlLmxvZygndmlkZW8gY3VlZCcpO1xuICB9XG59XG4iLCIoZnVuY3Rpb24gKCkge1xuXG4gIC8vIGFwcCBuYW1lc3BhY2Ugc2V0dXBcbiAgQVBQID0ge1xuICAgIFZpZXdzOiB7fSxcbiAgICBZb3VUdWJlOiB7fVxuICB9O1xuXG59KSgpO1xuIiwiLy8gZm9yIGpzaGludFxuLypnbG9iYWwgcmVxdWlyZSwgZGVmaW5lICovXG5cbihmdW5jdGlvbihyb290LCBmYWN0b3J5KSB7XG4gIC8vIFN0YXJ0IHdpdGggQU1EIHN1cHBvcnQuXG4gIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoWyd1bmRlcnNjb3JlJywgJ2JhY2tib25lJ10sIGZ1bmN0aW9uKF8sIEJhY2tib25lKSB7XG4gICAgICBmYWN0b3J5KHJvb3QsIF8sIEJhY2tib25lKTtcbiAgICB9KTtcblxuICAvLyBOZXh0IGNoZWNrIGZvciBOb2RlLmpzIG9yIENvbW1vbkpTLlxuICB9IGVsc2UgaWYgKHR5cGVvZiBleHBvcnRzICE9PSAndW5kZWZpbmVkJykge1xuICAgIHZhciBfID0gcmVxdWlyZSgndW5kZXJzY29yZScpO1xuICAgIHZhciBCYWNrYm9uZSA9IHJlcXVpcmUoJ2JhY2tib25lJyk7XG4gICAgZmFjdG9yeShyb290LCBfLCBCYWNrYm9uZSk7XG5cbiAgLy8gRmlubmFseSwgaWYgbm9uZSBvZiB0aGUgYWJvdmUsIGNyZWF0ZSB0aGUgZXh0ZW5zaW9uIGFuZFxuICAvLyBhc3N1bWUgQmFja2JvbmUgaXMgYXZhaWxhYmxlIGF0IChicm93c2VyKSBnbG9iYWwgc2NvcGUuXG4gIH0gZWxzZSB7XG4gICAgZmFjdG9yeShyb290LCByb290Ll8sIHJvb3QuQmFja2JvbmUpO1xuICB9XG59KHRoaXMsIGZ1bmN0aW9uKHJvb3QsIF8sIEJhY2tib25lKSB7XG5cbiAgLy8gQmFja2JvbmUuVmlld1N0YXRlXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIC8vIGBCYWNrYm9uZS5WaWV3U3RhdGVgIG9iamVjdHMgYXJlIGRlc2lnbmVkIHRvIGJlIG5vdGhpbmcgbW9yZSBidXRcbiAgLy8gYSB3cmFwcGVyIHRoYXQgaXMgbm90IGEgTW9kZWwgYnV0IGRvZXMgbmVlZCB0byAnaG9sZCcgZGF0YS5cbiAgLy8gQW4gZXhhbXBsZSBvZiBhIFZpZXdTdGF0ZSB2YWx1ZSBpcyB3aGVuIHlvdXIgbW91c2Ugb3IgZmluZ2VyXG4gIC8vIGlzIGhvdmVyaW5nIG92ZXIgc29tZSB0YXJnZXQgdG8gYWRkIGB7b3ZlcjogdHJ1ZX1gIHRvIHRoZSB2aWV3U3RhdGUuXG4gIC8vIFRoZSBpZGVhIGJlaGluZCBpdCBpcyB0aGF0IHlvdSBjYW4gdXNlIGdldEF0dHJpYnV0ZXMgYXMgZGVmYXVsdFxuICAvLyBmb3IgZGF0YSBpbiB5b3VyIHJlbmRlciBmdW5jdGlvbi5cblxuICAvLyBGb3IgZXhhbXBsZTpcbiAgLy9cbiAgLy8gICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gIC8vICAgICAgIHRoaXMuZWwuaHRtbCh0ZW1wbGF0ZShfLmV4dGVuZChcbiAgLy8gICAgICAgICAgdGhpcy52aWV3U3RhdGUuZ2V0QXR0cmlidXRlcygpLFxuICAvLyAgICAgICAgICB0aGlzLm1vZGVsLnRvSlNPTigpXG4gIC8vICAgICAgICkpKTtcbiAgLy8gICAgIH1cbiAgLy9cbiAgdmFyIFZpZXdTdGF0ZSA9IEJhY2tib25lLlZpZXdTdGF0ZSA9IGZ1bmN0aW9uKGF0dHJpYnV0ZXMpIHtcbiAgICB2YXIgYXR0cnMgPSBhdHRyaWJ1dGVzIHx8IHt9O1xuICAgIHRoaXMuYXR0cmlidXRlcyA9IF8uY2xvbmUoYXR0cnMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKFZpZXdTdGF0ZS5wcm90b3R5cGUsIEJhY2tib25lLkV2ZW50cywge1xuICAgIC8vIGdldCB0aGUgdmFsdWUgb2YgYW4gYXR0cmlidXRlXG4gICAgZ2V0OiBmdW5jdGlvbihhdHRyKSB7XG4gICAgICByZXR1cm4gdGhpcy5hdHRyaWJ1dGVzW2F0dHJdO1xuICAgIH0sXG5cbiAgICAvLyByZXR1cm5zIGFsbCBhdHRyaWJ1dGVzIChsaWtlIHRvSlNPTiwgYnV0IHRoaXMgYWxyZWFkeSBpcyAncG9qbycpXG4gICAgZ2V0QXR0cmlidXRlczogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gXy5jbG9uZSh0aGlzLmF0dHJpYnV0ZXMpO1xuICAgIH0sXG5cbiAgICAvLyBTZXQgYSBoYXNoIG9mIGF0dHJpYnV0ZXMgb24gdGhlIG9iamVjdCAoZmlyaW5nIGBjaGFuZ2VgKS4gVGhpcyBpc1xuICAgIC8vIHRoZSBjb3JlIG9wZXJhdGlvbiBvZiBhIHZpZXdTdGF0ZSBvYmplY3QsIHVwZGF0aW5nIHRoZSBkYXRhIGFuZFxuICAgIC8vIG5vdGlmeWluZyBhbnlvbmUgd2hvIG5lZWRzIHRvIGtub3cgYWJvdXQgdGhlIGNoYW5nZS5cbiAgICBzZXQ6IGZ1bmN0aW9uKGtleSwgdmFsLCBvcHRpb25zKSB7XG4gICAgICB2YXIgYXR0cnMsIGF0dHIsIGN1cnJlbnQsIHNpbGVudCwgdW5zZXQsIGNoYW5nZXMgPSBbXTtcbiAgICAgIGlmIChrZXkgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIC8vIExpa2UgaW4gQmFja2JvbmUuTW9kZWwsIHlvdSBjYW4gc3VwcGx5IGJvdGggYHtrZXk6IHZhbHVlfWAgYXNcbiAgICAgIC8vIGBcImtleVwiLCB2YWx1ZWAtc3R5bGUgYXJndW1lbnRzLlxuICAgICAgaWYgKHR5cGVvZiBrZXkgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIGF0dHJzID0ga2V5O1xuICAgICAgICBvcHRpb25zID0gdmFsO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgKGF0dHJzID0ge30pW2tleV0gPSB2YWw7XG4gICAgICB9XG5cbiAgICAgIG9wdGlvbnMgfHwgKG9wdGlvbnMgPSB7fSk7XG5cbiAgICAgIHVuc2V0ICAgPSBvcHRpb25zLnVuc2V0O1xuICAgICAgc2lsZW50ICA9IG9wdGlvbnMuc2lsZW50O1xuICAgICAgY3VycmVudCA9IHRoaXMuYXR0cmlidXRlcztcblxuICAgICAgZm9yIChhdHRyIGluIGF0dHJzKSB7XG4gICAgICAgIHZhbCA9IGF0dHJzW2F0dHJdO1xuICAgICAgICBpZiAoIV8uaXNFcXVhbChjdXJyZW50W2F0dHJdLCB2YWwpKSB7XG4gICAgICAgICAgY2hhbmdlcy5wdXNoKGF0dHIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1bnNldCkge1xuICAgICAgICAgIGRlbGV0ZSBjdXJyZW50W2F0dHJdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGN1cnJlbnRbYXR0cl0gPSB2YWw7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKCFzaWxlbnQpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBjaGFuZ2VzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgIHRoaXMudHJpZ2dlcignY2hhbmdlOicrIGNoYW5nZXNbaV0sIHRoaXMsIGN1cnJlbnRbY2hhbmdlc1tpXV0sIG9wdGlvbnMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudHJpZ2dlcignY2hhbmdlJywgdGhpcywgb3B0aW9ucyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgLy8gUmVtb3ZlIGFuIGF0dHJpYnV0ZSBmcm9tIHRoZSBvYmplY3QsIGFsc28gZmlyaW5nIGEgYGNoYW5nZWAuXG4gICAgdW5zZXQ6IGZ1bmN0aW9uKGF0dHIsIG9wdGlvbnMpIHtcbiAgICAgIHJldHVybiB0aGlzLnNldChhdHRyLCB2b2lkIDAsIF8uZXh0ZW5kKHt9LCBvcHRpb25zLCB7dW5zZXQ6IHRydWV9KSk7XG4gICAgfSxcblxuICAgIC8vIENsZWFyIGFsbCBhdHRyaWJ1dGVzIG9mZiB0aGlzIG1vZGVsLCBhbHNvIGZpcmluZyBgY2hhbmdlYFxuICAgIGNsZWFyOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICB2YXIgYXR0cnMgPSB7fTtcbiAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLmF0dHJpYnV0ZXMpIHtcbiAgICAgICAgYXR0cnNba2V5XSA9IHZvaWQgMDtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLnNldChhdHRycywgXy5leHRlbmQoe30sIG9wdGlvbnMsIHt1bnNldDogdHJ1ZX0pKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBCYWNrYm9uZS5WaWV3U3RhdGU7XG59KSk7XG4iLCJBUFAuU3RvcmUgPSAoZnVuY3Rpb24gKF8sIEJhY2tib25lKSB7XG5cbiAgdmFyIHNsaWRlQ29sbGVjdGlvbiA9IG5ldyBCYWNrYm9uZS5Db2xsZWN0aW9uKCk7XG5cbiAgdmFyIHN0YXRlID0gbmV3IEJhY2tib25lLlZpZXdTdGF0ZSh7XG4gICAgYWN0aXZlSW5kZXg6IC0xXG4gIH0pO1xuXG5cbiAgcmV0dXJuIHtcbiAgICBzdGFydDogZnVuY3Rpb24oZGF0YUpzb24pIHtcbiAgICAgIHNsaWRlQ29sbGVjdGlvbi5yZXNldChkYXRhSnNvbik7XG4gICAgICBzbGlkZUNvbGxlY3Rpb24uaW52b2tlKCdzZXQnLCB7ICdkYXRhU2V0JzogZmFsc2UgfSk7XG4gICAgfSxcblxuICAgIGdldFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBzdGF0ZTtcbiAgICB9LFxuXG4gICAgZ2V0U2xpZGVDb2xsZWN0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBzbGlkZUNvbGxlY3Rpb247XG4gICAgfVxuICB9O1xufSkodGhpcy5fLCB0aGlzLkJhY2tib25lKTtcbiIsIihmdW5jdGlvbiAoXywgQmFja2JvbmUsIFN3aXBlKSB7XG4gIC8vIHRoZSBtZWF0IG9mIHRoZSBsb2dpYywgZGVmaW5lcyB0aGUgc2xpZGVzaG93LCBob29rcyBpbnRvIGV4aXN0aW5nIGRvbSBlbGVtZW50cyByZXByZXNlbnRpbmcgc2xpZGVzIGFuZCBjb250cm9sc1xuICAvLyBoYW5kbGVzIGV2ZW50cyBhbmQgdGltaW5nLCBwbGF5LCBwYXVzZSwganVtcHRvXG5cbiAgQVBQLlZpZXdzLlNsaWRlc2hvdyA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcblxuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICB0aGlzLnRpbWVTZXQgPSBvcHRpb25zLnRpbWVTZXQ7XG4gICAgICB0aGlzLnRlbXBsYXRlTmFtZSA9IG9wdGlvbnMudGVtcGxhdGVOYW1lO1xuICAgICAgdGhpcy5oYW5kbGUgPSBvcHRpb25zLmhhbmRsZTtcblxuICAgICAgdGhpcy5yZW5kZXIoKTtcblxuICAgICAgdGhpcy5saXN0ZW5UbyhBUFAuU3RvcmUuZ2V0U3RhdGUoKSwgJ2NoYW5nZTphY3RpdmVJbmRleCcsIHRoaXMuc2xpZGUpO1xuICAgICAgdmFyIHJhbmRvbUluZGV4ID0gKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMuY29sbGVjdGlvbi5sZW5ndGggLSAxKSlcbiAgICAgIEFQUC5TdG9yZS5nZXRTdGF0ZSgpLnNldCgnYWN0aXZlSW5kZXgnLCByYW5kb21JbmRleCk7XG5cbiAgICAgIHZhciBlbGVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ215U3dpcGUnKTtcbiAgICAgIHdpbmRvdy5teVN3aXBlID0gU3dpcGUoZWxlbSwge1xuICAgICAgICBzdGFydFNsaWRlOiByYW5kb21JbmRleCxcbiAgICAgICAgYXV0bzogdGhpcy50aW1lU2V0LFxuICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oaW5kZXgsIGVsZW0pIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnY2FsbGJhY2snKTtcbiAgICAgICAgICBBUFAuU3RvcmUuZ2V0U3RhdGUoKS5zZXQoJ2FjdGl2ZUluZGV4JywgaW5kZXgpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIC8vIEFQUC5Zb3VUdWJlLnlvdXR1YmVQbGF5ZXJbNDBdLnBsYXlWaWRlbygpO1xuXG4gICAgICB0aGlzLmJpbmRzKCk7XG4gICAgfSxcblxuICAgIGJpbmRzOiBmdW5jdGlvbigpIHtcbiAgICAgIF8uYmluZEFsbCh0aGlzLCAna2V5RG93bicpO1xuICAgICAgJChkb2N1bWVudCkub24oJ2tleWRvd24nLCB0aGlzLmtleURvd24pO1xuICAgIH0sXG5cbiAgICBrZXlEb3duOiBmdW5jdGlvbiAoZXYpIHtcbiAgICAgIHN3aXRjaCAoZXYua2V5Q29kZSkge1xuICAgICAgICBjYXNlIDM3OlxuICAgICAgICAgIHdpbmRvdy5teVN3aXBlLnByZXYoKVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDM4OlxuICAgICAgICAgIHRoaXMuc3RvcFRpbWVyU2xpZGUoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAzOTpcbiAgICAgICAgICB3aW5kb3cubXlTd2lwZS5uZXh0KClcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSA0MDpcbiAgICAgICAgICB0aGlzLnN0b3BUaW1lclNsaWRlKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHNsaWRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgbmV4dDtcbiAgICAgIHZhciBwcmV2O1xuICAgICAgdmFyIGFjdGl2ZSA9IEFQUC5TdG9yZS5nZXRTdGF0ZSgpLmdldCgnYWN0aXZlSW5kZXgnKTtcbiAgICAgIHZhciBzbGlkZXNMZW5naHQgPSB0aGlzLmNvbGxlY3Rpb24ubGVuZ3RoO1xuXG4gICAgICBpZiAoYWN0aXZlID09PSBzbGlkZXNMZW5naHQpIHtcbiAgICAgICAgYWN0aXZlID0gMDtcbiAgICAgIH0gZWxzZSBpZiAoYWN0aXZlID09PSAtMSkge1xuICAgICAgICBhY3RpdmUgPSAoc2xpZGVzTGVuZ2h0IC0gMSk7XG4gICAgICB9XG5cbiAgICAgIEFQUC5TdG9yZS5nZXRTdGF0ZSgpLnNldCgnYWN0aXZlSW5kZXgnLCBhY3RpdmUsIHtcbiAgICAgICAgc2lsZW50OiB0cnVlLFxuICAgICAgfSlcblxuICAgICAgaWYgKGFjdGl2ZSA9PT0gKHNsaWRlc0xlbmdodCAtIDEpKSB7XG4gICAgICAgIG5leHQgPSAwO1xuICAgICAgICBwcmV2ID0gYWN0aXZlIC0gMTtcbiAgICAgIH0gZWxzZSBpZiAoYWN0aXZlID09PSAwKSB7XG4gICAgICAgIHByZXYgPSAoc2xpZGVzTGVuZ2h0IC0gMSk7XG4gICAgICAgIG5leHQgPSBhY3RpdmUgKyAxO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV4dCA9IGFjdGl2ZSArIDE7XG4gICAgICAgIHByZXYgPSBhY3RpdmUgLSAxO1xuICAgICAgfVxuXG4gICAgICB2YXIgcHJldkVsID0gdGhpcy4kZWwuZmluZCgnW2RhdGEtaWQ9XCInICsgcHJldiArICdcIl0nKTtcbiAgICAgIGlmKCF0aGlzLmNvbGxlY3Rpb24uZ2V0KHByZXYpLmdldCgnZGF0YVNldCcpKSB7XG4gICAgICAgIHRoaXMuYWRkQ29udGVudFRvVGVtcGxhdGUocHJldkVsLCBwcmV2KTtcbiAgICAgICAgaWYodGhpcy5oYW5kbGUgPT09ICdib2xjb21yZWNsYW1lcycpIHtcbiAgICAgICAgICBhZGRQbGF5ZXIocHJldiwgdGhpcy5jb2xsZWN0aW9uLmdldChwcmV2KS5nZXQoJ3VybCcpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNvbGxlY3Rpb24uZ2V0KHByZXYpLnNldCgnZGF0YVNldCcsIHRydWUpO1xuICAgICAgfVxuXG4gICAgICB2YXIgYWN0aXZlRWwgPSB0aGlzLiRlbC5maW5kKCdbZGF0YS1pZD1cIicgKyBhY3RpdmUgKyAnXCJdJyk7XG4gICAgICBpZighdGhpcy5jb2xsZWN0aW9uLmdldChhY3RpdmUpLmdldCgnZGF0YVNldCcpKSB7XG4gICAgICAgIHRoaXMuYWRkQ29udGVudFRvVGVtcGxhdGUoYWN0aXZlRWwsIGFjdGl2ZSk7XG4gICAgICAgIGlmKHRoaXMuaGFuZGxlID09PSAnYm9sY29tcmVjbGFtZXMnKSB7XG4gICAgICAgICAgYWRkUGxheWVyKGFjdGl2ZSwgdGhpcy5jb2xsZWN0aW9uLmdldChhY3RpdmUpLmdldCgndXJsJykpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29sbGVjdGlvbi5nZXQoYWN0aXZlKS5zZXQoJ2RhdGFTZXQnLCB0cnVlKTtcbiAgICAgIH1cblxuICAgICAgdmFyIG5leHRFbCA9IHRoaXMuJGVsLmZpbmQoJ1tkYXRhLWlkPVwiJyArIG5leHQgKyAnXCJdJyk7XG4gICAgICBpZighdGhpcy5jb2xsZWN0aW9uLmdldChuZXh0KS5nZXQoJ2RhdGFTZXQnKSkge1xuICAgICAgICB0aGlzLmFkZENvbnRlbnRUb1RlbXBsYXRlKG5leHRFbCwgbmV4dCk7XG4gICAgICAgIGlmKHRoaXMuaGFuZGxlID09PSAnYm9sY29tcmVjbGFtZXMnKSB7XG4gICAgICAgICAgYWRkUGxheWVyKG5leHQsIHRoaXMuY29sbGVjdGlvbi5nZXQobmV4dCkuZ2V0KCd1cmwnKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uLmdldChuZXh0KS5zZXQoJ2RhdGFTZXQnLCB0cnVlKTtcbiAgICAgIH1cblxuICAgIH0sXG5cbiAgICBnZXRUZW1wbGF0ZURhdGE6IGZ1bmN0aW9uKHNsaWRlbnIpIHtcbiAgICAgIHZhciBkYXRhID0gdGhpcy5jb2xsZWN0aW9uLmdldChzbGlkZW5yKTtcbiAgICAgIHJldHVybiBkYXRhLnRvSlNPTigpO1xuICAgIH0sXG5cbiAgICBhZGRDb250ZW50VG9UZW1wbGF0ZTogZnVuY3Rpb24oZWwsIHNsaWRlbnIpIHtcbiAgICAgIHZhciBzb3VyY2UgPSAkKHRoaXMudGVtcGxhdGVOYW1lKS5odG1sKCk7XG4gICAgICB0aGlzLnRlbXBsYXRlID0gSGFuZGxlYmFycy5jb21waWxlKHNvdXJjZSk7XG4gICAgICBlbC5hcHBlbmQodGhpcy50ZW1wbGF0ZSh0aGlzLmdldFRlbXBsYXRlRGF0YShzbGlkZW5yKSkpO1xuICAgIH0sXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBzb3VyY2UgPSAkKCcjcGxhY2Vob2xkZXItdGVtcGxhdGUnKS5odG1sKCk7XG4gICAgICB0aGlzLnRlbXBsYXRlID0gSGFuZGxlYmFycy5jb21waWxlKHNvdXJjZSk7XG4gICAgICB0aGlzLmNvbGxlY3Rpb24uZWFjaChmdW5jdGlvbihtb2RlbCkge1xuICAgICAgICAgIHRoaXMuJGVsLmFwcGVuZCh0aGlzLnRlbXBsYXRlKG1vZGVsLnRvSlNPTigpKSk7XG4gICAgICB9LCB0aGlzKTtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICB9KTtcblxufSkodGhpcy5fLCBCYWNrYm9uZSwgU3dpcGUpO1xuIl19
