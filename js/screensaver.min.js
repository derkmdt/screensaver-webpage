function processBolcomProducts(){}function loadData(t,e,n){jQuery(".backdrop."+t).addClass("visible"),$.ajax({url:e,type:"GET",success:function(e){if("undefined"==typeof e.errors||e.errors.length<1){var i;i=-1!=n.feed.indexOf("bolpuntcom")?e.products:-1!=n.feed.indexOf("nunl")?e:processTweets(e),jQuery(".backdrop."+t+" .tw").addClass("animation")}else $(".post .message .text-message").text("Response error")},error:function(t){$(".post .message .text-message").text("Request error")}})}function Swipe(t,e){"use strict";function n(){v=b.children,w=v.length,v.length<2&&(e.continuous=!1),p.transitions&&e.continuous&&v.length<3&&(b.appendChild(v[0].cloneNode(!0)),b.appendChild(b.children[1].cloneNode(!0)),v=b.children),m=new Array(v.length),g=t.getBoundingClientRect().width||t.offsetWidth,b.style.width=v.length*g+"px";for(var n=v.length;n--;){var i=v[n];i.style.width=g+"px",i.setAttribute("data-index",n),p.transitions&&(i.style.left=n*-g+"px",s(n,x>n?-g:n>x?g:0,0))}e.continuous&&p.transitions&&(s(r(x-1),-g,0),s(r(x+1),g,0)),p.transitions||(b.style.left=x*-g+"px"),t.style.visibility="visible"}function i(){e.continuous?a(x-1):x&&a(x-1)}function o(){e.continuous?a(x+1):x<v.length-1&&a(x+1)}function r(t){return(v.length+t%v.length)%v.length}function a(t,n){if(x!=t){if(p.transitions){var i=Math.abs(x-t)/(x-t);if(e.continuous){var o=i;i=-m[r(t)]/g,i!==o&&(t=-i*v.length+t)}for(var a=Math.abs(x-t)-1;a--;)s(r((t>x?t:x)-a-1),g*i,0);t=r(t),s(x,g*i,n||y),s(t,0,n||y),e.continuous&&s(r(t-i),-(g*i),0)}else t=r(t),d(x*-g,t*-g,n||y);x=t,f(e.callback&&e.callback(x,v[x]))}}function s(t,e,n){c(t,e,n),m[t]=e}function c(t,e,n){var i=v[t],o=i&&i.style;o&&(o.webkitTransitionDuration=o.MozTransitionDuration=o.msTransitionDuration=o.OTransitionDuration=o.transitionDuration=n+"ms",o.webkitTransform="translate("+e+"px,0)translateZ(0)",o.msTransform=o.MozTransform=o.OTransform="translateX("+e+"px)")}function d(t,n,i){if(!i)return void(b.style.left=n+"px");var o=+new Date,r=setInterval(function(){var a=+new Date-o;return a>i?(b.style.left=n+"px",E&&u(),e.transitionEnd&&e.transitionEnd.call(event,x,v[x]),void clearInterval(r)):void(b.style.left=(n-t)*(Math.floor(a/i*100)/100)+t+"px")},4)}function u(){S=setTimeout(o,E)}function l(){E=0,clearTimeout(S)}var h=function(){},f=function(t){setTimeout(t||h,0)},p={addEventListener:!!window.addEventListener,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,transitions:function(t){var e=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];for(var n in e)if(void 0!==t.style[e[n]])return!0;return!1}(document.createElement("swipe"))};if(t){var v,m,g,w,b=t.children[0];e=e||{};var x=parseInt(e.startSlide,10)||0,y=e.speed||300;e.continuous=void 0!==e.continuous?e.continuous:!0;var S,T,E=e.auto||0,k={},D={},L={handleEvent:function(t){switch(t.type){case"touchstart":this.start(t);break;case"touchmove":this.move(t);break;case"touchend":f(this.end(t));break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":f(this.transitionEnd(t));break;case"resize":f(n)}e.stopPropagation&&t.stopPropagation()},start:function(t){var e=t.touches[0];k={x:e.pageX,y:e.pageY,time:+new Date},T=void 0,D={},b.addEventListener("touchmove",this,!1),b.addEventListener("touchend",this,!1)},move:function(t){if(!(t.touches.length>1||t.scale&&1!==t.scale)){e.disableScroll&&t.preventDefault();var n=t.touches[0];D={x:n.pageX-k.x,y:n.pageY-k.y},"undefined"==typeof T&&(T=!!(T||Math.abs(D.x)<Math.abs(D.y))),T||(t.preventDefault(),l(),e.continuous?(c(r(x-1),D.x+m[r(x-1)],0),c(x,D.x+m[x],0),c(r(x+1),D.x+m[r(x+1)],0)):(D.x=D.x/(!x&&D.x>0||x==v.length-1&&D.x<0?Math.abs(D.x)/g+1:1),c(x-1,D.x+m[x-1],0),c(x,D.x+m[x],0),c(x+1,D.x+m[x+1],0)))}},end:function(t){var n=+new Date-k.time,i=Number(n)<250&&Math.abs(D.x)>20||Math.abs(D.x)>g/2,o=!x&&D.x>0||x==v.length-1&&D.x<0;e.continuous&&(o=!1);var a=D.x<0;T||(i&&!o?(a?(e.continuous?(s(r(x-1),-g,0),s(r(x+2),g,0)):s(x-1,-g,0),s(x,m[x]-g,y),s(r(x+1),m[r(x+1)]-g,y),x=r(x+1)):(e.continuous?(s(r(x+1),g,0),s(r(x-2),-g,0)):s(x+1,g,0),s(x,m[x]+g,y),s(r(x-1),m[r(x-1)]+g,y),x=r(x-1)),e.callback&&e.callback(x,v[x])):e.continuous?(s(r(x-1),-g,y),s(x,0,y),s(r(x+1),g,y)):(s(x-1,-g,y),s(x,0,y),s(x+1,g,y))),b.removeEventListener("touchmove",L,!1),b.removeEventListener("touchend",L,!1)},transitionEnd:function(t){parseInt(t.target.getAttribute("data-index"),10)==x&&(E&&u(),e.transitionEnd&&e.transitionEnd.call(t,x,v[x]))}};return n(),E&&u(),p.addEventListener?(p.touch&&b.addEventListener("touchstart",L,!1),p.transitions&&(b.addEventListener("webkitTransitionEnd",L,!1),b.addEventListener("msTransitionEnd",L,!1),b.addEventListener("oTransitionEnd",L,!1),b.addEventListener("otransitionend",L,!1),b.addEventListener("transitionend",L,!1)),window.addEventListener("resize",L,!1)):window.onresize=function(){n()},{setup:function(){n()},slide:function(t,e){l(),a(t,e)},prev:function(){l(),i()},next:function(){l(),o()},stop:function(){l()},getPos:function(){return x},getNumSlides:function(){return w},kill:function(){l(),b.style.width="",b.style.left="";for(var t=v.length;t--;){var e=v[t];e.style.width="",e.style.left="",p.transitions&&c(t,0,0)}p.addEventListener?(b.removeEventListener("touchstart",L,!1),b.removeEventListener("webkitTransitionEnd",L,!1),b.removeEventListener("msTransitionEnd",L,!1),b.removeEventListener("oTransitionEnd",L,!1),b.removeEventListener("otransitionend",L,!1),b.removeEventListener("transitionend",L,!1),window.removeEventListener("resize",L,!1)):window.onresize=null}}}}function distanceOfTimeInWords(t,e,n){var i=t.getTime(),o=e.getTime(),r=Math.round(Math.abs(i-o)/1e3),a=Math.round(r/60);return 1>=a?n?5>r?"5 seconde geleden":10>r?"10 seconde geleden":20>r?"20 seconde geleden":40>r?"30 seconde geleden":60>r?"een minuut geleden":"1 minuut geleden":0===a?"minder dan een minuut":"1 minuut":45>a?a+" minuten geleden":70>a?"1 uur geleden":1440>a?Math.round(a/60)+" uur geleden":2880>a?"1 dag geleden":43200>a?Math.round(a/1440)+" dagen geleden":86400>a?"ruim 1 maand geleden":525600>a?Math.round(a/43200)+" maanden geleden":Math.round(a/525600)+" jaren geleden"}function processTweets(t,e){var n=[];return $.each(t,function(t,e){var i=e;i.text=e.text.parseURL().parseUsername().parseHashtag();var o=e.created.parseDate();delete i.created;var r=new Date;i.date=distanceOfTimeInWords(r,o,!0)+" geplaatst",i.tweetUrl="https://twitter.com/-/status/"+e.tweetId,i.retweetUrl="https://twitter.com/intent/retweet?tweet_id="+e.tweetId,i.replyUrl="https://twitter.com/intent/tweet?in_reply_to="+e.tweetId,i.likeUrl="https://twitter.com/intent/like?tweet_id="+e.tweetId,i.followUrl="https://twitter.com/intent/follow?screen_name="+e.screenName,n.push(i)}),n}!function(){APP={Views:{}}}(),function(t,e){if("function"==typeof define&&define.amd)define(["underscore","backbone"],function(n,i){e(t,n,i)});else if("undefined"!=typeof exports){var n=require("underscore"),i=require("backbone");e(t,n,i)}else e(t,t._,t.Backbone)}(this,function(t,e,n){var i=n.ViewState=function(t){var n=t||{};this.attributes=e.clone(n)};return e.extend(i.prototype,n.Events,{get:function(t){return this.attributes[t]},getAttributes:function(){return e.clone(this.attributes)},set:function(t,n,i){var o,r,a,s,c,d=[];if(null===t)return this;"object"==typeof t?(o=t,i=n):(o={})[t]=n,i||(i={}),c=i.unset,s=i.silent,a=this.attributes;for(r in o)n=o[r],e.isEqual(a[r],n)||d.push(r),c?delete a[r]:a[r]=n;if(!s){for(var u=0,l=d.length;l>u;u++)this.trigger("change:"+d[u],this,a[d[u]],i);this.trigger("change",this,i)}return this},unset:function(t,n){return this.set(t,void 0,e.extend({},n,{unset:!0}))},clear:function(t){var n={};for(var i in this.attributes)n[i]=void 0;return this.set(n,e.extend({},t,{unset:!0}))}}),n.ViewState}),APP.Store=function(t,e){var n=new e.Collection,i=new e.ViewState({activeIndex:-1});return{start:function(t){n.reset(t),n.invoke("set",{dataSet:!1})},getState:function(){return i},getSlideCollection:function(){return n}}}(this._,this.Backbone),(window.jQuery||window.Zepto)&&!function(t){t.fn.Swipe=function(e){return this.each(function(){t(this).data("Swipe",new Swipe(t(this)[0],e))})}}(window.jQuery||window.Zepto),String.prototype.parseURL=function(){return this.replace(/[A-Za-z]+:\/\/[A-Za-z0-9-_]+\.[A-Za-z0-9-_:%&~\?\/.=]+/g,function(t){return t.link(t)})},String.prototype.parseUsername=function(){return this.replace(/[@]+[A-Za-z0-9-_]+/g,function(t){var e=t.replace("@","");return t.link("https://twitter.com/"+e)})},String.prototype.parseHashtag=function(){return this.replace(/[#]+[A-Za-z0-9-_]+/g,function(t){var e=t.replace("#","%23");return t.link("https://twitter.com/search?q="+e)})},String.prototype.parseDate=function(){var t=this.replace(/(\+\S+) (.*)/,"$2 $1"),e=new Date(Date.parse(t));return e},function(t,e,n){APP.Views.Slideshow=e.View.extend({initialize:function(t){this.timeSet=t.timeSet,this.templateName=t.templateName,this.render(),this.listenTo(APP.Store.getState(),"change:activeIndex",this.slide);var e=Math.floor(Math.random()*this.collection.length-1);APP.Store.getState().set("activeIndex",e),console.log(e);var i=document.getElementById("mySwipe");window.mySwipe=n(i,{startSlide:e,auto:8e3,callback:function(t,e){console.log(t),APP.Store.getState().set("activeIndex",t)}}),this.binds()},binds:function(){t.bindAll(this,"keyDown"),$(document).on("keydown",this.keyDown)},keyDown:function(t){switch(t.keyCode){case 37:window.mySwipe.prev();break;case 38:this.stopTimerSlide();break;case 39:window.mySwipe.next();break;case 40:this.stopTimerSlide()}},slide:function(){var t,e,n=APP.Store.getState().get("activeIndex"),i=this.collection.length;n===i?n=0:-1===n&&(n=i-1),APP.Store.getState().set("activeIndex",n,{silent:!0}),n===i-1?(t=0,e=n-1):0===n?(e=i-1,t=n+1):(t=n+1,e=n-1);var o=this.$el.find('[data-id="'+e+'"]');this.collection.get(e).get("dataSet")||(this.addContentToTemplate(o,e),this.collection.get(e).set("dataSet",!0));var r=this.$el.find('[data-id="'+n+'"]');this.collection.get(n).get("dataSet")||(this.addContentToTemplate(r,n),this.collection.get(n).set("dataSet",!0));var a=this.$el.find('[data-id="'+t+'"]');this.collection.get(t).get("dataSet")||(this.addContentToTemplate(a,t),this.collection.get(t).set("dataSet",!0))},getTemplateData:function(t){var e=this.collection.get(t);return e.toJSON()},addContentToTemplate:function(t,e){var n=$(this.templateName).html();this.template=Handlebars.compile(n),t.append(this.template(this.getTemplateData(e)))},render:function(){var t=$("#placeholder-template").html();return this.template=Handlebars.compile(t),this.collection.each(function(t){this.$el.append(this.template(t.toJSON()))},this),this}})}(this._,Backbone,Swipe);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJvbGNvbS5qcyIsImRhdGEuanMiLCJzd2lwZS5qcyIsInR3aXR0ZXIuanMiLCJhcHAuanMiLCJiYWNrYm9uZS12aWV3c3RhdGUuanMiLCJTdG9yZS5qcyIsInZpZXdzL3NsaWRlc2hvdy5qcyJdLCJuYW1lcyI6WyJwcm9jZXNzQm9sY29tUHJvZHVjdHMiLCJsb2FkRGF0YSIsImhhbmRsZSIsImRhdGFVcmwiLCJxdWVyeSIsImpRdWVyeSIsImFkZENsYXNzIiwiJCIsImFqYXgiLCJ1cmwiLCJ0eXBlIiwic3VjY2VzcyIsInJlc3BvbnNlIiwiZXJyb3JzIiwibGVuZ3RoIiwiZGF0YSIsImZlZWQiLCJpbmRleE9mIiwicHJvZHVjdHMiLCJwcm9jZXNzVHdlZXRzIiwidGV4dCIsImVycm9yIiwiU3dpcGUiLCJjb250YWluZXIiLCJvcHRpb25zIiwic2V0dXAiLCJzbGlkZXMiLCJlbGVtZW50IiwiY2hpbGRyZW4iLCJjb250aW51b3VzIiwiYnJvd3NlciIsInRyYW5zaXRpb25zIiwiYXBwZW5kQ2hpbGQiLCJjbG9uZU5vZGUiLCJzbGlkZVBvcyIsIkFycmF5Iiwid2lkdGgiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJvZmZzZXRXaWR0aCIsInN0eWxlIiwicG9zIiwic2xpZGUiLCJzZXRBdHRyaWJ1dGUiLCJsZWZ0IiwibW92ZSIsImluZGV4IiwiY2lyY2xlIiwidmlzaWJpbGl0eSIsInByZXYiLCJuZXh0IiwidG8iLCJzbGlkZVNwZWVkIiwiZGlyZWN0aW9uIiwiTWF0aCIsImFicyIsIm5hdHVyYWxfZGlyZWN0aW9uIiwiZGlmZiIsInNwZWVkIiwiYW5pbWF0ZSIsIm9mZmxvYWRGbiIsImNhbGxiYWNrIiwiZGlzdCIsInRyYW5zbGF0ZSIsIndlYmtpdFRyYW5zaXRpb25EdXJhdGlvbiIsIk1velRyYW5zaXRpb25EdXJhdGlvbiIsIm1zVHJhbnNpdGlvbkR1cmF0aW9uIiwiT1RyYW5zaXRpb25EdXJhdGlvbiIsInRyYW5zaXRpb25EdXJhdGlvbiIsIndlYmtpdFRyYW5zZm9ybSIsIm1zVHJhbnNmb3JtIiwiTW96VHJhbnNmb3JtIiwiT1RyYW5zZm9ybSIsImZyb20iLCJzdGFydCIsIkRhdGUiLCJ0aW1lciIsInNldEludGVydmFsIiwidGltZUVsYXAiLCJkZWxheSIsImJlZ2luIiwidHJhbnNpdGlvbkVuZCIsImNhbGwiLCJldmVudCIsImNsZWFySW50ZXJ2YWwiLCJmbG9vciIsImludGVydmFsIiwic2V0VGltZW91dCIsInN0b3AiLCJjbGVhclRpbWVvdXQiLCJub29wIiwiZm4iLCJhZGRFdmVudExpc3RlbmVyIiwid2luZG93IiwidG91Y2giLCJEb2N1bWVudFRvdWNoIiwiZG9jdW1lbnQiLCJ0ZW1wIiwicHJvcHMiLCJpIiwidW5kZWZpbmVkIiwiY3JlYXRlRWxlbWVudCIsInBhcnNlSW50Iiwic3RhcnRTbGlkZSIsImlzU2Nyb2xsaW5nIiwiYXV0byIsImRlbHRhIiwiZXZlbnRzIiwiaGFuZGxlRXZlbnQiLCJ0aGlzIiwiZW5kIiwic3RvcFByb3BhZ2F0aW9uIiwidG91Y2hlcyIsIngiLCJwYWdlWCIsInkiLCJwYWdlWSIsInRpbWUiLCJzY2FsZSIsImRpc2FibGVTY3JvbGwiLCJwcmV2ZW50RGVmYXVsdCIsImR1cmF0aW9uIiwiaXNWYWxpZFNsaWRlIiwiTnVtYmVyIiwiaXNQYXN0Qm91bmRzIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInRhcmdldCIsImdldEF0dHJpYnV0ZSIsIm9ucmVzaXplIiwiZ2V0UG9zIiwiZ2V0TnVtU2xpZGVzIiwia2lsbCIsImRpc3RhbmNlT2ZUaW1lSW5Xb3JkcyIsImZyb21UaW1lIiwidG9UaW1lIiwiaW5jbHVkZVNlY29uZHMiLCJmcm9tU2Vjb25kcyIsImdldFRpbWUiLCJ0b1NlY29uZHMiLCJkaXN0YW5jZUluU2Vjb25kcyIsInJvdW5kIiwiZGlzdGFuY2VJbk1pbnV0ZXMiLCJ1bmlxdWUiLCJ0d2VldHMiLCJlYWNoIiwib2JqIiwicGFyc2VVUkwiLCJwYXJzZVVzZXJuYW1lIiwicGFyc2VIYXNodGFnIiwiY3JlYXRlZCIsInBhcnNlRGF0ZSIsIm5vdyIsImRhdGUiLCJ0d2VldFVybCIsInR3ZWV0SWQiLCJyZXR3ZWV0VXJsIiwicmVwbHlVcmwiLCJsaWtlVXJsIiwiZm9sbG93VXJsIiwic2NyZWVuTmFtZSIsInB1c2giLCJBUFAiLCJWaWV3cyIsInJvb3QiLCJmYWN0b3J5IiwiZGVmaW5lIiwiYW1kIiwiXyIsIkJhY2tib25lIiwiZXhwb3J0cyIsInJlcXVpcmUiLCJWaWV3U3RhdGUiLCJhdHRyaWJ1dGVzIiwiYXR0cnMiLCJjbG9uZSIsImV4dGVuZCIsInByb3RvdHlwZSIsIkV2ZW50cyIsImdldCIsImF0dHIiLCJnZXRBdHRyaWJ1dGVzIiwic2V0Iiwia2V5IiwidmFsIiwiY3VycmVudCIsInNpbGVudCIsInVuc2V0IiwiY2hhbmdlcyIsImlzRXF1YWwiLCJsIiwidHJpZ2dlciIsImNsZWFyIiwiU3RvcmUiLCJzbGlkZUNvbGxlY3Rpb24iLCJDb2xsZWN0aW9uIiwic3RhdGUiLCJhY3RpdmVJbmRleCIsImRhdGFKc29uIiwicmVzZXQiLCJpbnZva2UiLCJkYXRhU2V0IiwiZ2V0U3RhdGUiLCJnZXRTbGlkZUNvbGxlY3Rpb24iLCJaZXB0byIsInBhcmFtcyIsIlN0cmluZyIsInJlcGxhY2UiLCJsaW5rIiwidSIsInVzZXJuYW1lIiwidCIsInRhZyIsIm5ld3RleHQiLCJwYXJzZSIsIlNsaWRlc2hvdyIsIlZpZXciLCJpbml0aWFsaXplIiwidGltZVNldCIsInRlbXBsYXRlTmFtZSIsInJlbmRlciIsImxpc3RlblRvIiwicmFuZG9tSW5kZXgiLCJyYW5kb20iLCJjb2xsZWN0aW9uIiwiY29uc29sZSIsImxvZyIsImVsZW0iLCJnZXRFbGVtZW50QnlJZCIsIm15U3dpcGUiLCJiaW5kcyIsImJpbmRBbGwiLCJvbiIsImtleURvd24iLCJldiIsImtleUNvZGUiLCJzdG9wVGltZXJTbGlkZSIsImFjdGl2ZSIsInNsaWRlc0xlbmdodCIsInByZXZFbCIsIiRlbCIsImZpbmQiLCJhZGRDb250ZW50VG9UZW1wbGF0ZSIsImFjdGl2ZUVsIiwibmV4dEVsIiwiZ2V0VGVtcGxhdGVEYXRhIiwic2xpZGVuciIsInRvSlNPTiIsImVsIiwic291cmNlIiwiaHRtbCIsInRlbXBsYXRlIiwiSGFuZGxlYmFycyIsImNvbXBpbGUiLCJhcHBlbmQiLCJtb2RlbCJdLCJtYXBwaW5ncyI6IkFBQUEsUUFBQUEsMEJDQUEsUUFBQUMsVUFBQUMsRUFBQUMsRUFBQUMsR0FDQUMsT0FBQSxhQUFBSCxHQUFBSSxTQUFBLFdBRUFDLEVBQUFDLE1BQ0FDLElBQUFOLEVBQ0FPLEtBQUEsTUFDQUMsUUFBQSxTQUFBQyxHQUVBLEdBQUEsbUJBQUFBLEdBQUFDLFFBQUFELEVBQUFDLE9BQUFDLE9BQUEsRUFBQSxDQUNBLEdBQUFDLEVBRUFBLEdBREEsSUFBQVgsRUFBQVksS0FBQUMsUUFBQSxjQUNBTCxFQUFBTSxTQUNBLElBQUFkLEVBQUFZLEtBQUFDLFFBQUEsUUFDQUwsRUFFQU8sY0FBQVAsR0FHQVAsT0FBQSxhQUFBSCxFQUFBLFFBQUFJLFNBQUEsaUJBY0FDLEdBQUEsZ0NBQUFhLEtBQUEsbUJBSUFDLE1BQUEsU0FBQVIsR0FDQU4sRUFBQSxnQ0FBQWEsS0FBQSxvQkM3QkEsUUFBQUUsT0FBQUMsRUFBQUMsR0FFQSxZQTBCQSxTQUFBQyxLQUdBQyxFQUFBQyxFQUFBQyxTQUNBZCxFQUFBWSxFQUFBWixPQUdBWSxFQUFBWixPQUFBLElBQUFVLEVBQUFLLFlBQUEsR0FHQUMsRUFBQUMsYUFBQVAsRUFBQUssWUFBQUgsRUFBQVosT0FBQSxJQUNBYSxFQUFBSyxZQUFBTixFQUFBLEdBQUFPLFdBQUEsSUFDQU4sRUFBQUssWUFBQUwsRUFBQUMsU0FBQSxHQUFBSyxXQUFBLElBQ0FQLEVBQUFDLEVBQUFDLFVBSUFNLEVBQUEsR0FBQUMsT0FBQVQsRUFBQVosUUFHQXNCLEVBQUFiLEVBQUFjLHdCQUFBRCxPQUFBYixFQUFBZSxZQUVBWCxFQUFBWSxNQUFBSCxNQUFBVixFQUFBWixPQUFBc0IsRUFBQSxJQUlBLEtBREEsR0FBQUksR0FBQWQsRUFBQVosT0FDQTBC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SixHQUNBRCxFQUFBTSxPQUFBaEosS0FBQTZJLFNBQUE3SSxLQUFBdUksZ0JBQUFDLE1BR0ExQixPQUFBLFdBQ0EsR0FBQTZCLEdBQUFoUCxFQUFBLHlCQUFBaVAsTUFPQSxPQU5BNUksTUFBQTZJLFNBQUFDLFdBQUFDLFFBQUFKLEdBRUEzSSxLQUFBa0gsV0FBQS9FLEtBQUEsU0FBQThHLEdBQ0FqSixLQUFBa0ksSUFBQWMsT0FBQWhKLEtBQUE2SSxTQUFBSSxFQUFBUixZQUNBekksTUFFQUEsU0FLQUEsS0FBQTBELEVBQUFDLFNBQUFqSiIsImZpbGUiOiJzY3JlZW5zYXZlci5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBwcm9jZXNzQm9sY29tUHJvZHVjdHMoKSB7XG4gIFxufVxuIiwiZnVuY3Rpb24gbG9hZERhdGEoaGFuZGxlLCBkYXRhVXJsLCBxdWVyeSkge1xuICBqUXVlcnkoJy5iYWNrZHJvcC4nICsgaGFuZGxlKS5hZGRDbGFzcygndmlzaWJsZScpO1xuXG4gICQuYWpheCh7XG4gICAgdXJsOiBkYXRhVXJsLFxuICAgIHR5cGU6ICdHRVQnLFxuICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXG4gICAgICBpZiAodHlwZW9mIHJlc3BvbnNlLmVycm9ycyA9PT0gJ3VuZGVmaW5lZCcgfHwgcmVzcG9uc2UuZXJyb3JzLmxlbmd0aCA8IDEpIHtcbiAgICAgICAgdmFyIGRhdGE7XG4gICAgICAgIGlmIChxdWVyeS5mZWVkLmluZGV4T2YoJ2JvbHB1bnRjb20nKSAhPSAtMSkge1xuICAgICAgICAgIGRhdGEgPSByZXNwb25zZS5wcm9kdWN0cztcbiAgICAgICAgfSBlbHNlIGlmKHF1ZXJ5LmZlZWQuaW5kZXhPZignbnVubCcpICE9IC0xKSB7XG4gICAgICAgICAgZGF0YSA9IHJlc3BvbnNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRhdGEgPSBwcm9jZXNzVHdlZXRzKHJlc3BvbnNlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGpRdWVyeSgnLmJhY2tkcm9wLicgKyBoYW5kbGUgKyAnIC50dycpLmFkZENsYXNzKCdhbmltYXRpb24nKTtcbiAgICAgICAgLy8galF1ZXJ5KCcuYmFja2Ryb3AuJyArIGhhbmRsZSArICcgLnR3Jykub25lKCd3ZWJraXRBbmltYXRpb25FbmQgb2FuaW1hdGlvbmVuZCBtc0FuaW1hdGlvbkVuZCBhbmltYXRpb25lbmQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIC8vIEFQUC5TdG9yZS5zdGFydChkYXRhKTtcbiAgICAgICAgICAvLyBBUFAuU2xpZGVzaG93ID0gbmV3IEFQUC5WaWV3cy5TbGlkZXNob3coe1xuICAgICAgICAgIC8vICAgZWw6ICQoJy50ZW1wbGF0ZS1ob2xkZXInKSxcbiAgICAgICAgICAvLyAgIHRlbXBsYXRlTmFtZTogJyMnICsgaGFuZGxlICsgJy10ZW1wbGF0ZScsXG4gICAgICAgICAgLy8gICBjb2xsZWN0aW9uOiBuZXcgQVBQLlN0b3JlLmdldFNsaWRlQ29sbGVjdGlvbigpLFxuICAgICAgICAgIC8vICAgdGltZVNldDogODAwMCxcbiAgICAgICAgICAvLyB9KTtcbiAgICAgICAgICAvL1xuICAgICAgICAgIC8vICQoJy5iYWNrZHJvcC4nICsgaGFuZGxlKS5yZW1vdmVDbGFzcygndmlzaWJsZScpO1xuICAgICAgICAvLyB9KTtcblxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJCgnLnBvc3QgLm1lc3NhZ2UgLnRleHQtbWVzc2FnZScpLnRleHQoJ1Jlc3BvbnNlIGVycm9yJyk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGVycm9yOiBmdW5jdGlvbiAoZXJyb3JzKSB7XG4gICAgICAkKCcucG9zdCAubWVzc2FnZSAudGV4dC1tZXNzYWdlJykudGV4dCgnUmVxdWVzdCBlcnJvcicpO1xuICAgIH0sXG4gIH0pO1xuXG59XG4iLCIvKlxuICogU3dpcGUgMi4wXG4gKlxuICogQnJhZCBCaXJkc2FsbFxuICogQ29weXJpZ2h0IDIwMTMsIE1JVCBMaWNlbnNlXG4gKlxuKi9cblxuZnVuY3Rpb24gU3dpcGUoY29udGFpbmVyLCBvcHRpb25zKSB7XG5cbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgLy8gdXRpbGl0aWVzXG4gIHZhciBub29wID0gZnVuY3Rpb24oKSB7fTsgLy8gc2ltcGxlIG5vIG9wZXJhdGlvbiBmdW5jdGlvblxuICB2YXIgb2ZmbG9hZEZuID0gZnVuY3Rpb24oZm4pIHsgc2V0VGltZW91dChmbiB8fCBub29wLCAwKSB9OyAvLyBvZmZsb2FkIGEgZnVuY3Rpb25zIGV4ZWN1dGlvblxuXG4gIC8vIGNoZWNrIGJyb3dzZXIgY2FwYWJpbGl0aWVzXG4gIHZhciBicm93c2VyID0ge1xuICAgIGFkZEV2ZW50TGlzdGVuZXI6ICEhd2luZG93LmFkZEV2ZW50TGlzdGVuZXIsXG4gICAgdG91Y2g6ICgnb250b3VjaHN0YXJ0JyBpbiB3aW5kb3cpIHx8IHdpbmRvdy5Eb2N1bWVudFRvdWNoICYmIGRvY3VtZW50IGluc3RhbmNlb2YgRG9jdW1lbnRUb3VjaCxcbiAgICB0cmFuc2l0aW9uczogKGZ1bmN0aW9uKHRlbXApIHtcbiAgICAgIHZhciBwcm9wcyA9IFsndHJhbnNpdGlvblByb3BlcnR5JywgJ1dlYmtpdFRyYW5zaXRpb24nLCAnTW96VHJhbnNpdGlvbicsICdPVHJhbnNpdGlvbicsICdtc1RyYW5zaXRpb24nXTtcbiAgICAgIGZvciAoIHZhciBpIGluIHByb3BzICkgaWYgKHRlbXAuc3R5bGVbIHByb3BzW2ldIF0gIT09IHVuZGVmaW5lZCkgcmV0dXJuIHRydWU7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSkoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3dpcGUnKSlcbiAgfTtcblxuICAvLyBxdWl0IGlmIG5vIHJvb3QgZWxlbWVudFxuICBpZiAoIWNvbnRhaW5lcikgcmV0dXJuO1xuICB2YXIgZWxlbWVudCA9IGNvbnRhaW5lci5jaGlsZHJlblswXTtcbiAgdmFyIHNsaWRlcywgc2xpZGVQb3MsIHdpZHRoLCBsZW5ndGg7XG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICB2YXIgaW5kZXggPSBwYXJzZUludChvcHRpb25zLnN0YXJ0U2xpZGUsIDEwKSB8fCAwO1xuICB2YXIgc3BlZWQgPSBvcHRpb25zLnNwZWVkIHx8IDMwMDtcbiAgb3B0aW9ucy5jb250aW51b3VzID0gb3B0aW9ucy5jb250aW51b3VzICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmNvbnRpbnVvdXMgOiB0cnVlO1xuXG4gIGZ1bmN0aW9uIHNldHVwKCkge1xuXG4gICAgLy8gY2FjaGUgc2xpZGVzXG4gICAgc2xpZGVzID0gZWxlbWVudC5jaGlsZHJlbjtcbiAgICBsZW5ndGggPSBzbGlkZXMubGVuZ3RoO1xuXG4gICAgLy8gc2V0IGNvbnRpbnVvdXMgdG8gZmFsc2UgaWYgb25seSBvbmUgc2xpZGVcbiAgICBpZiAoc2xpZGVzLmxlbmd0aCA8IDIpIG9wdGlvbnMuY29udGludW91cyA9IGZhbHNlO1xuXG4gICAgLy9zcGVjaWFsIGNhc2UgaWYgdHdvIHNsaWRlc1xuICAgIGlmIChicm93c2VyLnRyYW5zaXRpb25zICYmIG9wdGlvbnMuY29udGludW91cyAmJiBzbGlkZXMubGVuZ3RoIDwgMykge1xuICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChzbGlkZXNbMF0uY2xvbmVOb2RlKHRydWUpKTtcbiAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoZWxlbWVudC5jaGlsZHJlblsxXS5jbG9uZU5vZGUodHJ1ZSkpO1xuICAgICAgc2xpZGVzID0gZWxlbWVudC5jaGlsZHJlbjtcbiAgICB9XG5cbiAgICAvLyBjcmVhdGUgYW4gYXJyYXkgdG8gc3RvcmUgY3VycmVudCBwb3NpdGlvbnMgb2YgZWFjaCBzbGlkZVxuICAgIHNsaWRlUG9zID0gbmV3IEFycmF5KHNsaWRlcy5sZW5ndGgpO1xuXG4gICAgLy8gZGV0ZXJtaW5lIHdpZHRoIG9mIGVhY2ggc2xpZGVcbiAgICB3aWR0aCA9IGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aCB8fCBjb250YWluZXIub2Zmc2V0V2lkdGg7XG5cbiAgICBlbGVtZW50LnN0eWxlLndpZHRoID0gKHNsaWRlcy5sZW5ndGggKiB3aWR0aCkgKyAncHgnO1xuXG4gICAgLy8gc3RhY2sgZWxlbWVudHNcbiAgICB2YXIgcG9zID0gc2xpZGVzLmxlbmd0aDtcbiAgICB3aGlsZShwb3MtLSkge1xuXG4gICAgICB2YXIgc2xpZGUgPSBzbGlkZXNbcG9zXTtcblxuICAgICAgc2xpZGUuc3R5bGUud2lkdGggPSB3aWR0aCArICdweCc7XG4gICAgICBzbGlkZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtaW5kZXgnLCBwb3MpO1xuXG4gICAgICBpZiAoYnJvd3Nlci50cmFuc2l0aW9ucykge1xuICAgICAgICBzbGlkZS5zdHlsZS5sZWZ0ID0gKHBvcyAqIC13aWR0aCkgKyAncHgnO1xuICAgICAgICBtb3ZlKHBvcywgaW5kZXggPiBwb3MgPyAtd2lkdGggOiAoaW5kZXggPCBwb3MgPyB3aWR0aCA6IDApLCAwKTtcbiAgICAgIH1cblxuICAgIH1cblxuICAgIC8vIHJlcG9zaXRpb24gZWxlbWVudHMgYmVmb3JlIGFuZCBhZnRlciBpbmRleFxuICAgIGlmIChvcHRpb25zLmNvbnRpbnVvdXMgJiYgYnJvd3Nlci50cmFuc2l0aW9ucykge1xuICAgICAgbW92ZShjaXJjbGUoaW5kZXgtMSksIC13aWR0aCwgMCk7XG4gICAgICBtb3ZlKGNpcmNsZShpbmRleCsxKSwgd2lkdGgsIDApO1xuICAgIH1cblxuICAgIGlmICghYnJvd3Nlci50cmFuc2l0aW9ucykgZWxlbWVudC5zdHlsZS5sZWZ0ID0gKGluZGV4ICogLXdpZHRoKSArICdweCc7XG5cbiAgICBjb250YWluZXIuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJztcblxuICB9XG5cbiAgZnVuY3Rpb24gcHJldigpIHtcblxuICAgIGlmIChvcHRpb25zLmNvbnRpbnVvdXMpIHNsaWRlKGluZGV4LTEpO1xuICAgIGVsc2UgaWYgKGluZGV4KSBzbGlkZShpbmRleC0xKTtcblxuICB9XG5cbiAgZnVuY3Rpb24gbmV4dCgpIHtcblxuICAgIGlmIChvcHRpb25zLmNvbnRpbnVvdXMpIHNsaWRlKGluZGV4KzEpO1xuICAgIGVsc2UgaWYgKGluZGV4IDwgc2xpZGVzLmxlbmd0aCAtIDEpIHNsaWRlKGluZGV4KzEpO1xuXG4gIH1cblxuICBmdW5jdGlvbiBjaXJjbGUoaW5kZXgpIHtcblxuICAgIC8vIGEgc2ltcGxlIHBvc2l0aXZlIG1vZHVsbyB1c2luZyBzbGlkZXMubGVuZ3RoXG4gICAgcmV0dXJuIChzbGlkZXMubGVuZ3RoICsgKGluZGV4ICUgc2xpZGVzLmxlbmd0aCkpICUgc2xpZGVzLmxlbmd0aDtcblxuICB9XG5cbiAgZnVuY3Rpb24gc2xpZGUodG8sIHNsaWRlU3BlZWQpIHtcblxuICAgIC8vIGRvIG5vdGhpbmcgaWYgYWxyZWFkeSBvbiByZXF1ZXN0ZWQgc2xpZGVcbiAgICBpZiAoaW5kZXggPT0gdG8pIHJldHVybjtcblxuICAgIGlmIChicm93c2VyLnRyYW5zaXRpb25zKSB7XG5cbiAgICAgIHZhciBkaXJlY3Rpb24gPSBNYXRoLmFicyhpbmRleC10bykgLyAoaW5kZXgtdG8pOyAvLyAxOiBiYWNrd2FyZCwgLTE6IGZvcndhcmRcblxuICAgICAgLy8gZ2V0IHRoZSBhY3R1YWwgcG9zaXRpb24gb2YgdGhlIHNsaWRlXG4gICAgICBpZiAob3B0aW9ucy5jb250aW51b3VzKSB7XG4gICAgICAgIHZhciBuYXR1cmFsX2RpcmVjdGlvbiA9IGRpcmVjdGlvbjtcbiAgICAgICAgZGlyZWN0aW9uID0gLXNsaWRlUG9zW2NpcmNsZSh0byldIC8gd2lkdGg7XG5cbiAgICAgICAgLy8gaWYgZ29pbmcgZm9yd2FyZCBidXQgdG8gPCBpbmRleCwgdXNlIHRvID0gc2xpZGVzLmxlbmd0aCArIHRvXG4gICAgICAgIC8vIGlmIGdvaW5nIGJhY2t3YXJkIGJ1dCB0byA+IGluZGV4LCB1c2UgdG8gPSAtc2xpZGVzLmxlbmd0aCArIHRvXG4gICAgICAgIGlmIChkaXJlY3Rpb24gIT09IG5hdHVyYWxfZGlyZWN0aW9uKSB0byA9ICAtZGlyZWN0aW9uICogc2xpZGVzLmxlbmd0aCArIHRvO1xuXG4gICAgICB9XG5cbiAgICAgIHZhciBkaWZmID0gTWF0aC5hYnMoaW5kZXgtdG8pIC0gMTtcblxuICAgICAgLy8gbW92ZSBhbGwgdGhlIHNsaWRlcyBiZXR3ZWVuIGluZGV4IGFuZCB0byBpbiB0aGUgcmlnaHQgZGlyZWN0aW9uXG4gICAgICB3aGlsZSAoZGlmZi0tKSBtb3ZlKCBjaXJjbGUoKHRvID4gaW5kZXggPyB0byA6IGluZGV4KSAtIGRpZmYgLSAxKSwgd2lkdGggKiBkaXJlY3Rpb24sIDApO1xuXG4gICAgICB0byA9IGNpcmNsZSh0byk7XG5cbiAgICAgIG1vdmUoaW5kZXgsIHdpZHRoICogZGlyZWN0aW9uLCBzbGlkZVNwZWVkIHx8IHNwZWVkKTtcbiAgICAgIG1vdmUodG8sIDAsIHNsaWRlU3BlZWQgfHwgc3BlZWQpO1xuXG4gICAgICBpZiAob3B0aW9ucy5jb250aW51b3VzKSBtb3ZlKGNpcmNsZSh0byAtIGRpcmVjdGlvbiksIC0od2lkdGggKiBkaXJlY3Rpb24pLCAwKTsgLy8gd2UgbmVlZCB0byBnZXQgdGhlIG5leHQgaW4gcGxhY2VcblxuICAgIH0gZWxzZSB7XG5cbiAgICAgIHRvID0gY2lyY2xlKHRvKTtcbiAgICAgIGFuaW1hdGUoaW5kZXggKiAtd2lkdGgsIHRvICogLXdpZHRoLCBzbGlkZVNwZWVkIHx8IHNwZWVkKTtcbiAgICAgIC8vbm8gZmFsbGJhY2sgZm9yIGEgY2lyY3VsYXIgY29udGludW91cyBpZiB0aGUgYnJvd3NlciBkb2VzIG5vdCBhY2NlcHQgdHJhbnNpdGlvbnNcbiAgICB9XG5cbiAgICBpbmRleCA9IHRvO1xuICAgIG9mZmxvYWRGbihvcHRpb25zLmNhbGxiYWNrICYmIG9wdGlvbnMuY2FsbGJhY2soaW5kZXgsIHNsaWRlc1tpbmRleF0pKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG1vdmUoaW5kZXgsIGRpc3QsIHNwZWVkKSB7XG5cbiAgICB0cmFuc2xhdGUoaW5kZXgsIGRpc3QsIHNwZWVkKTtcbiAgICBzbGlkZVBvc1tpbmRleF0gPSBkaXN0O1xuXG4gIH1cblxuICBmdW5jdGlvbiB0cmFuc2xhdGUoaW5kZXgsIGRpc3QsIHNwZWVkKSB7XG5cbiAgICB2YXIgc2xpZGUgPSBzbGlkZXNbaW5kZXhdO1xuICAgIHZhciBzdHlsZSA9IHNsaWRlICYmIHNsaWRlLnN0eWxlO1xuXG4gICAgaWYgKCFzdHlsZSkgcmV0dXJuO1xuXG4gICAgc3R5bGUud2Via2l0VHJhbnNpdGlvbkR1cmF0aW9uID1cbiAgICBzdHlsZS5Nb3pUcmFuc2l0aW9uRHVyYXRpb24gPVxuICAgIHN0eWxlLm1zVHJhbnNpdGlvbkR1cmF0aW9uID1cbiAgICBzdHlsZS5PVHJhbnNpdGlvbkR1cmF0aW9uID1cbiAgICBzdHlsZS50cmFuc2l0aW9uRHVyYXRpb24gPSBzcGVlZCArICdtcyc7XG5cbiAgICBzdHlsZS53ZWJraXRUcmFuc2Zvcm0gPSAndHJhbnNsYXRlKCcgKyBkaXN0ICsgJ3B4LDApJyArICd0cmFuc2xhdGVaKDApJztcbiAgICBzdHlsZS5tc1RyYW5zZm9ybSA9XG4gICAgc3R5bGUuTW96VHJhbnNmb3JtID1cbiAgICBzdHlsZS5PVHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVgoJyArIGRpc3QgKyAncHgpJztcblxuICB9XG5cbiAgZnVuY3Rpb24gYW5pbWF0ZShmcm9tLCB0bywgc3BlZWQpIHtcblxuICAgIC8vIGlmIG5vdCBhbiBhbmltYXRpb24sIGp1c3QgcmVwb3NpdGlvblxuICAgIGlmICghc3BlZWQpIHtcblxuICAgICAgZWxlbWVudC5zdHlsZS5sZWZ0ID0gdG8gKyAncHgnO1xuICAgICAgcmV0dXJuO1xuXG4gICAgfVxuXG4gICAgdmFyIHN0YXJ0ID0gK25ldyBEYXRlO1xuXG4gICAgdmFyIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG5cbiAgICAgIHZhciB0aW1lRWxhcCA9ICtuZXcgRGF0ZSAtIHN0YXJ0O1xuXG4gICAgICBpZiAodGltZUVsYXAgPiBzcGVlZCkge1xuXG4gICAgICAgIGVsZW1lbnQuc3R5bGUubGVmdCA9IHRvICsgJ3B4JztcblxuICAgICAgICBpZiAoZGVsYXkpIGJlZ2luKCk7XG5cbiAgICAgICAgb3B0aW9ucy50cmFuc2l0aW9uRW5kICYmIG9wdGlvbnMudHJhbnNpdGlvbkVuZC5jYWxsKGV2ZW50LCBpbmRleCwgc2xpZGVzW2luZGV4XSk7XG5cbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcik7XG4gICAgICAgIHJldHVybjtcblxuICAgICAgfVxuXG4gICAgICBlbGVtZW50LnN0eWxlLmxlZnQgPSAoKCAodG8gLSBmcm9tKSAqIChNYXRoLmZsb29yKCh0aW1lRWxhcCAvIHNwZWVkKSAqIDEwMCkgLyAxMDApICkgKyBmcm9tKSArICdweCc7XG5cbiAgICB9LCA0KTtcblxuICB9XG5cbiAgLy8gc2V0dXAgYXV0byBzbGlkZXNob3dcbiAgdmFyIGRlbGF5ID0gb3B0aW9ucy5hdXRvIHx8IDA7XG4gIHZhciBpbnRlcnZhbDtcblxuICBmdW5jdGlvbiBiZWdpbigpIHtcblxuICAgIGludGVydmFsID0gc2V0VGltZW91dChuZXh0LCBkZWxheSk7XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIHN0b3AoKSB7XG5cbiAgICBkZWxheSA9IDA7XG4gICAgY2xlYXJUaW1lb3V0KGludGVydmFsKTtcblxuICB9XG5cblxuICAvLyBzZXR1cCBpbml0aWFsIHZhcnNcbiAgdmFyIHN0YXJ0ID0ge307XG4gIHZhciBkZWx0YSA9IHt9O1xuICB2YXIgaXNTY3JvbGxpbmc7XG5cbiAgLy8gc2V0dXAgZXZlbnQgY2FwdHVyaW5nXG4gIHZhciBldmVudHMgPSB7XG5cbiAgICBoYW5kbGVFdmVudDogZnVuY3Rpb24oZXZlbnQpIHtcblxuICAgICAgc3dpdGNoIChldmVudC50eXBlKSB7XG4gICAgICAgIGNhc2UgJ3RvdWNoc3RhcnQnOiB0aGlzLnN0YXJ0KGV2ZW50KTsgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3RvdWNobW92ZSc6IHRoaXMubW92ZShldmVudCk7IGJyZWFrO1xuICAgICAgICBjYXNlICd0b3VjaGVuZCc6IG9mZmxvYWRGbih0aGlzLmVuZChldmVudCkpOyBicmVhaztcbiAgICAgICAgY2FzZSAnd2Via2l0VHJhbnNpdGlvbkVuZCc6XG4gICAgICAgIGNhc2UgJ21zVHJhbnNpdGlvbkVuZCc6XG4gICAgICAgIGNhc2UgJ29UcmFuc2l0aW9uRW5kJzpcbiAgICAgICAgY2FzZSAnb3RyYW5zaXRpb25lbmQnOlxuICAgICAgICBjYXNlICd0cmFuc2l0aW9uZW5kJzogb2ZmbG9hZEZuKHRoaXMudHJhbnNpdGlvbkVuZChldmVudCkpOyBicmVhaztcbiAgICAgICAgY2FzZSAncmVzaXplJzogb2ZmbG9hZEZuKHNldHVwKTsgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRpb25zLnN0b3BQcm9wYWdhdGlvbikgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICB9LFxuICAgIHN0YXJ0OiBmdW5jdGlvbihldmVudCkge1xuXG4gICAgICB2YXIgdG91Y2hlcyA9IGV2ZW50LnRvdWNoZXNbMF07XG5cbiAgICAgIC8vIG1lYXN1cmUgc3RhcnQgdmFsdWVzXG4gICAgICBzdGFydCA9IHtcblxuICAgICAgICAvLyBnZXQgaW5pdGlhbCB0b3VjaCBjb29yZHNcbiAgICAgICAgeDogdG91Y2hlcy5wYWdlWCxcbiAgICAgICAgeTogdG91Y2hlcy5wYWdlWSxcblxuICAgICAgICAvLyBzdG9yZSB0aW1lIHRvIGRldGVybWluZSB0b3VjaCBkdXJhdGlvblxuICAgICAgICB0aW1lOiArbmV3IERhdGVcblxuICAgICAgfTtcblxuICAgICAgLy8gdXNlZCBmb3IgdGVzdGluZyBmaXJzdCBtb3ZlIGV2ZW50XG4gICAgICBpc1Njcm9sbGluZyA9IHVuZGVmaW5lZDtcblxuICAgICAgLy8gcmVzZXQgZGVsdGEgYW5kIGVuZCBtZWFzdXJlbWVudHNcbiAgICAgIGRlbHRhID0ge307XG5cbiAgICAgIC8vIGF0dGFjaCB0b3VjaG1vdmUgYW5kIHRvdWNoZW5kIGxpc3RlbmVyc1xuICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCB0aGlzLCBmYWxzZSk7XG4gICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdGhpcywgZmFsc2UpO1xuXG4gICAgfSxcbiAgICBtb3ZlOiBmdW5jdGlvbihldmVudCkge1xuXG4gICAgICAvLyBlbnN1cmUgc3dpcGluZyB3aXRoIG9uZSB0b3VjaCBhbmQgbm90IHBpbmNoaW5nXG4gICAgICBpZiAoIGV2ZW50LnRvdWNoZXMubGVuZ3RoID4gMSB8fCBldmVudC5zY2FsZSAmJiBldmVudC5zY2FsZSAhPT0gMSkgcmV0dXJuXG5cbiAgICAgIGlmIChvcHRpb25zLmRpc2FibGVTY3JvbGwpIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgIHZhciB0b3VjaGVzID0gZXZlbnQudG91Y2hlc1swXTtcblxuICAgICAgLy8gbWVhc3VyZSBjaGFuZ2UgaW4geCBhbmQgeVxuICAgICAgZGVsdGEgPSB7XG4gICAgICAgIHg6IHRvdWNoZXMucGFnZVggLSBzdGFydC54LFxuICAgICAgICB5OiB0b3VjaGVzLnBhZ2VZIC0gc3RhcnQueVxuICAgICAgfVxuXG4gICAgICAvLyBkZXRlcm1pbmUgaWYgc2Nyb2xsaW5nIHRlc3QgaGFzIHJ1biAtIG9uZSB0aW1lIHRlc3RcbiAgICAgIGlmICggdHlwZW9mIGlzU2Nyb2xsaW5nID09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIGlzU2Nyb2xsaW5nID0gISEoIGlzU2Nyb2xsaW5nIHx8IE1hdGguYWJzKGRlbHRhLngpIDwgTWF0aC5hYnMoZGVsdGEueSkgKTtcbiAgICAgIH1cblxuICAgICAgLy8gaWYgdXNlciBpcyBub3QgdHJ5aW5nIHRvIHNjcm9sbCB2ZXJ0aWNhbGx5XG4gICAgICBpZiAoIWlzU2Nyb2xsaW5nKSB7XG5cbiAgICAgICAgLy8gcHJldmVudCBuYXRpdmUgc2Nyb2xsaW5nXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgLy8gc3RvcCBzbGlkZXNob3dcbiAgICAgICAgc3RvcCgpO1xuXG4gICAgICAgIC8vIGluY3JlYXNlIHJlc2lzdGFuY2UgaWYgZmlyc3Qgb3IgbGFzdCBzbGlkZVxuICAgICAgICBpZiAob3B0aW9ucy5jb250aW51b3VzKSB7IC8vIHdlIGRvbid0IGFkZCByZXNpc3RhbmNlIGF0IHRoZSBlbmRcblxuICAgICAgICAgIHRyYW5zbGF0ZShjaXJjbGUoaW5kZXgtMSksIGRlbHRhLnggKyBzbGlkZVBvc1tjaXJjbGUoaW5kZXgtMSldLCAwKTtcbiAgICAgICAgICB0cmFuc2xhdGUoaW5kZXgsIGRlbHRhLnggKyBzbGlkZVBvc1tpbmRleF0sIDApO1xuICAgICAgICAgIHRyYW5zbGF0ZShjaXJjbGUoaW5kZXgrMSksIGRlbHRhLnggKyBzbGlkZVBvc1tjaXJjbGUoaW5kZXgrMSldLCAwKTtcblxuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgZGVsdGEueCA9XG4gICAgICAgICAgICBkZWx0YS54IC9cbiAgICAgICAgICAgICAgKCAoIWluZGV4ICYmIGRlbHRhLnggPiAwICAgICAgICAgICAgICAgLy8gaWYgZmlyc3Qgc2xpZGUgYW5kIHNsaWRpbmcgbGVmdFxuICAgICAgICAgICAgICAgIHx8IGluZGV4ID09IHNsaWRlcy5sZW5ndGggLSAxICAgICAgICAvLyBvciBpZiBsYXN0IHNsaWRlIGFuZCBzbGlkaW5nIHJpZ2h0XG4gICAgICAgICAgICAgICAgJiYgZGVsdGEueCA8IDAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFuZCBpZiBzbGlkaW5nIGF0IGFsbFxuICAgICAgICAgICAgICApID9cbiAgICAgICAgICAgICAgKCBNYXRoLmFicyhkZWx0YS54KSAvIHdpZHRoICsgMSApICAgICAgLy8gZGV0ZXJtaW5lIHJlc2lzdGFuY2UgbGV2ZWxcbiAgICAgICAgICAgICAgOiAxICk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm8gcmVzaXN0YW5jZSBpZiBmYWxzZVxuXG4gICAgICAgICAgLy8gdHJhbnNsYXRlIDE6MVxuICAgICAgICAgIHRyYW5zbGF0ZShpbmRleC0xLCBkZWx0YS54ICsgc2xpZGVQb3NbaW5kZXgtMV0sIDApO1xuICAgICAgICAgIHRyYW5zbGF0ZShpbmRleCwgZGVsdGEueCArIHNsaWRlUG9zW2luZGV4XSwgMCk7XG4gICAgICAgICAgdHJhbnNsYXRlKGluZGV4KzEsIGRlbHRhLnggKyBzbGlkZVBvc1tpbmRleCsxXSwgMCk7XG4gICAgICAgIH1cblxuICAgICAgfVxuXG4gICAgfSxcbiAgICBlbmQ6IGZ1bmN0aW9uKGV2ZW50KSB7XG5cbiAgICAgIC8vIG1lYXN1cmUgZHVyYXRpb25cbiAgICAgIHZhciBkdXJhdGlvbiA9ICtuZXcgRGF0ZSAtIHN0YXJ0LnRpbWU7XG5cbiAgICAgIC8vIGRldGVybWluZSBpZiBzbGlkZSBhdHRlbXB0IHRyaWdnZXJzIG5leHQvcHJldiBzbGlkZVxuICAgICAgdmFyIGlzVmFsaWRTbGlkZSA9XG4gICAgICAgICAgICBOdW1iZXIoZHVyYXRpb24pIDwgMjUwICAgICAgICAgICAgICAgLy8gaWYgc2xpZGUgZHVyYXRpb24gaXMgbGVzcyB0aGFuIDI1MG1zXG4gICAgICAgICAgICAmJiBNYXRoLmFicyhkZWx0YS54KSA+IDIwICAgICAgICAgICAgLy8gYW5kIGlmIHNsaWRlIGFtdCBpcyBncmVhdGVyIHRoYW4gMjBweFxuICAgICAgICAgICAgfHwgTWF0aC5hYnMoZGVsdGEueCkgPiB3aWR0aC8yOyAgICAgIC8vIG9yIGlmIHNsaWRlIGFtdCBpcyBncmVhdGVyIHRoYW4gaGFsZiB0aGUgd2lkdGhcblxuICAgICAgLy8gZGV0ZXJtaW5lIGlmIHNsaWRlIGF0dGVtcHQgaXMgcGFzdCBzdGFydCBhbmQgZW5kXG4gICAgICB2YXIgaXNQYXN0Qm91bmRzID1cbiAgICAgICAgICAgICFpbmRleCAmJiBkZWx0YS54ID4gMCAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiBmaXJzdCBzbGlkZSBhbmQgc2xpZGUgYW10IGlzIGdyZWF0ZXIgdGhhbiAwXG4gICAgICAgICAgICB8fCBpbmRleCA9PSBzbGlkZXMubGVuZ3RoIC0gMSAmJiBkZWx0YS54IDwgMDsgICAgLy8gb3IgaWYgbGFzdCBzbGlkZSBhbmQgc2xpZGUgYW10IGlzIGxlc3MgdGhhbiAwXG5cbiAgICAgIGlmIChvcHRpb25zLmNvbnRpbnVvdXMpIGlzUGFzdEJvdW5kcyA9IGZhbHNlO1xuXG4gICAgICAvLyBkZXRlcm1pbmUgZGlyZWN0aW9uIG9mIHN3aXBlICh0cnVlOnJpZ2h0LCBmYWxzZTpsZWZ0KVxuICAgICAgdmFyIGRpcmVjdGlvbiA9IGRlbHRhLnggPCAwO1xuXG4gICAgICAvLyBpZiBub3Qgc2Nyb2xsaW5nIHZlcnRpY2FsbHlcbiAgICAgIGlmICghaXNTY3JvbGxpbmcpIHtcblxuICAgICAgICBpZiAoaXNWYWxpZFNsaWRlICYmICFpc1Bhc3RCb3VuZHMpIHtcblxuICAgICAgICAgIGlmIChkaXJlY3Rpb24pIHtcblxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuY29udGludW91cykgeyAvLyB3ZSBuZWVkIHRvIGdldCB0aGUgbmV4dCBpbiB0aGlzIGRpcmVjdGlvbiBpbiBwbGFjZVxuXG4gICAgICAgICAgICAgIG1vdmUoY2lyY2xlKGluZGV4LTEpLCAtd2lkdGgsIDApO1xuICAgICAgICAgICAgICBtb3ZlKGNpcmNsZShpbmRleCsyKSwgd2lkdGgsIDApO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBtb3ZlKGluZGV4LTEsIC13aWR0aCwgMCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG1vdmUoaW5kZXgsIHNsaWRlUG9zW2luZGV4XS13aWR0aCwgc3BlZWQpO1xuICAgICAgICAgICAgbW92ZShjaXJjbGUoaW5kZXgrMSksIHNsaWRlUG9zW2NpcmNsZShpbmRleCsxKV0td2lkdGgsIHNwZWVkKTtcbiAgICAgICAgICAgIGluZGV4ID0gY2lyY2xlKGluZGV4KzEpO1xuXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmNvbnRpbnVvdXMpIHsgLy8gd2UgbmVlZCB0byBnZXQgdGhlIG5leHQgaW4gdGhpcyBkaXJlY3Rpb24gaW4gcGxhY2VcblxuICAgICAgICAgICAgICBtb3ZlKGNpcmNsZShpbmRleCsxKSwgd2lkdGgsIDApO1xuICAgICAgICAgICAgICBtb3ZlKGNpcmNsZShpbmRleC0yKSwgLXdpZHRoLCAwKTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgbW92ZShpbmRleCsxLCB3aWR0aCwgMCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG1vdmUoaW5kZXgsIHNsaWRlUG9zW2luZGV4XSt3aWR0aCwgc3BlZWQpO1xuICAgICAgICAgICAgbW92ZShjaXJjbGUoaW5kZXgtMSksIHNsaWRlUG9zW2NpcmNsZShpbmRleC0xKV0rd2lkdGgsIHNwZWVkKTtcbiAgICAgICAgICAgIGluZGV4ID0gY2lyY2xlKGluZGV4LTEpO1xuXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgb3B0aW9ucy5jYWxsYmFjayAmJiBvcHRpb25zLmNhbGxiYWNrKGluZGV4LCBzbGlkZXNbaW5kZXhdKTtcblxuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgaWYgKG9wdGlvbnMuY29udGludW91cykge1xuXG4gICAgICAgICAgICBtb3ZlKGNpcmNsZShpbmRleC0xKSwgLXdpZHRoLCBzcGVlZCk7XG4gICAgICAgICAgICBtb3ZlKGluZGV4LCAwLCBzcGVlZCk7XG4gICAgICAgICAgICBtb3ZlKGNpcmNsZShpbmRleCsxKSwgd2lkdGgsIHNwZWVkKTtcblxuICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgIG1vdmUoaW5kZXgtMSwgLXdpZHRoLCBzcGVlZCk7XG4gICAgICAgICAgICBtb3ZlKGluZGV4LCAwLCBzcGVlZCk7XG4gICAgICAgICAgICBtb3ZlKGluZGV4KzEsIHdpZHRoLCBzcGVlZCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgICAgfVxuXG4gICAgICAvLyBraWxsIHRvdWNobW92ZSBhbmQgdG91Y2hlbmQgZXZlbnQgbGlzdGVuZXJzIHVudGlsIHRvdWNoc3RhcnQgY2FsbGVkIGFnYWluXG4gICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIGV2ZW50cywgZmFsc2UpXG4gICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgZXZlbnRzLCBmYWxzZSlcblxuICAgIH0sXG4gICAgdHJhbnNpdGlvbkVuZDogZnVuY3Rpb24oZXZlbnQpIHtcblxuICAgICAgaWYgKHBhcnNlSW50KGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaW5kZXgnKSwgMTApID09IGluZGV4KSB7XG5cbiAgICAgICAgaWYgKGRlbGF5KSBiZWdpbigpO1xuXG4gICAgICAgIG9wdGlvbnMudHJhbnNpdGlvbkVuZCAmJiBvcHRpb25zLnRyYW5zaXRpb25FbmQuY2FsbChldmVudCwgaW5kZXgsIHNsaWRlc1tpbmRleF0pO1xuXG4gICAgICB9XG5cbiAgICB9XG5cbiAgfVxuXG4gIC8vIHRyaWdnZXIgc2V0dXBcbiAgc2V0dXAoKTtcblxuICAvLyBzdGFydCBhdXRvIHNsaWRlc2hvdyBpZiBhcHBsaWNhYmxlXG4gIGlmIChkZWxheSkgYmVnaW4oKTtcblxuXG4gIC8vIGFkZCBldmVudCBsaXN0ZW5lcnNcbiAgaWYgKGJyb3dzZXIuYWRkRXZlbnRMaXN0ZW5lcikge1xuXG4gICAgLy8gc2V0IHRvdWNoc3RhcnQgZXZlbnQgb24gZWxlbWVudFxuICAgIGlmIChicm93c2VyLnRvdWNoKSBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBldmVudHMsIGZhbHNlKTtcblxuICAgIGlmIChicm93c2VyLnRyYW5zaXRpb25zKSB7XG4gICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3dlYmtpdFRyYW5zaXRpb25FbmQnLCBldmVudHMsIGZhbHNlKTtcbiAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbXNUcmFuc2l0aW9uRW5kJywgZXZlbnRzLCBmYWxzZSk7XG4gICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ29UcmFuc2l0aW9uRW5kJywgZXZlbnRzLCBmYWxzZSk7XG4gICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ290cmFuc2l0aW9uZW5kJywgZXZlbnRzLCBmYWxzZSk7XG4gICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RyYW5zaXRpb25lbmQnLCBldmVudHMsIGZhbHNlKTtcbiAgICB9XG5cbiAgICAvLyBzZXQgcmVzaXplIGV2ZW50IG9uIHdpbmRvd1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBldmVudHMsIGZhbHNlKTtcblxuICB9IGVsc2Uge1xuXG4gICAgd2luZG93Lm9ucmVzaXplID0gZnVuY3Rpb24gKCkgeyBzZXR1cCgpIH07IC8vIHRvIHBsYXkgbmljZSB3aXRoIG9sZCBJRVxuXG4gIH1cblxuICAvLyBleHBvc2UgdGhlIFN3aXBlIEFQSVxuICByZXR1cm4ge1xuICAgIHNldHVwOiBmdW5jdGlvbigpIHtcblxuICAgICAgc2V0dXAoKTtcblxuICAgIH0sXG4gICAgc2xpZGU6IGZ1bmN0aW9uKHRvLCBzcGVlZCkge1xuXG4gICAgICAvLyBjYW5jZWwgc2xpZGVzaG93XG4gICAgICBzdG9wKCk7XG5cbiAgICAgIHNsaWRlKHRvLCBzcGVlZCk7XG5cbiAgICB9LFxuICAgIHByZXY6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAvLyBjYW5jZWwgc2xpZGVzaG93XG4gICAgICBzdG9wKCk7XG5cbiAgICAgIHByZXYoKTtcblxuICAgIH0sXG4gICAgbmV4dDogZnVuY3Rpb24oKSB7XG5cbiAgICAgIC8vIGNhbmNlbCBzbGlkZXNob3dcbiAgICAgIHN0b3AoKTtcblxuICAgICAgbmV4dCgpO1xuXG4gICAgfSxcbiAgICBzdG9wOiBmdW5jdGlvbigpIHtcblxuICAgICAgLy8gY2FuY2VsIHNsaWRlc2hvd1xuICAgICAgc3RvcCgpO1xuXG4gICAgfSxcbiAgICBnZXRQb3M6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAvLyByZXR1cm4gY3VycmVudCBpbmRleCBwb3NpdGlvblxuICAgICAgcmV0dXJuIGluZGV4O1xuXG4gICAgfSxcbiAgICBnZXROdW1TbGlkZXM6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAvLyByZXR1cm4gdG90YWwgbnVtYmVyIG9mIHNsaWRlc1xuICAgICAgcmV0dXJuIGxlbmd0aDtcbiAgICB9LFxuICAgIGtpbGw6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAvLyBjYW5jZWwgc2xpZGVzaG93XG4gICAgICBzdG9wKCk7XG5cbiAgICAgIC8vIHJlc2V0IGVsZW1lbnRcbiAgICAgIGVsZW1lbnQuc3R5bGUud2lkdGggPSAnJztcbiAgICAgIGVsZW1lbnQuc3R5bGUubGVmdCA9ICcnO1xuXG4gICAgICAvLyByZXNldCBzbGlkZXNcbiAgICAgIHZhciBwb3MgPSBzbGlkZXMubGVuZ3RoO1xuICAgICAgd2hpbGUocG9zLS0pIHtcblxuICAgICAgICB2YXIgc2xpZGUgPSBzbGlkZXNbcG9zXTtcbiAgICAgICAgc2xpZGUuc3R5bGUud2lkdGggPSAnJztcbiAgICAgICAgc2xpZGUuc3R5bGUubGVmdCA9ICcnO1xuXG4gICAgICAgIGlmIChicm93c2VyLnRyYW5zaXRpb25zKSB0cmFuc2xhdGUocG9zLCAwLCAwKTtcblxuICAgICAgfVxuXG4gICAgICAvLyByZW1vdmVkIGV2ZW50IGxpc3RlbmVyc1xuICAgICAgaWYgKGJyb3dzZXIuYWRkRXZlbnRMaXN0ZW5lcikge1xuXG4gICAgICAgIC8vIHJlbW92ZSBjdXJyZW50IGV2ZW50IGxpc3RlbmVyc1xuICAgICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBldmVudHMsIGZhbHNlKTtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd3ZWJraXRUcmFuc2l0aW9uRW5kJywgZXZlbnRzLCBmYWxzZSk7XG4gICAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbXNUcmFuc2l0aW9uRW5kJywgZXZlbnRzLCBmYWxzZSk7XG4gICAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignb1RyYW5zaXRpb25FbmQnLCBldmVudHMsIGZhbHNlKTtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdvdHJhbnNpdGlvbmVuZCcsIGV2ZW50cywgZmFsc2UpO1xuICAgICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RyYW5zaXRpb25lbmQnLCBldmVudHMsIGZhbHNlKTtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGV2ZW50cywgZmFsc2UpO1xuXG4gICAgICB9XG4gICAgICBlbHNlIHtcblxuICAgICAgICB3aW5kb3cub25yZXNpemUgPSBudWxsO1xuXG4gICAgICB9XG5cbiAgICB9XG4gIH1cblxufVxuXG5cbmlmICggd2luZG93LmpRdWVyeSB8fCB3aW5kb3cuWmVwdG8gKSB7XG4gIChmdW5jdGlvbigkKSB7XG4gICAgJC5mbi5Td2lwZSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgJCh0aGlzKS5kYXRhKCdTd2lwZScsIG5ldyBTd2lwZSgkKHRoaXMpWzBdLCBwYXJhbXMpKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSkoIHdpbmRvdy5qUXVlcnkgfHwgd2luZG93LlplcHRvIClcbn1cbiIsImZ1bmN0aW9uIGRpc3RhbmNlT2ZUaW1lSW5Xb3Jkcyhmcm9tVGltZSwgdG9UaW1lLCBpbmNsdWRlU2Vjb25kcykge1xuICB2YXIgZnJvbVNlY29uZHMgPSBmcm9tVGltZS5nZXRUaW1lKCk7XG4gIHZhciB0b1NlY29uZHMgPSB0b1RpbWUuZ2V0VGltZSgpO1xuICB2YXIgZGlzdGFuY2VJblNlY29uZHMgPSBNYXRoLnJvdW5kKE1hdGguYWJzKGZyb21TZWNvbmRzIC0gdG9TZWNvbmRzKSAvIDEwMDApO1xuICB2YXIgZGlzdGFuY2VJbk1pbnV0ZXMgPSBNYXRoLnJvdW5kKGRpc3RhbmNlSW5TZWNvbmRzIC8gNjApO1xuICBpZiAoZGlzdGFuY2VJbk1pbnV0ZXMgPD0gMSkge1xuICAgIGlmICghaW5jbHVkZVNlY29uZHMpXG4gICAgICByZXR1cm4gKGRpc3RhbmNlSW5NaW51dGVzID09PSAwKSA/ICdtaW5kZXIgZGFuIGVlbiBtaW51dXQnIDogJzEgbWludXV0JztcbiAgICBpZiAoZGlzdGFuY2VJblNlY29uZHMgPCA1KVxuICAgICAgcmV0dXJuICc1IHNlY29uZGUgZ2VsZWRlbic7XG4gICAgaWYgKGRpc3RhbmNlSW5TZWNvbmRzIDwgMTApXG4gICAgICByZXR1cm4gJzEwIHNlY29uZGUgZ2VsZWRlbic7XG4gICAgaWYgKGRpc3RhbmNlSW5TZWNvbmRzIDwgMjApXG4gICAgICByZXR1cm4gJzIwIHNlY29uZGUgZ2VsZWRlbic7XG4gICAgaWYgKGRpc3RhbmNlSW5TZWNvbmRzIDwgNDApXG4gICAgICByZXR1cm4gJzMwIHNlY29uZGUgZ2VsZWRlbic7XG4gICAgaWYgKGRpc3RhbmNlSW5TZWNvbmRzIDwgNjApXG4gICAgICByZXR1cm4gJ2VlbiBtaW51dXQgZ2VsZWRlbic7XG4gICAgZWxzZVxuICAgICAgcmV0dXJuICcxIG1pbnV1dCBnZWxlZGVuJztcbiAgfVxuXG4gIGlmIChkaXN0YW5jZUluTWludXRlcyA8IDQ1KVxuICAgIHJldHVybiBkaXN0YW5jZUluTWludXRlcyArICcgbWludXRlbiBnZWxlZGVuJztcbiAgaWYgKGRpc3RhbmNlSW5NaW51dGVzIDwgNzApXG4gICAgcmV0dXJuICcxIHV1ciBnZWxlZGVuJztcbiAgaWYgKGRpc3RhbmNlSW5NaW51dGVzIDwgMTQ0MClcbiAgICByZXR1cm4gKE1hdGgucm91bmQoZGlzdGFuY2VJbk1pbnV0ZXMgLyA2MCkpICsgJyB1dXIgZ2VsZWRlbic7XG4gIGlmIChkaXN0YW5jZUluTWludXRlcyA8IDI4ODApXG4gICAgcmV0dXJuICcxIGRhZyBnZWxlZGVuJztcbiAgaWYgKGRpc3RhbmNlSW5NaW51dGVzIDwgNDMyMDApXG4gICAgcmV0dXJuIChNYXRoLnJvdW5kKGRpc3RhbmNlSW5NaW51dGVzIC8gMTQ0MCkpICsgJyBkYWdlbiBnZWxlZGVuJztcbiAgaWYgKGRpc3RhbmNlSW5NaW51dGVzIDwgODY0MDApXG4gICAgcmV0dXJuICdydWltIDEgbWFhbmQgZ2VsZWRlbic7XG4gIGlmIChkaXN0YW5jZUluTWludXRlcyA8IDUyNTYwMClcbiAgICByZXR1cm4gKE1hdGgucm91bmQoZGlzdGFuY2VJbk1pbnV0ZXMgLyA0MzIwMCkpICsgJyBtYWFuZGVuIGdlbGVkZW4nO1xuICBlbHNlXG4gICAgcmV0dXJuIChNYXRoLnJvdW5kKGRpc3RhbmNlSW5NaW51dGVzIC8gNTI1NjAwKSkgKyAnIGphcmVuIGdlbGVkZW4nO1xufVxuXG4vL1R3aXR0ZXIgUGFyc2Vyc1xuU3RyaW5nLnByb3RvdHlwZS5wYXJzZVVSTCA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHRoaXMucmVwbGFjZSgvW0EtWmEtel0rOlxcL1xcL1tBLVphLXowLTktX10rXFwuW0EtWmEtejAtOS1fOiUmflxcP1xcLy49XSsvZywgZnVuY3Rpb24gKHVybCkge1xuICAgIHJldHVybiB1cmwubGluayh1cmwpO1xuICB9KTtcbn07XG5cblN0cmluZy5wcm90b3R5cGUucGFyc2VVc2VybmFtZSA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHRoaXMucmVwbGFjZSgvW0BdK1tBLVphLXowLTktX10rL2csIGZ1bmN0aW9uICh1KSB7XG4gICAgdmFyIHVzZXJuYW1lID0gdS5yZXBsYWNlKCdAJywgJycpO1xuICAgIHJldHVybiB1LmxpbmsoJ2h0dHBzOi8vdHdpdHRlci5jb20vJyArIHVzZXJuYW1lKTtcbiAgfSk7XG59O1xuXG5TdHJpbmcucHJvdG90eXBlLnBhcnNlSGFzaHRhZyA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHRoaXMucmVwbGFjZSgvWyNdK1tBLVphLXowLTktX10rL2csIGZ1bmN0aW9uICh0KSB7XG4gICAgdmFyIHRhZyA9IHQucmVwbGFjZSgnIycsICclMjMnKTtcbiAgICByZXR1cm4gdC5saW5rKCdodHRwczovL3R3aXR0ZXIuY29tL3NlYXJjaD9xPScgKyB0YWcpO1xuICB9KTtcbn07XG5cblN0cmluZy5wcm90b3R5cGUucGFyc2VEYXRlID0gZnVuY3Rpb24gKCkge1xuICB2YXIgbmV3dGV4dCA9IHRoaXMucmVwbGFjZSgvKFxcK1xcUyspICguKikvLCAnJDIgJDEnKTtcbiAgdmFyIGRhdGUgPSBuZXcgRGF0ZShEYXRlLnBhcnNlKG5ld3RleHQpKTtcbiAgcmV0dXJuIGRhdGU7XG59O1xuXG5mdW5jdGlvbiBwcm9jZXNzVHdlZXRzKGRhdGEsIHVuaXF1ZSkge1xuICB2YXIgdHdlZXRzID0gW107XG4gICQuZWFjaChkYXRhLCBmdW5jdGlvbiAoaSwgb2JqKSB7XG4gICAgdmFyIGVsZW1lbnQgPSBvYmo7XG4gICAgZWxlbWVudC50ZXh0ID0gb2JqLnRleHQucGFyc2VVUkwoKS5wYXJzZVVzZXJuYW1lKCkucGFyc2VIYXNodGFnKCk7XG4gICAgdmFyIGNyZWF0ZWQgPSBvYmouY3JlYXRlZC5wYXJzZURhdGUoKTtcbiAgICBkZWxldGUgZWxlbWVudC5jcmVhdGVkO1xuICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIGVsZW1lbnQuZGF0ZSA9IGRpc3RhbmNlT2ZUaW1lSW5Xb3Jkcyhub3csIGNyZWF0ZWQsIHRydWUpICsgJyBnZXBsYWF0c3QnO1xuICAgIGVsZW1lbnQudHdlZXRVcmwgPSAnaHR0cHM6Ly90d2l0dGVyLmNvbS8tL3N0YXR1cy8nICsgb2JqLnR3ZWV0SWQ7XG4gICAgZWxlbWVudC5yZXR3ZWV0VXJsID0gJ2h0dHBzOi8vdHdpdHRlci5jb20vaW50ZW50L3JldHdlZXQ/dHdlZXRfaWQ9JyArIG9iai50d2VldElkO1xuICAgIGVsZW1lbnQucmVwbHlVcmwgPSAnaHR0cHM6Ly90d2l0dGVyLmNvbS9pbnRlbnQvdHdlZXQ/aW5fcmVwbHlfdG89JyArIG9iai50d2VldElkO1xuICAgIGVsZW1lbnQubGlrZVVybCA9ICdodHRwczovL3R3aXR0ZXIuY29tL2ludGVudC9saWtlP3R3ZWV0X2lkPScgKyBvYmoudHdlZXRJZDtcbiAgICBlbGVtZW50LmZvbGxvd1VybCA9ICdodHRwczovL3R3aXR0ZXIuY29tL2ludGVudC9mb2xsb3c/c2NyZWVuX25hbWU9JyArIG9iai5zY3JlZW5OYW1lO1xuICAgIHR3ZWV0cy5wdXNoKGVsZW1lbnQpO1xuICB9KTtcblxuICByZXR1cm4gdHdlZXRzO1xufVxuIiwiKGZ1bmN0aW9uICgpIHtcblxuICAvLyBhcHAgbmFtZXNwYWNlIHNldHVwXG4gIEFQUCA9IHtcbiAgICBWaWV3czoge30sXG4gIH07XG5cbn0pKCk7XG4iLCIvLyBmb3IganNoaW50XG4vKmdsb2JhbCByZXF1aXJlLCBkZWZpbmUgKi9cblxuKGZ1bmN0aW9uKHJvb3QsIGZhY3RvcnkpIHtcbiAgLy8gU3RhcnQgd2l0aCBBTUQgc3VwcG9ydC5cbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIGRlZmluZShbJ3VuZGVyc2NvcmUnLCAnYmFja2JvbmUnXSwgZnVuY3Rpb24oXywgQmFja2JvbmUpIHtcbiAgICAgIGZhY3Rvcnkocm9vdCwgXywgQmFja2JvbmUpO1xuICAgIH0pO1xuXG4gIC8vIE5leHQgY2hlY2sgZm9yIE5vZGUuanMgb3IgQ29tbW9uSlMuXG4gIH0gZWxzZSBpZiAodHlwZW9mIGV4cG9ydHMgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgdmFyIF8gPSByZXF1aXJlKCd1bmRlcnNjb3JlJyk7XG4gICAgdmFyIEJhY2tib25lID0gcmVxdWlyZSgnYmFja2JvbmUnKTtcbiAgICBmYWN0b3J5KHJvb3QsIF8sIEJhY2tib25lKTtcblxuICAvLyBGaW5uYWx5LCBpZiBub25lIG9mIHRoZSBhYm92ZSwgY3JlYXRlIHRoZSBleHRlbnNpb24gYW5kXG4gIC8vIGFzc3VtZSBCYWNrYm9uZSBpcyBhdmFpbGFibGUgYXQgKGJyb3dzZXIpIGdsb2JhbCBzY29wZS5cbiAgfSBlbHNlIHtcbiAgICBmYWN0b3J5KHJvb3QsIHJvb3QuXywgcm9vdC5CYWNrYm9uZSk7XG4gIH1cbn0odGhpcywgZnVuY3Rpb24ocm9vdCwgXywgQmFja2JvbmUpIHtcblxuICAvLyBCYWNrYm9uZS5WaWV3U3RhdGVcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gYEJhY2tib25lLlZpZXdTdGF0ZWAgb2JqZWN0cyBhcmUgZGVzaWduZWQgdG8gYmUgbm90aGluZyBtb3JlIGJ1dFxuICAvLyBhIHdyYXBwZXIgdGhhdCBpcyBub3QgYSBNb2RlbCBidXQgZG9lcyBuZWVkIHRvICdob2xkJyBkYXRhLlxuICAvLyBBbiBleGFtcGxlIG9mIGEgVmlld1N0YXRlIHZhbHVlIGlzIHdoZW4geW91ciBtb3VzZSBvciBmaW5nZXJcbiAgLy8gaXMgaG92ZXJpbmcgb3ZlciBzb21lIHRhcmdldCB0byBhZGQgYHtvdmVyOiB0cnVlfWAgdG8gdGhlIHZpZXdTdGF0ZS5cbiAgLy8gVGhlIGlkZWEgYmVoaW5kIGl0IGlzIHRoYXQgeW91IGNhbiB1c2UgZ2V0QXR0cmlidXRlcyBhcyBkZWZhdWx0XG4gIC8vIGZvciBkYXRhIGluIHlvdXIgcmVuZGVyIGZ1bmN0aW9uLlxuXG4gIC8vIEZvciBleGFtcGxlOlxuICAvL1xuICAvLyAgICAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgLy8gICAgICAgdGhpcy5lbC5odG1sKHRlbXBsYXRlKF8uZXh0ZW5kKFxuICAvLyAgICAgICAgICB0aGlzLnZpZXdTdGF0ZS5nZXRBdHRyaWJ1dGVzKCksXG4gIC8vICAgICAgICAgIHRoaXMubW9kZWwudG9KU09OKClcbiAgLy8gICAgICAgKSkpO1xuICAvLyAgICAgfVxuICAvL1xuICB2YXIgVmlld1N0YXRlID0gQmFja2JvbmUuVmlld1N0YXRlID0gZnVuY3Rpb24oYXR0cmlidXRlcykge1xuICAgIHZhciBhdHRycyA9IGF0dHJpYnV0ZXMgfHwge307XG4gICAgdGhpcy5hdHRyaWJ1dGVzID0gXy5jbG9uZShhdHRycyk7XG4gIH07XG5cbiAgXy5leHRlbmQoVmlld1N0YXRlLnByb3RvdHlwZSwgQmFja2JvbmUuRXZlbnRzLCB7XG4gICAgLy8gZ2V0IHRoZSB2YWx1ZSBvZiBhbiBhdHRyaWJ1dGVcbiAgICBnZXQ6IGZ1bmN0aW9uKGF0dHIpIHtcbiAgICAgIHJldHVybiB0aGlzLmF0dHJpYnV0ZXNbYXR0cl07XG4gICAgfSxcblxuICAgIC8vIHJldHVybnMgYWxsIGF0dHJpYnV0ZXMgKGxpa2UgdG9KU09OLCBidXQgdGhpcyBhbHJlYWR5IGlzICdwb2pvJylcbiAgICBnZXRBdHRyaWJ1dGVzOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBfLmNsb25lKHRoaXMuYXR0cmlidXRlcyk7XG4gICAgfSxcblxuICAgIC8vIFNldCBhIGhhc2ggb2YgYXR0cmlidXRlcyBvbiB0aGUgb2JqZWN0IChmaXJpbmcgYGNoYW5nZWApLiBUaGlzIGlzXG4gICAgLy8gdGhlIGNvcmUgb3BlcmF0aW9uIG9mIGEgdmlld1N0YXRlIG9iamVjdCwgdXBkYXRpbmcgdGhlIGRhdGEgYW5kXG4gICAgLy8gbm90aWZ5aW5nIGFueW9uZSB3aG8gbmVlZHMgdG8ga25vdyBhYm91dCB0aGUgY2hhbmdlLlxuICAgIHNldDogZnVuY3Rpb24oa2V5LCB2YWwsIG9wdGlvbnMpIHtcbiAgICAgIHZhciBhdHRycywgYXR0ciwgY3VycmVudCwgc2lsZW50LCB1bnNldCwgY2hhbmdlcyA9IFtdO1xuICAgICAgaWYgKGtleSA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cblxuICAgICAgLy8gTGlrZSBpbiBCYWNrYm9uZS5Nb2RlbCwgeW91IGNhbiBzdXBwbHkgYm90aCBge2tleTogdmFsdWV9YCBhc1xuICAgICAgLy8gYFwia2V5XCIsIHZhbHVlYC1zdHlsZSBhcmd1bWVudHMuXG4gICAgICBpZiAodHlwZW9mIGtleSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgYXR0cnMgPSBrZXk7XG4gICAgICAgIG9wdGlvbnMgPSB2YWw7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAoYXR0cnMgPSB7fSlba2V5XSA9IHZhbDtcbiAgICAgIH1cblxuICAgICAgb3B0aW9ucyB8fCAob3B0aW9ucyA9IHt9KTtcblxuICAgICAgdW5zZXQgICA9IG9wdGlvbnMudW5zZXQ7XG4gICAgICBzaWxlbnQgID0gb3B0aW9ucy5zaWxlbnQ7XG4gICAgICBjdXJyZW50ID0gdGhpcy5hdHRyaWJ1dGVzO1xuXG4gICAgICBmb3IgKGF0dHIgaW4gYXR0cnMpIHtcbiAgICAgICAgdmFsID0gYXR0cnNbYXR0cl07XG4gICAgICAgIGlmICghXy5pc0VxdWFsKGN1cnJlbnRbYXR0cl0sIHZhbCkpIHtcbiAgICAgICAgICBjaGFuZ2VzLnB1c2goYXR0cik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVuc2V0KSB7XG4gICAgICAgICAgZGVsZXRlIGN1cnJlbnRbYXR0cl07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY3VycmVudFthdHRyXSA9IHZhbDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoIXNpbGVudCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGNoYW5nZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgdGhpcy50cmlnZ2VyKCdjaGFuZ2U6JysgY2hhbmdlc1tpXSwgdGhpcywgY3VycmVudFtjaGFuZ2VzW2ldXSwgb3B0aW9ucyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50cmlnZ2VyKCdjaGFuZ2UnLCB0aGlzLCBvcHRpb25zKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICAvLyBSZW1vdmUgYW4gYXR0cmlidXRlIGZyb20gdGhlIG9iamVjdCwgYWxzbyBmaXJpbmcgYSBgY2hhbmdlYC5cbiAgICB1bnNldDogZnVuY3Rpb24oYXR0ciwgb3B0aW9ucykge1xuICAgICAgcmV0dXJuIHRoaXMuc2V0KGF0dHIsIHZvaWQgMCwgXy5leHRlbmQoe30sIG9wdGlvbnMsIHt1bnNldDogdHJ1ZX0pKTtcbiAgICB9LFxuXG4gICAgLy8gQ2xlYXIgYWxsIGF0dHJpYnV0ZXMgb2ZmIHRoaXMgbW9kZWwsIGFsc28gZmlyaW5nIGBjaGFuZ2VgXG4gICAgY2xlYXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgIHZhciBhdHRycyA9IHt9O1xuICAgICAgZm9yICh2YXIga2V5IGluIHRoaXMuYXR0cmlidXRlcykge1xuICAgICAgICBhdHRyc1trZXldID0gdm9pZCAwO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuc2V0KGF0dHJzLCBfLmV4dGVuZCh7fSwgb3B0aW9ucywge3Vuc2V0OiB0cnVlfSkpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIEJhY2tib25lLlZpZXdTdGF0ZTtcbn0pKTtcbiIsIkFQUC5TdG9yZSA9IChmdW5jdGlvbiAoXywgQmFja2JvbmUpIHtcblxuICB2YXIgc2xpZGVDb2xsZWN0aW9uID0gbmV3IEJhY2tib25lLkNvbGxlY3Rpb24oKTtcblxuICB2YXIgc3RhdGUgPSBuZXcgQmFja2JvbmUuVmlld1N0YXRlKHtcbiAgICBhY3RpdmVJbmRleDogLTEsXG4gIH0pO1xuXG5cbiAgcmV0dXJuIHtcbiAgICBzdGFydDogZnVuY3Rpb24oZGF0YUpzb24pIHtcbiAgICAgIHNsaWRlQ29sbGVjdGlvbi5yZXNldChkYXRhSnNvbik7XG4gICAgICBzbGlkZUNvbGxlY3Rpb24uaW52b2tlKCdzZXQnLCB7J2RhdGFTZXQnOiBmYWxzZX0pO1xuICAgIH0sXG5cbiAgICBnZXRTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gc3RhdGU7XG4gICAgfSxcblxuICAgIGdldFNsaWRlQ29sbGVjdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gc2xpZGVDb2xsZWN0aW9uO1xuICAgIH0sXG4gIH07XG59KSh0aGlzLl8sIHRoaXMuQmFja2JvbmUpO1xuIiwiKGZ1bmN0aW9uIChfLCBCYWNrYm9uZSwgU3dpcGUpIHtcbiAgLy8gdGhlIG1lYXQgb2YgdGhlIGxvZ2ljLCBkZWZpbmVzIHRoZSBzbGlkZXNob3csIGhvb2tzIGludG8gZXhpc3RpbmcgZG9tIGVsZW1lbnRzIHJlcHJlc2VudGluZyBzbGlkZXMgYW5kIGNvbnRyb2xzXG4gIC8vIGhhbmRsZXMgZXZlbnRzIGFuZCB0aW1pbmcsIHBsYXksIHBhdXNlLCBqdW1wdG9cblxuICBBUFAuVmlld3MuU2xpZGVzaG93ID0gQmFja2JvbmUuVmlldy5leHRlbmQoe1xuXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgIHRoaXMudGltZVNldCA9IG9wdGlvbnMudGltZVNldDtcbiAgICAgIHRoaXMudGVtcGxhdGVOYW1lID0gb3B0aW9ucy50ZW1wbGF0ZU5hbWU7XG5cbiAgICAgIHRoaXMucmVuZGVyKCk7XG5cbiAgICAgIHRoaXMubGlzdGVuVG8oQVBQLlN0b3JlLmdldFN0YXRlKCksICdjaGFuZ2U6YWN0aXZlSW5kZXgnLCB0aGlzLnNsaWRlKTtcblxuICAgICAgdmFyIHJhbmRvbUluZGV4ID0gKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMuY29sbGVjdGlvbi5sZW5ndGggLSAxKSlcbiAgICAgIEFQUC5TdG9yZS5nZXRTdGF0ZSgpLnNldCgnYWN0aXZlSW5kZXgnLCByYW5kb21JbmRleCk7XG4gICAgICBjb25zb2xlLmxvZyhyYW5kb21JbmRleCk7XG5cbiAgICAgIHZhciBlbGVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ215U3dpcGUnKTtcbiAgICAgIHdpbmRvdy5teVN3aXBlID0gU3dpcGUoZWxlbSwge1xuICAgICAgICBzdGFydFNsaWRlOiByYW5kb21JbmRleCxcbiAgICAgICAgYXV0bzogODAwMCxcbiAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uKGluZGV4LCBlbGVtKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coaW5kZXgpO1xuICAgICAgICAgIEFQUC5TdG9yZS5nZXRTdGF0ZSgpLnNldCgnYWN0aXZlSW5kZXgnLCBpbmRleCk7XG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgdGhpcy5iaW5kcygpO1xuICAgIH0sXG5cbiAgICBiaW5kczogZnVuY3Rpb24oKSB7XG4gICAgICBfLmJpbmRBbGwodGhpcywgJ2tleURvd24nKTtcbiAgICAgICQoZG9jdW1lbnQpLm9uKCdrZXlkb3duJywgdGhpcy5rZXlEb3duKTtcbiAgICB9LFxuXG4gICAga2V5RG93bjogZnVuY3Rpb24gKGV2KSB7XG4gICAgICBzd2l0Y2ggKGV2LmtleUNvZGUpIHtcbiAgICAgICAgY2FzZSAzNzpcbiAgICAgICAgICB3aW5kb3cubXlTd2lwZS5wcmV2KClcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAzODpcbiAgICAgICAgICB0aGlzLnN0b3BUaW1lclNsaWRlKCk7XG4gICAgICAgICAgLy8gdGhpcy5hY3RpdmVTb3VyY2UtLTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAzOTpcbiAgICAgICAgICB3aW5kb3cubXlTd2lwZS5uZXh0KClcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSA0MDpcbiAgICAgICAgICB0aGlzLnN0b3BUaW1lclNsaWRlKCk7XG4gICAgICAgICAgLy8gdGhpcy5hY3RpdmVTb3VyY2UtLTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgc2xpZGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBuZXh0O1xuICAgICAgdmFyIHByZXY7XG4gICAgICB2YXIgYWN0aXZlID0gQVBQLlN0b3JlLmdldFN0YXRlKCkuZ2V0KCdhY3RpdmVJbmRleCcpO1xuICAgICAgdmFyIHNsaWRlc0xlbmdodCA9IHRoaXMuY29sbGVjdGlvbi5sZW5ndGg7XG5cbiAgICAgIGlmIChhY3RpdmUgPT09IHNsaWRlc0xlbmdodCkge1xuICAgICAgICBhY3RpdmUgPSAwO1xuICAgICAgfSBlbHNlIGlmIChhY3RpdmUgPT09IC0xKSB7XG4gICAgICAgIGFjdGl2ZSA9IChzbGlkZXNMZW5naHQgLSAxKTtcbiAgICAgIH1cblxuICAgICAgQVBQLlN0b3JlLmdldFN0YXRlKCkuc2V0KCdhY3RpdmVJbmRleCcsIGFjdGl2ZSwge1xuICAgICAgICBzaWxlbnQ6IHRydWUsXG4gICAgICB9KVxuXG4gICAgICBpZiAoYWN0aXZlID09PSAoc2xpZGVzTGVuZ2h0IC0gMSkpIHtcbiAgICAgICAgbmV4dCA9IDA7XG4gICAgICAgIHByZXYgPSBhY3RpdmUgLSAxO1xuICAgICAgfSBlbHNlIGlmIChhY3RpdmUgPT09IDApIHtcbiAgICAgICAgcHJldiA9IChzbGlkZXNMZW5naHQgLSAxKTtcbiAgICAgICAgbmV4dCA9IGFjdGl2ZSArIDE7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuZXh0ID0gYWN0aXZlICsgMTtcbiAgICAgICAgcHJldiA9IGFjdGl2ZSAtIDE7XG4gICAgICB9XG5cbiAgICAgIHZhciBwcmV2RWwgPSB0aGlzLiRlbC5maW5kKCdbZGF0YS1pZD1cIicgKyBwcmV2ICsgJ1wiXScpO1xuICAgICAgaWYoIXRoaXMuY29sbGVjdGlvbi5nZXQocHJldikuZ2V0KCdkYXRhU2V0JykpIHtcbiAgICAgICAgdGhpcy5hZGRDb250ZW50VG9UZW1wbGF0ZShwcmV2RWwsIHByZXYpO1xuICAgICAgICB0aGlzLmNvbGxlY3Rpb24uZ2V0KHByZXYpLnNldCgnZGF0YVNldCcsIHRydWUpO1xuICAgICAgfVxuXG4gICAgICB2YXIgYWN0aXZlRWwgPSB0aGlzLiRlbC5maW5kKCdbZGF0YS1pZD1cIicgKyBhY3RpdmUgKyAnXCJdJyk7XG4gICAgICBpZighdGhpcy5jb2xsZWN0aW9uLmdldChhY3RpdmUpLmdldCgnZGF0YVNldCcpKSB7XG4gICAgICAgIHRoaXMuYWRkQ29udGVudFRvVGVtcGxhdGUoYWN0aXZlRWwsIGFjdGl2ZSk7XG4gICAgICAgIHRoaXMuY29sbGVjdGlvbi5nZXQoYWN0aXZlKS5zZXQoJ2RhdGFTZXQnLCB0cnVlKTtcbiAgICAgIH1cblxuICAgICAgdmFyIG5leHRFbCA9IHRoaXMuJGVsLmZpbmQoJ1tkYXRhLWlkPVwiJyArIG5leHQgKyAnXCJdJyk7XG4gICAgICBpZighdGhpcy5jb2xsZWN0aW9uLmdldChuZXh0KS5nZXQoJ2RhdGFTZXQnKSkge1xuICAgICAgICB0aGlzLmFkZENvbnRlbnRUb1RlbXBsYXRlKG5leHRFbCwgbmV4dCk7XG4gICAgICAgIHRoaXMuY29sbGVjdGlvbi5nZXQobmV4dCkuc2V0KCdkYXRhU2V0JywgdHJ1ZSk7XG4gICAgICB9XG5cbiAgICB9LFxuXG4gICAgZ2V0VGVtcGxhdGVEYXRhOiBmdW5jdGlvbihzbGlkZW5yKSB7XG4gICAgICB2YXIgZGF0YSA9IHRoaXMuY29sbGVjdGlvbi5nZXQoc2xpZGVucik7XG4gICAgICByZXR1cm4gZGF0YS50b0pTT04oKTtcbiAgICB9LFxuXG4gICAgYWRkQ29udGVudFRvVGVtcGxhdGU6IGZ1bmN0aW9uKGVsLCBzbGlkZW5yKSB7XG4gICAgICB2YXIgc291cmNlID0gJCh0aGlzLnRlbXBsYXRlTmFtZSkuaHRtbCgpO1xuICAgICAgdGhpcy50ZW1wbGF0ZSA9IEhhbmRsZWJhcnMuY29tcGlsZShzb3VyY2UpO1xuICAgICAgZWwuYXBwZW5kKHRoaXMudGVtcGxhdGUodGhpcy5nZXRUZW1wbGF0ZURhdGEoc2xpZGVucikpKTtcbiAgICB9LFxuXG4gICAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgc291cmNlID0gJCgnI3BsYWNlaG9sZGVyLXRlbXBsYXRlJykuaHRtbCgpO1xuICAgICAgdGhpcy50ZW1wbGF0ZSA9IEhhbmRsZWJhcnMuY29tcGlsZShzb3VyY2UpO1xuXG4gICAgICB0aGlzLmNvbGxlY3Rpb24uZWFjaChmdW5jdGlvbihtb2RlbCkge1xuICAgICAgICAgIHRoaXMuJGVsLmFwcGVuZCh0aGlzLnRlbXBsYXRlKG1vZGVsLnRvSlNPTigpKSk7XG4gICAgICB9LCB0aGlzKTtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICB9KTtcblxufSkodGhpcy5fLCBCYWNrYm9uZSwgU3dpcGUpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
